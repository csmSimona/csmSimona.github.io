<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.18" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (userMode === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (userMode === 'dark' || systemDarkMode) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <title>React小记 | myDocs</title><meta name="description" content="我的学习笔记文档">
    <link rel="preload" href="/assets/style-lSiPQdn9.css" as="style"><link rel="stylesheet" href="/assets/style-lSiPQdn9.css">
    <link rel="modulepreload" href="/assets/app-BmN7UyQ9.js"><link rel="modulepreload" href="/assets/React小记.html-BkNp8wfi.js">
    <link rel="prefetch" href="/assets/index.html-Dyprp43j.js" as="script"><link rel="prefetch" href="/assets/JavaScript的优缺点.html-DkSLT4lx.js" as="script"><link rel="prefetch" href="/assets/js异步及处理异步的几种方法.html-B-67WTQX.js" as="script"><link rel="prefetch" href="/assets/antv G6的基础入门及树图的实际应用.html-Bt-hoa-Z.js" as="script"><link rel="prefetch" href="/assets/使用font-spider压缩字体文件.html-C7dQO0Lb.js" as="script"><link rel="prefetch" href="/assets/Git小记.html-C1S3GTGq.js" as="script"><link rel="prefetch" href="/assets/Linux基本命令.html-Bzah_-dA.js" as="script"><link rel="prefetch" href="/assets/NodeJs小记.html-BaC3qfk7.js" as="script"><link rel="prefetch" href="/assets/TypeScript小记.html-BjkA2Tpx.js" as="script"><link rel="prefetch" href="/assets/Vue.js源码全方位深入解析.html-CtnZZDPl.js" as="script"><link rel="prefetch" href="/assets/正则表达式入门.html-CqjUjT7g.js" as="script"><link rel="prefetch" href="/assets/CSS小记.html-B7j0Gzc_.js" as="script"><link rel="prefetch" href="/assets/HTML小记.html-DIfXw_vQ.js" as="script"><link rel="prefetch" href="/assets/JavaScript小记.html-0XAV9rgz.js" as="script"><link rel="prefetch" href="/assets/Vue小记.html-DmXQ-0lZ.js" as="script"><link rel="prefetch" href="/assets/前端工程化.html-ChvTG7_m.js" as="script"><link rel="prefetch" href="/assets/前端常见面试题.html-Bfw_QtRL.js" as="script"><link rel="prefetch" href="/assets/前端性能优化.html-lcmDxeHc.js" as="script"><link rel="prefetch" href="/assets/手写js.html-sEoh1ogA.js" as="script"><link rel="prefetch" href="/assets/计算机网络.html-ConVdrAI.js" as="script"><link rel="prefetch" href="/assets/Canvas入门.html-Rmyn0pGY.js" as="script"><link rel="prefetch" href="/assets/Echarts基本使用.html-CPwQ62GA.js" as="script"><link rel="prefetch" href="/assets/SVG入门.html-EWop8RoW.js" as="script"><link rel="prefetch" href="/assets/Three.js学习笔记.html-DS3MsoKZ.js" as="script"><link rel="prefetch" href="/assets/排序.html-iuWDMKKR.js" as="script"><link rel="prefetch" href="/assets/算法题.html-DTHCfjeR.js" as="script"><link rel="prefetch" href="/assets/Python编程：从入门到实践.html-CKB7WWDu.js" as="script"><link rel="prefetch" href="/assets/中后台管理系统模板记录.html-D9ZHB57P.js" as="script"><link rel="prefetch" href="/assets/低代码数据可视化平台开发记录.html-CEEw3Pxi.js" as="script"><link rel="prefetch" href="/assets/多页签开发记录.html-B0oqVzWf.js" as="script"><link rel="prefetch" href="/assets/CSS揭秘.html-y0NwfsZg.js" as="script"><link rel="prefetch" href="/assets/404.html-40ZW7ZF6.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><!----><span class="vp-site-name" aria-hidden="true">myDocs</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="首页"><!---->首页<!----></a></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="前端基础汇总"><span class="title">前端基础汇总</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="前端基础汇总"><span class="title">前端基础汇总</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/JavaScript%E5%B0%8F%E8%AE%B0.html" aria-label="JavaScript小记"><!---->JavaScript小记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/HTML%E5%B0%8F%E8%AE%B0.html" aria-label="HTML小记"><!---->HTML小记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/CSS%E5%B0%8F%E8%AE%B0.html" aria-label="CSS小记"><!---->CSS小记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.html" aria-label="计算机网络"><!---->计算机网络<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/React%E5%B0%8F%E8%AE%B0.html" aria-label="React小记"><!---->React小记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/Vue%E5%B0%8F%E8%AE%B0.html" aria-label="Vue小记"><!---->Vue小记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/%E6%89%8B%E5%86%99js.html" aria-label="手写js"><!---->手写js<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96.html" aria-label="前端工程化"><!---->前端工程化<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html" aria-label="前端性能优化"><!---->前端性能优化<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/%E5%89%8D%E7%AB%AF%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98.html" aria-label="前端常见面试题"><!---->前端常见面试题<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="算法"><span class="title">算法</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="算法"><span class="title">算法</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E7%AE%97%E6%B3%95/%E6%8E%92%E5%BA%8F.html" aria-label="排序"><!---->排序<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95%E9%A2%98.html" aria-label="算法题"><!---->算法题<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="其他"><span class="title">其他</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="其他"><span class="title">其他</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%85%B6%E4%BB%96/Git%E5%B0%8F%E8%AE%B0.html" aria-label="Git小记"><!---->Git小记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%85%B6%E4%BB%96/NodeJs%E5%B0%8F%E8%AE%B0.html" aria-label="NodeJs小记"><!---->NodeJs小记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%85%B6%E4%BB%96/TypeScript%E5%B0%8F%E8%AE%B0.html" aria-label="TypeScript小记"><!---->TypeScript小记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%85%B6%E4%BB%96/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%85%A5%E9%97%A8.html" aria-label="正则表达式入门"><!---->正则表达式入门<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%85%B6%E4%BB%96/Linux%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4.html" aria-label="Linux基本命令"><!---->Linux基本命令<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%85%B6%E4%BB%96/Vue.js%E6%BA%90%E7%A0%81%E5%85%A8%E6%96%B9%E4%BD%8D%E6%B7%B1%E5%85%A5%E8%A7%A3%E6%9E%90.html" aria-label="Vue.js源码全方位深入解析"><!---->Vue.js源码全方位深入解析<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="数据可视化"><span class="title">数据可视化</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="数据可视化"><span class="title">数据可视化</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/Canvas%E5%85%A5%E9%97%A8.html" aria-label="Canvas入门"><!---->Canvas入门<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/SVG%E5%85%A5%E9%97%A8.html" aria-label="SVG入门"><!---->SVG入门<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/Echarts%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8.html" aria-label="Echarts基本使用"><!---->Echarts基本使用<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/antvG6/antv%20G6%E7%9A%84%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8%E5%8F%8A%E6%A0%91%E5%9B%BE%E7%9A%84%E5%AE%9E%E9%99%85%E5%BA%94%E7%94%A8.html" aria-label="antv G6的基础入门及树图的实际应用"><!---->antv G6的基础入门及树图的实际应用<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/Three.js%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html" aria-label="Three.js学习笔记"><!---->Three.js学习笔记<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="读书笔记"><span class="title">读书笔记</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="读书笔记"><span class="title">读书笔记</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/CSS%E6%8F%AD%E7%A7%98/CSS%E6%8F%AD%E7%A7%98.html" aria-label="《CSS揭秘》"><!---->《CSS揭秘》<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/Python%E7%BC%96%E7%A8%8B%EF%BC%9A%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%AE%9E%E8%B7%B5.html" aria-label="《Python编程：从入门到实践》"><!---->《Python编程：从入门到实践》<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="项目开发"><span class="title">项目开发</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="项目开发"><span class="title">项目开发</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91/%E4%BD%8E%E4%BB%A3%E7%A0%81%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E5%B9%B3%E5%8F%B0%E5%BC%80%E5%8F%91%E8%AE%B0%E5%BD%95.html" aria-label="低代码数据可视化平台开发记录"><!---->低代码数据可视化平台开发记录<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91/%E4%B8%AD%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E6%A8%A1%E6%9D%BF%E8%AE%B0%E5%BD%95.html" aria-label="中后台管理系统模板记录"><!---->中后台管理系统模板记录<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91/%E5%A4%9A%E9%A1%B5%E7%AD%BE%E5%BC%80%E5%8F%91%E8%AE%B0%E5%BD%95.html" aria-label="多页签开发记录"><!---->多页签开发记录<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/csmSimona" aria-label="Github" rel="noopener noreferrer" target="_blank"><!---->Github<!----></a></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="Search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="首页"><!---->首页<!----></a></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="前端基础汇总"><span class="title">前端基础汇总</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="前端基础汇总"><span class="title">前端基础汇总</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/JavaScript%E5%B0%8F%E8%AE%B0.html" aria-label="JavaScript小记"><!---->JavaScript小记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/HTML%E5%B0%8F%E8%AE%B0.html" aria-label="HTML小记"><!---->HTML小记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/CSS%E5%B0%8F%E8%AE%B0.html" aria-label="CSS小记"><!---->CSS小记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.html" aria-label="计算机网络"><!---->计算机网络<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/React%E5%B0%8F%E8%AE%B0.html" aria-label="React小记"><!---->React小记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/Vue%E5%B0%8F%E8%AE%B0.html" aria-label="Vue小记"><!---->Vue小记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/%E6%89%8B%E5%86%99js.html" aria-label="手写js"><!---->手写js<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96.html" aria-label="前端工程化"><!---->前端工程化<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html" aria-label="前端性能优化"><!---->前端性能优化<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/%E5%89%8D%E7%AB%AF%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98.html" aria-label="前端常见面试题"><!---->前端常见面试题<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="算法"><span class="title">算法</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="算法"><span class="title">算法</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E7%AE%97%E6%B3%95/%E6%8E%92%E5%BA%8F.html" aria-label="排序"><!---->排序<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95%E9%A2%98.html" aria-label="算法题"><!---->算法题<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="其他"><span class="title">其他</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="其他"><span class="title">其他</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%85%B6%E4%BB%96/Git%E5%B0%8F%E8%AE%B0.html" aria-label="Git小记"><!---->Git小记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%85%B6%E4%BB%96/NodeJs%E5%B0%8F%E8%AE%B0.html" aria-label="NodeJs小记"><!---->NodeJs小记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%85%B6%E4%BB%96/TypeScript%E5%B0%8F%E8%AE%B0.html" aria-label="TypeScript小记"><!---->TypeScript小记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%85%B6%E4%BB%96/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%85%A5%E9%97%A8.html" aria-label="正则表达式入门"><!---->正则表达式入门<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%85%B6%E4%BB%96/Linux%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4.html" aria-label="Linux基本命令"><!---->Linux基本命令<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%85%B6%E4%BB%96/Vue.js%E6%BA%90%E7%A0%81%E5%85%A8%E6%96%B9%E4%BD%8D%E6%B7%B1%E5%85%A5%E8%A7%A3%E6%9E%90.html" aria-label="Vue.js源码全方位深入解析"><!---->Vue.js源码全方位深入解析<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="数据可视化"><span class="title">数据可视化</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="数据可视化"><span class="title">数据可视化</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/Canvas%E5%85%A5%E9%97%A8.html" aria-label="Canvas入门"><!---->Canvas入门<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/SVG%E5%85%A5%E9%97%A8.html" aria-label="SVG入门"><!---->SVG入门<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/Echarts%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8.html" aria-label="Echarts基本使用"><!---->Echarts基本使用<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/antvG6/antv%20G6%E7%9A%84%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8%E5%8F%8A%E6%A0%91%E5%9B%BE%E7%9A%84%E5%AE%9E%E9%99%85%E5%BA%94%E7%94%A8.html" aria-label="antv G6的基础入门及树图的实际应用"><!---->antv G6的基础入门及树图的实际应用<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/Three.js%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html" aria-label="Three.js学习笔记"><!---->Three.js学习笔记<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="读书笔记"><span class="title">读书笔记</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="读书笔记"><span class="title">读书笔记</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/CSS%E6%8F%AD%E7%A7%98/CSS%E6%8F%AD%E7%A7%98.html" aria-label="《CSS揭秘》"><!---->《CSS揭秘》<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/Python%E7%BC%96%E7%A8%8B%EF%BC%9A%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%AE%9E%E8%B7%B5.html" aria-label="《Python编程：从入门到实践》"><!---->《Python编程：从入门到实践》<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="项目开发"><span class="title">项目开发</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="项目开发"><span class="title">项目开发</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91/%E4%BD%8E%E4%BB%A3%E7%A0%81%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E5%B9%B3%E5%8F%B0%E5%BC%80%E5%8F%91%E8%AE%B0%E5%BD%95.html" aria-label="低代码数据可视化平台开发记录"><!---->低代码数据可视化平台开发记录<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91/%E4%B8%AD%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E6%A8%A1%E6%9D%BF%E8%AE%B0%E5%BD%95.html" aria-label="中后台管理系统模板记录"><!---->中后台管理系统模板记录<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91/%E5%A4%9A%E9%A1%B5%E7%AD%BE%E5%BC%80%E5%8F%91%E8%AE%B0%E5%BD%95.html" aria-label="多页签开发记录"><!---->多页签开发记录<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/csmSimona" aria-label="Github" rel="noopener noreferrer" target="_blank"><!---->Github<!----></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">React小记 <!----></p><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div class="theme-default-content" vp-content><!--[--><!--]--><div><h1 id="react小记" tabindex="-1"><a class="header-anchor" href="#react小记"><span>React小记</span></a></h1><h2 id="一、react使用" tabindex="-1"><a class="header-anchor" href="#一、react使用"><span>一、React使用</span></a></h2><h3 id="_1、react基本使用" tabindex="-1"><a class="header-anchor" href="#_1、react基本使用"><span>1、React基本使用</span></a></h3><h4 id="jsx" tabindex="-1"><a class="header-anchor" href="#jsx"><span>JSX</span></a></h4><p>React发明了JSX，利用HTML语法来创建虚拟DOM。</p><p>React的核心机制之一就是可以在内存中创建虚拟的DOM元素。以此来减少对实际DOM的操作从而提升性能。</p><p>JSX即JavaScript XML，它是对JavaScript的语法扩展，React使用JSX来替代常规的JS。</p><p><strong>JSX的优点</strong></p><ul><li>JSX执行更快，因为它在编译为JS代码进行了优化</li><li>它是类型安全的，在编译过程中就能发现错误 <ul><li>React DOM 在渲染所有输入内容之前，默认会进行转义。它可以确保在你的应用中，永远不会注入那些并非自己明确编写的内容。所有的内容在渲染之前都被转换成了字符串。这样可以有效地防止XSS（cross-site-scripting, 跨站脚本）攻击。</li></ul></li><li>使用JSX编写模板更加简单快速</li></ul><p><strong>JSX语法</strong></p><p><strong>1、变量、表达式</strong></p><p>我们可以在JSX中使用JS表达式（不能适用于语句），表达式写在大括号“{}”中</p><ul><li><p><code>{2+2}</code> <code>{user.firstName}</code> <code>{formatName(user)}</code></p></li><li><p>在JSX中不能使用if-else语句，但可以使用conditional（三元运算）表达式来替代</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> show</span><span style="color:#D4D4D4;"> = </span><span style="color:#569CD6;">true</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">{</span><span style="color:#9CDCFE;">show</span><span style="color:#D4D4D4;"> ? </span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">img</span><span style="color:#9CDCFE;"> src</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;xxx.png&quot;</span><span style="color:#808080;">/&gt;</span><span style="color:#D4D4D4;"> : </span><span style="color:#CE9178;">&#39;&#39;</span><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>循环</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> list</span><span style="color:#D4D4D4;"> = [</span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">, </span><span style="color:#B5CEA8;">2</span><span style="color:#D4D4D4;">, </span><span style="color:#B5CEA8;">3</span><span style="color:#D4D4D4;">, </span><span style="color:#B5CEA8;">4</span><span style="color:#D4D4D4;">, </span><span style="color:#B5CEA8;">5</span><span style="color:#D4D4D4;">];</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">{</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    list</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">map</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">li</span><span style="color:#9CDCFE;"> key</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">index</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">item</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">li</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    })</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p><strong>2、样式</strong></p><ul><li><p>React推荐使用内联样式。我们可以使用camelCase语法设置内联样式。</p><p>React会在指定元素数字后自动添加px</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">var</span><span style="color:#9CDCFE;"> myStyle</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    fontSize:</span><span style="color:#B5CEA8;"> 100</span><span style="color:#D4D4D4;">,  </span><span style="color:#6A9955;">// css中为font-size</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    color:</span><span style="color:#CE9178;"> &#39;#FF0000&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">};</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">h1</span><span style="color:#9CDCFE;"> style</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">myStyle</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">xxx</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">h1</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">h1</span><span style="color:#9CDCFE;"> style</span><span style="color:#F44747;"> =</span><span style="color:#9CDCFE;"> {{background: red;}}</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">xxx</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">h1</span><span style="color:#808080;">&gt;</span><span style="color:#6A9955;"> //两个大括号</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">red</span><span style="color:#D4D4D4;">-</span><span style="color:#9CDCFE;">btn</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    background</span><span style="color:#D4D4D4;">: </span><span style="color:#9CDCFE;">red</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">h1</span><span style="color:#9CDCFE;"> className</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&#39;red-btn&#39;</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">xxx</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">h1</span><span style="color:#808080;">&gt;</span><span style="color:#6A9955;">  // 使用className而不是class</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p><strong>3、注释</strong></p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#D4D4D4;">{</span><span style="color:#6A9955;">/* ... */</span><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">{</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // （单行注释要换行）</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>4、数组</strong></p><p>JSX允许在模板中插入数组，数组会自动展开所有成员</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">var</span><span style="color:#9CDCFE;"> arr</span><span style="color:#D4D4D4;"> = [</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#569CD6;">h1</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">xxx</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">h1</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#569CD6;">h2</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">xxx</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">h2</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">];</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">arr</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>5、原生HTML</strong></p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">var</span><span style="color:#9CDCFE;"> item</span><span style="color:#D4D4D4;"> = </span><span style="color:#CE9178;">`&lt;h1&gt;hello&lt;/h1&gt;`</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">li</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">	key</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">index</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">	onClick</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">handleItemDelete</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">bind</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;">)</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    dangerouslySetInnerHTML</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">__html</span><span style="color:#D4D4D4;">: </span><span style="color:#9CDCFE;">item</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">li</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="事件" tabindex="-1"><a class="header-anchor" href="#事件"><span>事件</span></a></h4><ul><li><p>bind this</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 将这种作用域的修改放在constructor中，保证作用域绑定操作只执行一次。</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">handleBtnClick</span><span style="color:#D4D4D4;"> = </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">handleBtnClick</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">bind</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">//绑定this为对应组件&lt;TodoList/&gt;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">button</span><span style="color:#9CDCFE;"> className</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;button&quot;</span><span style="color:#9CDCFE;"> onClick</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">handleBtnClick</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">提交</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">handleBtnClick</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // console.log(this)  // this默认是undefined</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        inputValue:</span><span style="color:#CE9178;"> &#39;&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    })</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 用静态方法，this指向当前实例 不需要再绑定this</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">handleBtnClick</span><span style="color:#D4D4D4;"> = () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        inputValue:</span><span style="color:#CE9178;"> &#39;&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    })</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>关于event参数</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#DCDCAA;">handleBtnClick</span><span style="color:#D4D4D4;"> = (</span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    event</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">preventDefault</span><span style="color:#D4D4D4;">()  </span><span style="color:#6A9955;">// 阻止默认行为</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    event</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">stopPropagation</span><span style="color:#D4D4D4;">() </span><span style="color:#6A9955;">// 阻止冒泡</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;target&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">)  </span><span style="color:#6A9955;">// 指向当前元素，即当前元素触发</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;current target&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">currentTarget</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">// 指向当前元素，假象！</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    </span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 注意，event其实是React封装的。可以看__proto__constructor是 SyntheticEvent</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    conole</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;event&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    </span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 原生event（event.nativeEvent）如下。其__proto__constructor是 MouseEvent</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;NativeEvent&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">nativeEvent</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;NativeEvent target&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">nativeEvent</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">//指向当前元素</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;NativeEvent current target&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">nativeEvent</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">currentTarget</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">	// 指向document元素/root组件</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>版本升级</strong></p><p>React16绑定到document</p><p><strong>React17事件绑定到root组件</strong></p><p>有利于多个React版本并存，例如微前端</p></li><li><p>传递自定义参数</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">button</span><span style="color:#9CDCFE;"> className</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;button&quot;</span><span style="color:#9CDCFE;"> onClick</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">handleBtnClick</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">title</span><span style="color:#D4D4D4;">)</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">提交</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">handleBtnClick</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">title</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">title</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;event&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">)  </span><span style="color:#6A9955;">// 最后追加一个参数，即可接收event</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h4 id="state和setstate" tabindex="-1"><a class="header-anchor" href="#state和setstate"><span>state和setState</span></a></h4><ul><li><p>不要直接修改state</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">comment</span><span style="color:#D4D4D4;"> = </span><span style="color:#CE9178;">&#39;hello&#39;</span><span style="color:#D4D4D4;">; </span><span style="color:#6A9955;">// wrong</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    comment:</span><span style="color:#CE9178;"> &#39;hello&#39;</span><span style="color:#D4D4D4;">;  </span><span style="color:#6A9955;">//right</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">})</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>构造函数是唯一可以给this.state赋值的地方</p></li><li><p>State 的更新可能是异步的</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    count:</span><span style="color:#569CD6;"> this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> + </span><span style="color:#B5CEA8;">1</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}, () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 联想 Vue $nextTick - DOM</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;count by callback&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">// 回调函数中可以拿到最新的 state</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">})</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;count&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">// 异步的，拿不到最新值</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// setTimeout 中 setState 是同步的</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">setTimeout</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        count:</span><span style="color:#569CD6;"> this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> + </span><span style="color:#B5CEA8;">1</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    })</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;count in setTimeout&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}, </span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">)</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 自己定义的 DOM 事件，setState 是同步的</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">bodyClickHandler</span><span style="color:#D4D4D4;"> = () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        count:</span><span style="color:#569CD6;"> this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> + </span><span style="color:#B5CEA8;">1</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    })</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;count in body event&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">componentDidMount</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 自己定义的 DOM 事件，setState 是同步的</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    document</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">body</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">addEventListener</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;click&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">bodyClickHandler</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">componentWillUnmount</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 及时销毁自定义 DOM 事件</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    document</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">body</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">removeEventListener</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;click&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">bodyClickHandler</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // clearTimeout</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>出于性能考虑，React 可能会把多个 setState() 调用合并成一个调用。 因为 this.props 和 this.state 可能会异步更新，所以你不要依赖他们的值来更新下一个状态。 例如，此代码可能会无法更新计数器</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// Wrong</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  counter:</span><span style="color:#569CD6;"> this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">counter</span><span style="color:#D4D4D4;"> + </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">increment</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">});</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>要解决这个问题，可以让 setState() 接收一个函数而不是一个对象。这个函数用上一个 state 作为第一个参数，将此次更新被应用时的 props 做为第二个参数</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// Correct</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> ({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  counter:</span><span style="color:#9CDCFE;"> state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">counter</span><span style="color:#D4D4D4;"> + </span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">increment</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}));</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>可能会被合并</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 传入对象，会被合并（类似 Object.assign ）。执行结果只一次 +1</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    count:</span><span style="color:#569CD6;"> this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> + </span><span style="color:#B5CEA8;">1</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">})</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    count:</span><span style="color:#569CD6;"> this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> + </span><span style="color:#B5CEA8;">1</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">})</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    count:</span><span style="color:#569CD6;"> this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> + </span><span style="color:#B5CEA8;">1</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">})</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 传入函数，不会被合并。执行结果是 +3</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">prevState</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        count:</span><span style="color:#9CDCFE;"> prevState</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> + </span><span style="color:#B5CEA8;">1</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">})</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">prevState</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        count:</span><span style="color:#9CDCFE;"> prevState</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> + </span><span style="color:#B5CEA8;">1</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">})</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">prevState</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        count:</span><span style="color:#9CDCFE;"> prevState</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> + </span><span style="color:#B5CEA8;">1</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">})</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h4 id="组件生命周期" tabindex="-1"><a class="header-anchor" href="#组件生命周期"><span>组件生命周期</span></a></h4><p><a href="http://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/" target="_blank" rel="noopener noreferrer">React 组件生命周期图示</a></p><ul><li>constructor：在组件一创建的时刻就被调用。但不归类在React的生命周期中，因为它是ES6里面的东西，不是React独有的。</li><li>componentWillMount：在组件即将被挂载到页面的时刻自动执行。</li><li>componentDidMount：在组件被挂载后自动执行。</li><li>shouldComponentUpdate：组件被更新之前，自动被执行需要返回一个布尔值。true 更新 false 不会被更新</li><li>componentWillUpdate：组件被更新之前，它会自动执行，但是它在shouldComponentUpdate之后被执行，如果返回true就执行，如果返回false，这个函数就不会被执行了。</li><li>componentDidUpdate：组件被更新之后自动执行。</li><li>componentWillReceiveProps：一个组件要从父组件接受参数。只要父组件的render函数被重新执行了，子组件的这个生命周期函数就会被执行（如果这个组件第一次存在与父组件中，不会执行；如果这个组件之前已经存在于父组件中，才会执行）</li><li>componentWillUnmount：当这个组件即将被从页面中剔除的时候，会被执行。</li></ul><h4 id="循环列表中元素的-key" tabindex="-1"><a class="header-anchor" href="#循环列表中元素的-key"><span>循环列表中元素的 key</span></a></h4><p>循环列表中元素的 key 最好是这个元素在列表中拥有的一个独一无二的字符串。</p><p>通常，我们使用来自数据 id 来作为元素的 key：</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> todoItems</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">todos</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">map</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">todo</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">  &lt;</span><span style="color:#569CD6;">li</span><span style="color:#9CDCFE;"> key</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">todo</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">id</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    {</span><span style="color:#9CDCFE;">todo</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">text</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">  &lt;/</span><span style="color:#569CD6;">li</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">);</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当元素没有确定 id 的时候，万不得已你可以使用元素索引 index 作为 key：</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> todoItems</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">todos</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">map</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">todo</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">  // Only do this if items have no stable IDs</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">  &lt;</span><span style="color:#569CD6;">li</span><span style="color:#9CDCFE;"> key</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">index</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    {</span><span style="color:#9CDCFE;">todo</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">text</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">  &lt;/</span><span style="color:#569CD6;">li</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">);</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>**循环中的key值最好不是index，原始虚拟DOM树和新的虚拟DOM树的key值一致能提升虚拟DOM比对的性能，而列表项目的顺序可能会变化，index是不稳定的，经常会改变。使用index做key值会导致性能变差，还可能引起组件状态的问题。**如果你选择不指定显式的 key 值，那么 React 将默认使用索引用作为列表项目的 key 值。</p><h4 id="父子组件的通信" tabindex="-1"><a class="header-anchor" href="#父子组件的通信"><span>父子组件的通信</span></a></h4><h5 id="父传子" tabindex="-1"><a class="header-anchor" href="#父传子"><span>父传子</span></a></h5><ul><li><p>父组件通过属性形式向子组件传递参数，子组件通过props接收父组件传递过来的参数</p><p>无论是使用函数声明还是class声明，都绝不能改变自身的props，所有React组件都必须像纯函数一样保护它们的props不被改变</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 父组件</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#4EC9B0;">TodoItem</span><span style="color:#D4D4D4;"> </span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">	delete</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">handleDelete</span><span style="color:#569CD6;">}</span><span style="color:#D4D4D4;"> </span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">	key</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">index</span><span style="color:#569CD6;">}</span><span style="color:#D4D4D4;"> </span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">	content</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">item</span><span style="color:#569CD6;">}</span><span style="color:#D4D4D4;"> </span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">	index</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">index</span><span style="color:#569CD6;">}</span><span style="color:#808080;"> /&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 子组件</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">handleDelete</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">	this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">delete</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">li</span><span style="color:#9CDCFE;"> key</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">index</span><span style="color:#569CD6;">}</span><span style="color:#9CDCFE;"> onClick</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">handleDelete</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">content</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">li</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>子组件如果想与父组件通信，子组件要调用父组件传过来的方法</p></li><li><p>子组件只能使用父组件传递过来的值，但不能改变值（单向数据流）</p></li></ul><h5 id="子传父" tabindex="-1"><a class="header-anchor" href="#子传父"><span>子传父</span></a></h5><p>1、通过refs传递</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 父组件</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#4EC9B0;">QueryBox</span><span style="color:#9CDCFE;"> ref</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;queryBox&quot;</span><span style="color:#9CDCFE;"> app</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">app</span><span style="color:#569CD6;">}</span><span style="color:#9CDCFE;"> onSearch</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">onSearch</span><span style="color:#569CD6;">}</span><span style="color:#9CDCFE;"> onCount</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">onCount</span><span style="color:#569CD6;">}</span><span style="color:#808080;"> /&gt;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">let</span><span style="color:#9CDCFE;"> QueryBoxInstance</span><span style="color:#D4D4D4;"> = </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">refs</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">queryBox</span><span style="color:#C586C0;"> as</span><span style="color:#4EC9B0;"> QueryBox</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">QueryBoxInstance</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">onChange</span><span style="color:#D4D4D4;">();</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2、通过回调函数传递</p><p>父：<code>&lt;Child onHandleChild=&quot;函数&quot;/&gt;</code> 父组件 =&gt; 函数(参数){ }</p><p>子：this.props.onHandleChild(传值) 在子组件中执行这个函数,会传值到父组件</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 父组件</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;"> &lt;</span><span style="color:#4EC9B0;">AddModal</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    onOk</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">score</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">any</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">review</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">any</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#569CD6;"> this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">handleOk</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">score</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">review</span><span style="color:#D4D4D4;">) </span><span style="color:#C586C0;">as</span><span style="color:#4EC9B0;"> any</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    onCancel</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">hideModal</span><span style="color:#C586C0;"> as</span><span style="color:#4EC9B0;"> any</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    loading</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">loading</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    studentInfo</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">studentInfo</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;"> /&gt;</span><span style="color:#D4D4D4;"> </span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 子组件</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;"> &lt;</span><span style="color:#4EC9B0;">Modal</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    visible</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{true}</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    title</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;评分&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    onOk</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#D4D4D4;">()</span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;">{</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">onOk</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">score</span><span style="color:#D4D4D4;">, </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">review</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    onCancel</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">onCancel</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    confirmLoading</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">loading</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    okText</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;确认&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    className</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;review&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    cancelText</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;取消&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#F44747;">  \&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="扩大点击区域" tabindex="-1"><a class="header-anchor" href="#扩大点击区域"><span>扩大点击区域</span></a></h4><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">label</span><span style="color:#9CDCFE;"> htmlFor</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;insertArea&quot;</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">输入内容</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">label</span><span style="color:#808080;">&gt;</span><span style="color:#6A9955;">  // 不用for，与循环for有歧义</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">input</span><span style="color:#9CDCFE;"> id</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;insertArea&quot;</span><span style="color:#808080;">/&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="pwa" tabindex="-1"><a class="header-anchor" href="#pwa"><span>PWA</span></a></h4><p><strong>什么是PWA</strong></p><p>PWA全称Progressive Web App，即渐进式WEB应用。</p><p>写网页的形式写手机APP应用。</p><blockquote><p>1、可以添加至主屏幕，点击主屏幕图标可以实现启动动画以及隐藏地址栏 2、实现离线缓存功能，即使用户手机没有网络，依然可以使用一些离线功能 3、实现了消息推送</p></blockquote><p>registerServiceWorker</p><p>引用它，网页上线到支持https协议的服务器上。第一次访问时需联网才能看到，但突然断网，第二次访问时依然可以看到之前访问过的页面，因为registerServiceWorker会把之前的网页存储在浏览器内。</p><h3 id="_2、react高级特性" tabindex="-1"><a class="header-anchor" href="#_2、react高级特性"><span>2、React高级特性</span></a></h3><h4 id="函数组件" tabindex="-1"><a class="header-anchor" href="#函数组件"><span>函数组件</span></a></h4><ul><li>纯函数，输入props，输出JSX</li><li>没有组件实例</li><li>没有生命周期</li><li>没有state和setState，只能接收props</li><li>不能扩展其他方法</li></ul><h5 id="什么是纯函数" tabindex="-1"><a class="header-anchor" href="#什么是纯函数"><span>什么是纯函数？</span></a></h5><ol><li><strong>确定性</strong>：对于相同的输入参数，纯函数总是返回相同的结果。这意味着函数的行为是可以预测的，只要输入不变，输出就不会改变。</li><li><strong>无副作用</strong>：纯函数除了返回值之外，不会对程序状态造成任何影响，也就是说它不会修改输入参数，也不会修改任何外部状态（例如全局变量）。此外，纯函数不应该执行像I/O操作这样的行为，因为这些操作通常会影响程序之外的世界。</li></ol><h4 id="受控组件-controlled-components" tabindex="-1"><a class="header-anchor" href="#受控组件-controlled-components"><span>受控组件 (Controlled Components)</span></a></h4><ul><li><strong>定义</strong>: <strong>在受控组件中，组件的状态由React组件自身的state或父组件传递下来的props控制</strong>。这意味着组件的UI状态（如表单字段的值）总是由React的state保持同步。</li><li><strong>特点</strong>: 每当用户交互（如键盘输入）发生时，React会更新组件的状态，并重新渲染组件以反映新的状态。</li><li><strong>示例</strong>: 表单元素（如<code>&lt;input&gt;</code>、<code>&lt;textarea&gt;</code>、<code>&lt;select&gt;</code>）的值是由React的state直接控制的，通过事件处理器（如onChange）来更新state。</li></ul><h4 id="非受控组件-uncontrolled-components" tabindex="-1"><a class="header-anchor" href="#非受控组件-uncontrolled-components"><span>非受控组件 (Uncontrolled Components)</span></a></h4><ul><li><strong>定义</strong>: <strong>在非受控组件中，组件的状态不是由React state控制的，而是由DOM本身控制。<strong>这通常意味着这些组件</strong>将使用ref来访问DOM节点</strong>，并从中读取状态。</li><li><strong>特点</strong>: 非受控组件通常用于简化那些不需要高度动态状态管理的场景。它们可以减少state的复杂度，并且在一些情况下性能更好。</li><li><strong>示例</strong>: 使用<code>ref</code>来获取DOM节点的引用，并直接操作DOM节点的状态。如文件上传、某些富文本编辑器，需要传入DOM元素</li></ul><h4 id="portals-传送门" tabindex="-1"><a class="header-anchor" href="#portals-传送门"><span>Portals（传送门）⭐</span></a></h4><p>Portal是一种特殊的渲染方式，它允许你将子节点渲染到位于父组件以外的DOM节点中。</p><p>Portal的主要用途是将组件的输出从其常规位置移动到文档中的另一个位置，这对于创建<strong>模态对话框、弹出窗口、悬浮菜单</strong>等组件非常有用。</p><h5 id="基础使用" tabindex="-1"><a class="header-anchor" href="#基础使用"><span>基础使用</span></a></h5><p>api：<code>ReactDOM.createPortal()</code></p><p>示例：将组件渲染到 body 上</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> ReactDOM</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;react-dom&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#CE9178;"> &#39;./style.css&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">class</span><span style="color:#4EC9B0;"> App</span><span style="color:#569CD6;"> extends</span><span style="color:#4EC9B0;"> React</span><span style="color:#D4D4D4;">.</span><span style="color:#4EC9B0;">Component</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    constructor</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        super</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    render</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // // 正常渲染</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // return &lt;div className=&quot;modal&quot;&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        //     {this.props.children} {/* vue slot */}</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // &lt;/div&gt;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 使用 Portals 渲染到 body 上。</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#9CDCFE;"> ReactDOM</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">createPortal</span><span style="color:#D4D4D4;">(</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#569CD6;">div</span><span style="color:#9CDCFE;"> className</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;modal&quot;</span><span style="color:#808080;">&gt;</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">children</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            document</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">body</span><span style="color:#6A9955;"> // DOM 节点</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        )</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> App</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="portal-的内部实现" tabindex="-1"><a class="header-anchor" href="#portal-的内部实现"><span>Portal 的内部实现</span></a></h5><p>Portal 的实现主要依赖于 React 的虚拟 DOM 机制以及对浏览器原生 DOM API 的利用。</p><p>Portal 的实现涉及到<strong>将一部分虚拟 DOM 树渲染到页面上的不同位置，而不是直接作为当前组件树的一部分</strong>。</p><p><strong>Portal 的具体步骤</strong></p><ol><li><strong>创建 portal 节点</strong>： <ul><li>当你调用 <code>ReactDOM.createPortal</code> 时，React 会在虚拟 DOM 中创建一个特殊的节点，这个节点包含要渲染的内容以及目标 DOM 容器。</li></ul></li><li><strong>插入到 DOM 中</strong>： <ul><li>在 commit 阶段，React 会遍历所有的 portal 节点，并将它们的实际内容（即它们的子树）插入到对应的 DOM 容器中。</li></ul></li><li><strong>更新和删除</strong>： <ul><li>如果门户的内容发生变化，React 会根据新的虚拟 DOM 树重新计算差异，并更新或删除 DOM 中的内容。</li><li>当组件卸载或不再使用 <code>createPortal</code> 时，React 会清理门户的内容，并从 DOM 中移除相关的节点。</li></ul></li></ol><h5 id="注意事项" tabindex="-1"><a class="header-anchor" href="#注意事项"><span><strong>注意事项</strong></span></a></h5><ul><li><strong>状态管理</strong>：Portal内的组件仍然遵循React的状态管理机制，因此你仍然可以像平常一样使用<code>state</code>和<code>props</code>来控制它们的行为。</li><li><strong>生命周期</strong>：Portal内的组件依然遵循标准的React生命周期，包括挂载、更新和卸载阶段。</li><li><strong>样式隔离</strong>：如果你在Portal内渲染的是一个模态窗口或其他类似的组件，你可能需要处理样式隔离的问题，以确保Portal内的样式不会影响到页面上的其他元素。</li></ul><h4 id="context" tabindex="-1"><a class="header-anchor" href="#context"><span>context⭐</span></a></h4><p>优点：变量不用层层传递，省去无谓的传递props</p><p>缺点：使用全局变量的方法，会让组件失去独立性，复用起来更困难，会让组件变得不纯粹，不应该大规模使用。</p><p>使用场景：公共信息（语言、主题）传递给每个组件</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 创建 Context 填入默认值（任何一个 js 变量）</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> ThemeContext</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">React</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">createContext</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;light&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 1、底层组件 - 函数式组件</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> ThemeLink</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // const theme = this.context // 会报错。函数式组件没有实例，即没有 this</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 函数式组件可以使用 Consumer</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#4EC9B0;">ThemeContext.Consumer</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        {</span><span style="color:#9CDCFE;"> value</span><span style="color:#569CD6;"> =&gt;</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">link&#39;s theme is </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">value</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span><span style="color:#569CD6;"> }</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#4EC9B0;">ThemeContext.Consumer</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 2、底层组件 - class 组件</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">class</span><span style="color:#4EC9B0;"> ThemedButton</span><span style="color:#569CD6;"> extends</span><span style="color:#4EC9B0;"> React</span><span style="color:#D4D4D4;">.</span><span style="color:#4EC9B0;">Component</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 指定 contextType 读取当前的 theme context。</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // static contextType = ThemeContext // 也可以用 ThemedButton.contextType = ThemeContext</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    render</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> theme</span><span style="color:#D4D4D4;"> = </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">context</span><span style="color:#6A9955;"> // React 会往上找到最近的 theme Provider，然后使用它的值。</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">button&#39;s theme is </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">theme</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">ThemedButton</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">contextType</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">ThemeContext</span><span style="color:#6A9955;"> // 指定 contextType 读取当前的 theme context。</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 中间的组件再也不必指明往下传递 theme 了。</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> Toolbar</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#D4D4D4;"> (</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#4EC9B0;">ThemedButton</span><span style="color:#808080;"> /&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#4EC9B0;">ThemeLink</span><span style="color:#808080;"> /&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    )</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">class</span><span style="color:#4EC9B0;"> App</span><span style="color:#569CD6;"> extends</span><span style="color:#4EC9B0;"> React</span><span style="color:#D4D4D4;">.</span><span style="color:#4EC9B0;">Component</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    constructor</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        super</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            theme:</span><span style="color:#CE9178;"> &#39;light&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    render</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#808080;"> &lt;</span><span style="color:#4EC9B0;">ThemeContext.Provider</span><span style="color:#9CDCFE;"> value</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">theme</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#4EC9B0;">Toolbar</span><span style="color:#808080;"> /&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#569CD6;">hr</span><span style="color:#808080;">/&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#569CD6;">button</span><span style="color:#9CDCFE;"> onClick</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">changeTheme</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">change theme</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#4EC9B0;">ThemeContext.Provider</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    changeTheme</span><span style="color:#D4D4D4;"> = () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            theme:</span><span style="color:#569CD6;"> this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">theme</span><span style="color:#D4D4D4;"> === </span><span style="color:#CE9178;">&#39;light&#39;</span><span style="color:#D4D4D4;"> ? </span><span style="color:#CE9178;">&#39;dark&#39;</span><span style="color:#D4D4D4;"> : </span><span style="color:#CE9178;">&#39;light&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        })</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> App</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="异步组件" tabindex="-1"><a class="header-anchor" href="#异步组件"><span>异步组件</span></a></h4><ul><li>import()</li><li><strong>React.lazy</strong></li><li><strong>React.Suspense</strong></li></ul><p>在React.Suspense里加载异步组件，加载未完成时展示fallback里的内容，加载完毕后才展示异步组件的内容</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> ContextDemo</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">React</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">lazy</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#569CD6;"> import</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;./ContextDemo&#39;</span><span style="color:#D4D4D4;">))</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">class</span><span style="color:#4EC9B0;"> App</span><span style="color:#569CD6;"> extends</span><span style="color:#4EC9B0;"> React</span><span style="color:#D4D4D4;">.</span><span style="color:#4EC9B0;">Component</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    constructor</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        super</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    render</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">引入一个动态组件</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#569CD6;">hr</span><span style="color:#808080;"> /&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#4EC9B0;">React.Suspense</span><span style="color:#9CDCFE;"> fallback</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">Loading...</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">                &lt;</span><span style="color:#4EC9B0;">ContextDemo</span><span style="color:#808080;">/&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;/</span><span style="color:#4EC9B0;">React.Suspense</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> App</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="shouldcomponentupdate-scu" tabindex="-1"><a class="header-anchor" href="#shouldcomponentupdate-scu"><span>shouldComponentUpdate（SCU）</span></a></h4><p>是否更新组件</p><p>React 默认：父组件有更新，子组件则无条件也更新</p><p>SCU默认返回true</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#DCDCAA;">shouldComponentUpdate</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">nextProps</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">nextState</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">nextState</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> !== </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#569CD6;"> true</span><span style="color:#6A9955;"> // 可以渲染</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#569CD6;"> false</span><span style="color:#6A9955;"> // 不重复渲染</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="react-purecomponent" tabindex="-1"><a class="header-anchor" href="#react-purecomponent"><span>React.PureComponent</span></a></h4><p>在React中，当组件的props或state发生变化时，组件通常会重新渲染。然而，在某些情况下，组件的重新渲染可能是不必要的，尤其是在组件的渲染逻辑较为复杂或性能敏感的情况下。<code>React.PureComponent</code> 提供了一种简便的方法来避免不必要的重新渲染，从而提高性能。</p><p><code>React.PureComponent</code> 自动实现了 <code>shouldComponentUpdate</code> 方法，该方法会比较当前的props和state与即将更新的props和state。如果发现浅比较的结果表明新的props或state与当前的相同，那么组件将不会重新渲染。这里所说的“浅比较”是指只比较对象的引用，而不是深入比较对象的内容。</p><h5 id="如何使用-react-purecomponent" tabindex="-1"><a class="header-anchor" href="#如何使用-react-purecomponent"><span><strong>如何使用 <code>React.PureComponent</code></strong></span></a></h5><p>要使用 <code>React.PureComponent</code>，你需要让自己的类组件继承自 <code>React.PureComponent</code> 而不是直接继承自 <code>React.Component</code>。下面是一个简单的例子：</p><div class="language-jsx line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="jsx" data-title="jsx"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-jsx;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">PureComponent</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">class</span><span style="color:#4EC9B0;"> MyComponent</span><span style="color:#569CD6;"> extends</span><span style="color:#4EC9B0;"> PureComponent</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">  render</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> { </span><span style="color:#4FC1FF;">name</span><span style="color:#D4D4D4;"> } = </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">h1</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">Hello, </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">name</span><span style="color:#569CD6;">}</span><span style="color:#D4D4D4;">!</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">h1</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在这个例子中，<code>MyComponent</code> 继承自 <code>React.PureComponent</code>。这意味着，如果父组件传递给 <code>MyComponent</code> 的props没有改变（基于浅比较），那么 <code>MyComponent</code> 不会被重新渲染。</p><h5 id="自定义比较逻辑" tabindex="-1"><a class="header-anchor" href="#自定义比较逻辑"><span><strong>自定义比较逻辑</strong></span></a></h5><p>虽然 <code>React.PureComponent</code> 默认使用浅比较来决定是否更新组件，但在某些情况下，你可能需要更详细的比较逻辑。例如，如果你的props包含深层嵌套的对象或数组，你可能希望深入比较这些对象的内容。此时，你可以覆盖 <code>shouldComponentUpdate</code> 方法来实现自定义的比较逻辑：</p><div class="language-jsx line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="jsx" data-title="jsx"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-jsx;"><code><span class="line"><span class="line"><span style="color:#569CD6;">class</span><span style="color:#4EC9B0;"> MyComponent</span><span style="color:#569CD6;"> extends</span><span style="color:#4EC9B0;"> PureComponent</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">  shouldComponentUpdate</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">nextProps</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">nextState</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 深度比较 props 中的某个对象</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    if</span><span style="color:#D4D4D4;"> (</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">someObject</span><span style="color:#D4D4D4;"> !== </span><span style="color:#9CDCFE;">nextProps</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">someObject</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">      return</span><span style="color:#569CD6;"> false</span><span style="color:#D4D4D4;">; </span><span style="color:#6A9955;">// 如果对象引用不同，但是你想检查内容是否真的改变了</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 进行深度比较</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    if</span><span style="color:#D4D4D4;"> (!</span><span style="color:#DCDCAA;">isEqual</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">someObject</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">nextProps</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">someObject</span><span style="color:#D4D4D4;">)) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">      return</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">; </span><span style="color:#6A9955;">// 如果内容不同，则需要更新</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#569CD6;"> false</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">  render</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> { </span><span style="color:#4FC1FF;">name</span><span style="color:#D4D4D4;"> } = </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">h1</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">Hello, </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">name</span><span style="color:#569CD6;">}</span><span style="color:#D4D4D4;">!</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">h1</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在这个例子中，我们使用了一个假想的 <code>isEqual</code> 函数来进行深度比较。在实际应用中，你可能需要使用一个库，如 <code>lodash</code> 的 <code>_.isEqual</code> 方法来实现这一点。</p><h5 id="注意事项-1" tabindex="-1"><a class="header-anchor" href="#注意事项-1"><span><strong>注意事项</strong></span></a></h5><ul><li><strong>浅比较的局限性</strong>：<code>React.PureComponent</code> 使用浅比较，这意味着它只会比较props和state的引用。如果你的props或state包含复杂的数据结构（如对象或数组），并且这些数据结构内部的变化不会改变它们的引用，那么 <code>React.PureComponent</code> 可能不会按预期工作。</li><li><strong>性能考量</strong>：虽然 <code>React.PureComponent</code> 可以提高性能，但如果你的应用已经很好地进行了优化，使用 <code>React.PureComponent</code> 可能不会带来显著的好处。另外，过度使用 <code>React.PureComponent</code> 也可能导致不必要的复杂性。</li><li><strong>类组件 vs 函数组件</strong>：随着React Hooks的引入，许多开发者倾向于使用函数组件而不是类组件。在这种情况下，可以使用 <code>React.memo</code> 来代替 <code>React.PureComponent</code>。</li></ul><h4 id="react-memo" tabindex="-1"><a class="header-anchor" href="#react-memo"><span>React.memo</span></a></h4><p><code>React.memo</code> 是一个高阶组件（Higher-Order Component, HOC），用于优化函数组件的性能。</p><p>它通过记忆化（memoization）机制来避免不必要的重新渲染，从而提升应用的性能。</p><p>我们可以使用 <code>React.memo</code> 来包装函数组件，只有当传递给它的props发生变化时，才会重新渲染这个组件。</p><h5 id="使用方法" tabindex="-1"><a class="header-anchor" href="#使用方法"><span><strong>使用方法</strong></span></a></h5><p><code>React.memo</code> 接受一个函数组件作为参数，并返回一个新的经过优化的组件。</p><p>还可以传入第二个参数：一个比较函数（comparator function），这个函数用来比较新旧props，以决定是否需要重新渲染。</p><div class="language-jsx line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="jsx" data-title="jsx"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-jsx;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">memo</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> MyComponent</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">memo</span><span style="color:#D4D4D4;">(({ </span><span style="color:#9CDCFE;">prop1</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">prop2</span><span style="color:#D4D4D4;"> }) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> (</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">  &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#569CD6;">h1</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">Prop1: </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">prop1</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">h1</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#569CD6;">h2</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">Prop2: </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">prop2</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">h2</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">  &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">));</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="使用比较函数" tabindex="-1"><a class="header-anchor" href="#使用比较函数"><span><strong>使用比较函数</strong></span></a></h5><p>如果你需要自定义props的比较逻辑，可以提供一个比较函数作为 <code>React.memo</code> 的第二个参数。这个函数接受两个参数：上一次渲染时的props和当前的新props。如果这两个props被认为是相等的，则不会重新渲染组件。</p><div class="language-jsx line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="jsx" data-title="jsx"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-jsx;"><code><span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> MyComponent</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">memo</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> MyComponent</span><span style="color:#D4D4D4;">({ </span><span style="color:#9CDCFE;">prop1</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">prop2</span><span style="color:#D4D4D4;"> }) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  return</span><span style="color:#D4D4D4;"> (</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">      &lt;</span><span style="color:#569CD6;">h1</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">Prop1: </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">prop1</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">h1</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">      &lt;</span><span style="color:#569CD6;">h2</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">Prop2: </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">prop2</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">h2</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  );</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}, (</span><span style="color:#9CDCFE;">prevProps</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">nextProps</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">  // 只有当prop1改变时才重新渲染</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  return</span><span style="color:#9CDCFE;"> prevProps</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">prop1</span><span style="color:#D4D4D4;"> === </span><span style="color:#9CDCFE;">nextProps</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">prop1</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">});</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="注意事项-2" tabindex="-1"><a class="header-anchor" href="#注意事项-2"><span><strong>注意事项</strong></span></a></h5><ul><li><strong>默认比较</strong>：当没有提供比较函数时，<code>React.memo</code> 默认使用浅层比较（shallow comparison）来检查props的变化。这意味着如果props对象或数组的引用发生了变化，即使其内部值未变，也会认为props发生了改变。</li><li><strong>不可用于类组件</strong>：<code>React.memo</code> 只能用于函数组件，如果你正在使用类组件，可以考虑使用 <code>React.PureComponent</code> 或者手动实现 <code>shouldComponentUpdate</code> 生命周期方法来达到类似的效果。</li><li><strong>性能考量</strong>：虽然 <code>React.memo</code> 可以提高性能，但也需要权衡其带来的额外开销。只有当组件的渲染成本较高且其props频繁改变时，使用 <code>React.memo</code> 才有意义。</li></ul><h4 id="不可变值-immutable-js" tabindex="-1"><a class="header-anchor" href="#不可变值-immutable-js"><span>不可变值 immutable.js</span></a></h4><p>不可变性意味着一旦一个数据对象被创建，就不能再被更改。相反，当你需要修改数据时，你需要创建一个新的对象，而不是修改原有的对象。</p><p>实现不可变性的一种常见方法是使用不可变数据结构和库，如 <a href="https://immutable-js.github.io/immutable-js/" target="_blank" rel="noopener noreferrer">Immutable.js</a>。这个库提供了一套丰富的API来创建和操作不可变的数据结构，如Map、List等。</p><p>immutable对象是不可直接赋值的对象，它可以有效的避免错误赋值的问题</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">Map</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">List</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;immutable&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 创建一个不可变的Map</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> person</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">Map</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  name:</span><span style="color:#CE9178;"> &#39;Alice&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  age:</span><span style="color:#B5CEA8;"> 30</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  hobbies:</span><span style="color:#DCDCAA;"> List</span><span style="color:#D4D4D4;">([</span><span style="color:#CE9178;">&#39;reading&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;writing&#39;</span><span style="color:#D4D4D4;">])</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">});</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 修改person中的age</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> updatedPerson</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">person</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">set</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;age&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#B5CEA8;">31</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">updatedPerson</span><span style="color:#D4D4D4;">); </span><span style="color:#6A9955;">// 输出: Map { &quot;name&quot;: &quot;Alice&quot;, &quot;age&quot;: 31, &quot;hobbies&quot;: List [ &quot;reading&quot;, &quot;writing&quot; ] }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 添加一个新的爱好</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> personWithNewHobby</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">updatedPerson</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">update</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;hobbies&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">hobbies</span><span style="color:#569CD6;"> =&gt;</span><span style="color:#9CDCFE;"> hobbies</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">push</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;painting&#39;</span><span style="color:#D4D4D4;">));</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">personWithNewHobby</span><span style="color:#D4D4D4;">); </span><span style="color:#6A9955;">// 输出: Map { &quot;name&quot;: &quot;Alice&quot;, &quot;age&quot;: 31, &quot;hobbies&quot;: List [ &quot;reading&quot;, &quot;writing&quot;, &quot;painting&quot; ] }</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在这个例子中，我们创建了一个包含姓名、年龄和爱好的不可变Map。当我们需要修改年龄或添加一个新的爱好时，我们创建了一个新的Map实例，而不是修改原来的实例。</p><h4 id="高阶组件hoc" tabindex="-1"><a class="header-anchor" href="#高阶组件hoc"><span>高阶组件HOC⭐</span></a></h4><p>这篇文章推荐阅读：<a href="https://juejin.cn/post/7220677873584734268" target="_blank" rel="noopener noreferrer">高阶组件（HOC）在 React 中的应用</a></p><ul><li><p>**高阶组件（HOC）是一个接收组件作为参数并返回一个新组件的函数。**换句话说，它是一种组件的转换器。</p></li><li><p>高阶组件通常用于在组件之间<strong>复用逻辑</strong>，例如<strong>状态管理、数据获取、访问控制</strong>等。</p></li><li><p>HOC 的一个常见示例是 React-Redux 的 <code>connect</code> 函数，它将 Redux store 连接到 React 组件，使组件可以访问和更新 store 中的状态。</p></li><li><p>我在实际工作中应用在了权限控制和错误边界中（看上面发的文章）</p></li></ul><h5 id="基本使用" tabindex="-1"><a class="header-anchor" href="#基本使用"><span>基本使用</span></a></h5><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 高阶组件不是一种功能，而是一种模式</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#DCDCAA;"> HOCFactory</span><span style="color:#D4D4D4;"> = (</span><span style="color:#9CDCFE;">Component</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    class</span><span style="color:#4EC9B0;"> HOC</span><span style="color:#569CD6;"> extends</span><span style="color:#4EC9B0;"> React</span><span style="color:#D4D4D4;">.</span><span style="color:#4EC9B0;">Component</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        render</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">            // 返回拼装的结果</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">            return</span><span style="color:#808080;"> &lt;</span><span style="color:#4EC9B0;">Component</span><span style="color:#569CD6;"> {</span><span style="color:#D4D4D4;">...</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">props</span><span style="color:#569CD6;">}</span><span style="color:#808080;">/&gt;</span><span style="color:#D4D4D4;"> </span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#4FC1FF;"> HOC</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> EnhancesComponent1</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">HOCFactory</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">WrappedComponent1</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> EnhancesComponent2</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">HOCFactory</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">WrappedComponent2</span><span style="color:#D4D4D4;">)</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="应用一-权限控制" tabindex="-1"><a class="header-anchor" href="#应用一-权限控制"><span>应用一：权限控制</span></a></h5><p>根据用户权限来显示或隐藏某些组件。</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &quot;react&quot;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> withAuthorization</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">WrappedComponent</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">requiredPermission</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  return</span><span style="color:#569CD6;"> function</span><span style="color:#DCDCAA;"> WithAuthorizationComponent</span><span style="color:#D4D4D4;">({ </span><span style="color:#9CDCFE;">userPermission</span><span style="color:#D4D4D4;">, ...</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;"> }) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">userPermission</span><span style="color:#D4D4D4;"> &gt;= </span><span style="color:#9CDCFE;">requiredPermission</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">      return</span><span style="color:#808080;"> &lt;</span><span style="color:#4EC9B0;">WrappedComponent</span><span style="color:#569CD6;"> {</span><span style="color:#D4D4D4;">...</span><span style="color:#9CDCFE;">props</span><span style="color:#569CD6;">}</span><span style="color:#808080;"> /&gt;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    } </span><span style="color:#C586C0;">else</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">      return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">您没有查看此内容的权限。</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  };</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> withAuthorization</span><span style="color:#D4D4D4;">;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="应用二-错误边界" tabindex="-1"><a class="header-anchor" href="#应用二-错误边界"><span>应用二：错误边界</span></a></h5><p>在 React 中，错误边界是一种用于捕获子组件树中发生的错误并显示友好错误信息的技术。我们可以使用高阶组件来实现一个通用的错误边界组件。</p><p>在这个高阶组件中，我们返回一个类组件，因为错误边界需要使用生命周期方法 <code>componentDidCatch</code> 和静态方法 <code>getDerivedStateFromError</code>。我们在组件的状态中记录是否发生了错误，并在渲染方法中根据 <code>hasError</code> 的值来决定是显示错误消息还是渲染 <code>WrappedComponent</code>。</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">Component</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &quot;react&quot;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> withErrorBoundary</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">WrappedComponent</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  return</span><span style="color:#569CD6;"> class</span><span style="color:#4EC9B0;"> WithErrorBoundaryComponent</span><span style="color:#569CD6;"> extends</span><span style="color:#4EC9B0;"> Component</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    constructor</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">      super</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">      this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;"> = { </span><span style="color:#9CDCFE;">hasError:</span><span style="color:#569CD6;"> false</span><span style="color:#D4D4D4;"> };</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    static</span><span style="color:#DCDCAA;"> getDerivedStateFromError</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">      return</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">hasError:</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;"> };</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    componentDidCatch</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">error</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">info</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">      // 处理错误记录</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">error</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;Error:&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">error</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&quot;Info:&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">info</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    render</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">      if</span><span style="color:#D4D4D4;"> (</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">hasError</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">Something went wrong. Please try again later.</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      }</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">      return</span><span style="color:#808080;"> &lt;</span><span style="color:#4EC9B0;">WrappedComponent</span><span style="color:#569CD6;"> {</span><span style="color:#D4D4D4;">...</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">props</span><span style="color:#569CD6;">}</span><span style="color:#808080;"> /&gt;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  };</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> withErrorBoundary</span><span style="color:#D4D4D4;">;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="应用三-性能监控" tabindex="-1"><a class="header-anchor" href="#应用三-性能监控"><span>应用三：性能监控</span></a></h5><p>在这个高阶组件中，我们使用 <code>useRef</code> 和 <code>useEffect</code> Hooks 来计算 <code>WrappedComponent</code> 的渲染时间。当组件被渲染时，我们记录开始时间，然后在 <code>useEffect</code> 中计算渲染所花费的时间，并将结果打印到控制台</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">useEffect</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">useRef</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &quot;react&quot;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> withPerformance</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">WrappedComponent</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  return</span><span style="color:#569CD6;"> function</span><span style="color:#DCDCAA;"> WithPerformanceComponent</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> startTime</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useRef</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">Date</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">now</span><span style="color:#D4D4D4;">());</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    useEffect</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">      const</span><span style="color:#4FC1FF;"> endTime</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">Date</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">now</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">      const</span><span style="color:#4FC1FF;"> renderTime</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">endTime</span><span style="color:#D4D4D4;"> - </span><span style="color:#9CDCFE;">startTime</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">current</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">`</span><span style="color:#569CD6;">${</span><span style="color:#9CDCFE;">WrappedComponent</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">name</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;"> render time: </span><span style="color:#569CD6;">${</span><span style="color:#9CDCFE;">renderTime</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;"> ms`</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }, []);</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#4EC9B0;">WrappedComponent</span><span style="color:#569CD6;"> {</span><span style="color:#D4D4D4;">...</span><span style="color:#9CDCFE;">props</span><span style="color:#569CD6;">}</span><span style="color:#808080;"> /&gt;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  };</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> withPerformance</span><span style="color:#D4D4D4;">;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="redux-connect-是高阶组件" tabindex="-1"><a class="header-anchor" href="#redux-connect-是高阶组件"><span>redux connect 是高阶组件</span></a></h5><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">connect</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react-redux&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// connect是高阶组件</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> VisibleTodoList</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">connect</span><span style="color:#D4D4D4;">(</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">	mapStateToProps</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    mapDispatchToProps</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">)(</span><span style="color:#9CDCFE;">TodoList</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> VisibleTodolList</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="render-props" tabindex="-1"><a class="header-anchor" href="#render-props"><span>Render Props</span></a></h4><p>在React中，<code>render props</code>是一种模式或一种技术，它允许一个组件通过其<code>props</code>中的一个名为<code>render</code>的函数来渲染子组件。这个模式可以让你更灵活地指定一个组件要如何渲染其部分或全部UI，同时还能保持良好的可复用性和模块化。</p><h5 id="基本使用-1" tabindex="-1"><a class="header-anchor" href="#基本使用-1"><span>基本使用</span></a></h5><ol><li><strong>定义组件</strong>：创建一个接受<code>render prop</code>的父组件。这个<code>render prop</code>应该是一个函数，该函数通常接收一些参数（如数据或方法）作为输入，并返回需要渲染的React元素。</li><li><strong>消费组件</strong>：在消费这个组件的地方，传递一个函数作为<code>render prop</code>的值。这个函数将会使用父组件提供的数据或行为来生成UI。</li></ol><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// Render Props的核心思想</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 通过一个函数将class组件的state作为props传递给纯函数组件</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">class</span><span style="color:#4EC9B0;"> Factory</span><span style="color:#569CD6;"> extends</span><span style="color:#4EC9B0;"> React</span><span style="color:#D4D4D4;">.</span><span style="color:#4EC9B0;">Component</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    constructor</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">            // state即多个组件的公共逻辑的数据</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 修改state</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    render</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">render</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">)</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#DCDCAA;"> App</span><span style="color:#D4D4D4;"> = () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> (</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#4EC9B0;">Factory</span><span style="color:#9CDCFE;"> render</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // render是一个函数组件</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        (</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">)</span><span style="color:#569CD6;">=&gt;</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">a</span><span style="color:#569CD6;">}</span><span style="color:#569CD6;"> {</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">b</span><span style="color:#569CD6;">}</span><span style="color:#D4D4D4;"> ... </span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    }</span><span style="color:#808080;">/&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">)</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="例子" tabindex="-1"><a class="header-anchor" href="#例子"><span>例子</span></a></h5><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> PropTypes</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;prop-types&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">class</span><span style="color:#4EC9B0;"> Mouse</span><span style="color:#569CD6;"> extends</span><span style="color:#4EC9B0;"> React</span><span style="color:#D4D4D4;">.</span><span style="color:#4EC9B0;">Component</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    constructor</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        super</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;"> = { </span><span style="color:#9CDCFE;">x:</span><span style="color:#B5CEA8;"> 0</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">y:</span><span style="color:#B5CEA8;"> 0</span><span style="color:#D4D4D4;"> }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  </span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    handleMouseMove</span><span style="color:#D4D4D4;"> = (</span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">      this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        x:</span><span style="color:#9CDCFE;"> event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">clientX</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        y:</span><span style="color:#9CDCFE;"> event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">clientY</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      })</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  </span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    render</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">      return</span><span style="color:#D4D4D4;"> (</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">div</span><span style="color:#9CDCFE;"> style</span><span style="color:#F44747;">={{ height: &#39;500px&#39; }}</span><span style="color:#9CDCFE;"> onMouseMove</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">handleMouseMove</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">            {</span><span style="color:#6A9955;">/* 将当前 state 作为 props ，传递给 render （render 是一个函数组件） */</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">            {this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">render</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">)</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      )</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">Mouse</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">propTypes</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    render:</span><span style="color:#9CDCFE;"> PropTypes</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">func</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">isRequired</span><span style="color:#6A9955;"> // 必须接收一个 render 属性，而且是函数</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#DCDCAA;"> App</span><span style="color:#D4D4D4;"> = (</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> (</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#569CD6;">div</span><span style="color:#9CDCFE;"> style</span><span style="color:#F44747;">={{ height: &#39;500px&#39; }}&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#F44747;">        &lt;p&gt;{props.a}&lt;/p&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#F44747;">        &lt;Mouse</span><span style="color:#9CDCFE;"> render</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">            /* render 是一个函数组件 */</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            ({ </span><span style="color:#9CDCFE;">x</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">y</span><span style="color:#D4D4D4;"> }) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">h1</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">The mouse position is (</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">x</span><span style="color:#569CD6;">}</span><span style="color:#D4D4D4;">, </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">y</span><span style="color:#569CD6;">}</span><span style="color:#D4D4D4;">)</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">h1</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        }</span><span style="color:#808080;">/&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        </span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    &lt;/</span><span style="color:#9CDCFE;">div</span><span style="color:#D4D4D4;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">/**</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;"> * 即，定义了 Mouse 组件，只有获取 x y 的能力。</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;"> * 至于 Mouse 组件如何渲染，App 说了算，通过 render props 的方式告诉 Mouse 。</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;"> */</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> App</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="hoc-vs-render-props" tabindex="-1"><a class="header-anchor" href="#hoc-vs-render-props"><span>HOC VS Render Props</span></a></h5><ul><li>HOC：模式简单 但会增加组件层级</li><li>Render Props：代码简洁，学习成本较高</li><li>按需使用</li></ul><h3 id="_3、redux" tabindex="-1"><a class="header-anchor" href="#_3、redux"><span>3、Redux⭐</span></a></h3><p>Redux是一个JavaScript状态管理库</p><h4 id="redux-的核心概念" tabindex="-1"><a class="header-anchor" href="#redux-的核心概念"><span><strong>Redux 的核心概念</strong></span></a></h4><p>1、<strong>State（状态）</strong>：</p><ul><li>整个应用的状态都存储在一个单一的对象树中。这个对象树存储在一个全局的 store 中。这意味着你的应用所有部分的状态都被集中在一起，而不是分散在多个组件中。</li></ul><p>2、<strong>Store（仓库/存储）</strong>：</p><ul><li>Store 是保存整个应用状态的地方。只有一个单一的 store 对象，它包含整个应用的状态树。Store 还提供了方法如 <code>getState()</code> 来获取状态，<code>dispatch(action)</code> 来发送动作，以及 <code>subscribe(listener)</code> 来注册监听器。</li></ul><p>3、<strong>Actions（动作）</strong>：</p><ul><li>动作是携带数据的普通 JavaScript 对象，用来描述发生了什么。它们是应用中的数据源，<strong>是唯一可以改变状态的方法</strong>。动作由用户交互（例如点击按钮）或者某些业务逻辑触发。</li></ul><p>4、<strong>Reducers（规约器/减少器）</strong>：</p><ul><li>Reducers 告诉应用状态如何响应不同的动作。**它们是一个纯函数，接收当前状态和动作作为参数，并返回新的状态。**Reducers 必须是纯函数，这意味着对于相同的输入，它们必须总是返回相同的结果，并且除了计算外不做任何其他事情（比如修改状态或进行 I/O 操作）。</li></ul><h4 id="使用-redux-的步骤" tabindex="-1"><a class="header-anchor" href="#使用-redux-的步骤"><span><strong>使用 Redux 的步骤</strong></span></a></h4><ol><li>定义 Actions：为每种类型的动作创建一个常量字符串。</li><li>创建 Action Creators：这些是创建 actions 的工厂函数。</li><li>编写 Reducers：根据应用的状态和动作来定义状态更新的逻辑。</li><li>创建 Store：使用 <code>createStore</code> 函数结合 reducer 创建 store。</li><li>将 Store 和 React 组件连接起来：使用 <code>react-redux</code> 库提供的 <code>Provider</code> 和 <code>connect</code> 函数，可以让 React 组件访问到 store 中的数据。</li></ol><p>Redux 的设计使得它非常适合大型应用程序，特别是那些需要在客户端维持复杂状态的应用。它还支持中间件，如日志记录、崩溃报告和异步操作等，这进一步增强了它的灵活性和功能。</p><h4 id="代码示例" tabindex="-1"><a class="header-anchor" href="#代码示例"><span><strong>代码示例</strong></span></a></h4><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// store/index.js</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> {</span><span style="color:#9CDCFE;">createStore</span><span style="color:#D4D4D4;">} </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;redux&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> reducer</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;./reducer&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> store</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">createStore</span><span style="color:#D4D4D4;">(</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">	reducer</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">	window</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">__REDUX_DEVTOOLS_EXTENSION__</span><span style="color:#D4D4D4;"> &amp;&amp;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    window</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">__REDUX_DEVTOOLS_EXTENSION__</span><span style="color:#D4D4D4;">()  </span><span style="color:#6A9955;">// 用于redux调试</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// store/reducer.js</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> defaultState</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    inputValue:</span><span style="color:#CE9178;"> &#39;&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    list:</span><span style="color:#D4D4D4;"> []</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">};</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// reducer 可以接收state，但绝不能修改state，所以要另外拷贝一个</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">defaultState</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">action</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">action</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">type</span><span style="color:#D4D4D4;"> === </span><span style="color:#CE9178;">&#39;change_input_value&#39;</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 深拷贝</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> newState</span><span style="color:#D4D4D4;"> = </span><span style="color:#4FC1FF;">JSON</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">parse</span><span style="color:#D4D4D4;">(</span><span style="color:#4FC1FF;">JSON</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">stringify</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">));</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        newState</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">inputValue</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">action</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#9CDCFE;"> newState</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#9CDCFE;"> state</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// Todolist.js (部分)</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> store</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;./store&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">class</span><span style="color:#4EC9B0;"> TodoList</span><span style="color:#569CD6;"> extends</span><span style="color:#4EC9B0;"> Component</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  constructor</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    super</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">store</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">getState</span><span style="color:#D4D4D4;">()</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">handleInputChange</span><span style="color:#D4D4D4;"> = </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">handleInputChange</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">bind</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">handleStoreChange</span><span style="color:#D4D4D4;"> = </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">handleStoreChange</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">bind</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    store</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">subscribe</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">handleStoreChange</span><span style="color:#D4D4D4;">);  </span><span style="color:#6A9955;">// 订阅方法设置更新数据</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  }</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">  render</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#D4D4D4;"> (</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">      &lt;</span><span style="color:#4EC9B0;">TodoListUI</span><span style="color:#D4D4D4;"> </span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        inputValue</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">inputValue</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        list</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">list</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        handleInputChange</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">handleInputChange</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        handleBtnClick</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">handleBtnClick</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        handleItemDelete</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">handleItemDelete</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">      /&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    )</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  }</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">  handleInputChange</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> action</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">getInputChangeAction</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    store</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">dispatch</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">action</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  }</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">  handleStoreChange</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">store</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">getState</span><span style="color:#D4D4D4;">());</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="改变store里的数据" tabindex="-1"><a class="header-anchor" href="#改变store里的数据"><span><strong>改变store里的数据</strong></span></a></h4><p>1、先派发一个action，通过dispatch方法传递给store</p><p>2、store 自动调用 reducer，reducer中接收state和action进行处理，返回一个新的state返回给store，替换原来的store</p><p>3、store中数据改变react感知到store数据的改变，通过store.subscribe()订阅方法设置更新数据</p><h4 id="redux设计和使用的三项原则" tabindex="-1"><a class="header-anchor" href="#redux设计和使用的三项原则"><span><strong>Redux设计和使用的三项原则</strong></span></a></h4><p>1.store是唯一的</p><p>2.只有store能改变自己的内容</p><p>3.reducer必须是纯函数</p><p><strong>纯函数</strong>：给定固定的输入，就一定会有固定的输出，而且不会有任何的副作用</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 这样的函数被称为纯函数，因为该函数不会尝试更改入参，且多次调用下相同的入参始终返回相同的参数。</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">funcition</span><span style="color:#DCDCAA;"> sum</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">a</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">b</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#9CDCFE;"> a</span><span style="color:#D4D4D4;"> + </span><span style="color:#9CDCFE;">b</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 下面不是，自己更改了入参</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> withdraw</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">account</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">amount</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    account</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">total</span><span style="color:#D4D4D4;"> -= </span><span style="color:#9CDCFE;">amount</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="redux核心api" tabindex="-1"><a class="header-anchor" href="#redux核心api"><span><strong>Redux核心API</strong></span></a></h4><p>1、createStore ——创建store</p><p>2、store.dispatch ——派发action，这个action会传递给store</p><p>3、store.getState ——获取store中所有的数据内容</p><p>4、store.subscribe ——订阅store的改变，只要store发生改变，subscribe中接收的回调函数就会被执行</p><h3 id="_4、redux的中间件" tabindex="-1"><a class="header-anchor" href="#_4、redux的中间件"><span>4、Redux的中间件</span></a></h3><p>对dispatch方法进行升级：</p><p>接收对象，和原来一样，直接传递对象给store</p><p>接收函数，先执行函数，执行完后需要调用store再操作</p><p>如：</p><p>redux-thunk中间件——改造store.dispatch使得后者可以接受函数作为参数</p><p>redux-saga——单独把逻辑拆分出来放到另一个文件中管理</p><p><strong>ps：中间是指action和store的中间，中间件是Redux的中间件，而不是react</strong></p><p><strong>redux-thunk的使用</strong></p><p><strong>redux-saga的使用</strong></p><h3 id="_5、react-redux" tabindex="-1"><a class="header-anchor" href="#_5、react-redux"><span>5、React-Redux</span></a></h3><p>运用Provider将组件和store对接，使在Provider里的所有组件都能共享store里的数据，</p><p>使用connect将 Redux store 和 React 组件连接，使组件可以访问和更新 store 中的状态。</p><p><strong>核心API</strong>：</p><p>Provider：作用：连接store，内部组件都有能力获取store的内容</p><p>connect：组件与store作连接</p><p>mapStateToProps：把store中state映射成组件中的props</p><p>mapDispatchToProps：将store.dispatch挂载到props上</p><h3 id="_6、react-router使用" tabindex="-1"><a class="header-anchor" href="#_6、react-router使用"><span>6、React-router使用</span></a></h3><p><a href="https://csmsimona.github.io/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/Vue%E5%B0%8F%E8%AE%B0.html#_5%E3%80%81vue-router%E4%BD%BF%E7%94%A8" target="_blank" rel="noopener noreferrer">Vue Router的使用</a></p><ul><li>路由模式（hash、H5 history），同vue-router</li><li>路由配置（动态路由、懒加载），同vue-router</li></ul><p><img src="/assets/react-router%E8%B7%AF%E7%94%B1%E6%A8%A1%E5%BC%8F-CFLigZr6.jpg" alt="react-router路由模式"></p><p><img src="/assets/react-router%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1-BEhNwp3K.jpg" alt="react-router动态路由"></p><p><img src="/assets/react-router%E8%B7%B3%E8%BD%AC%E8%B7%AF%E7%94%B1-BKkPn9JS.jpg" alt="react-router跳转路由"></p><p><img src="/assets/react-router%E6%87%92%E5%8A%A0%E8%BD%BD-B2S47Bbi.jpg" alt="react-router懒加载"></p><h2 id="二、react原理" tabindex="-1"><a class="header-anchor" href="#二、react原理"><span>二、React原理</span></a></h2><h3 id="_1、函数式编程" tabindex="-1"><a class="header-anchor" href="#_1、函数式编程"><span>1、函数式编程</span></a></h3><p>核心概念</p><ul><li><p><strong>不可变性(Immutability)</strong></p><p>不可变性意味着不可改变。 在函数式编程中，你无法更改数据，也不能更改。 如果要改变或更改数据，则必须复制数据副本来更改。</p></li><li><p><strong>纯函数(Pure Functions)</strong></p><p>给定固定的输入，就一定会有固定的输出，而且不会有任何的副作用</p></li><li><p><strong>数据转换(Data Transformations)</strong></p><p>我们总是生成原始数据的转换副本，而不是直接更改原始数据。</p></li><li><p><strong>高阶函数 (Higher-Order Functions)</strong></p><p>在函数式编程中，高阶函数是指接受一个或多个函数作为参数，并且/或者返回一个函数的函数。</p><p><code>Array.map、Array.filter和Array.reduce</code>是高阶函数，因为它们将函数作为参数。</p></li><li><p><strong>递归</strong></p><p>递归是一种函数在满足一定条件之前调用自身的技术。只要可能，最好使用递归而不是循环。你必须注意这一点，浏览器不能处理太多递归和抛出错误。</p></li><li><p><strong>组合</strong></p><p>我们将功能划分为小型可重用的纯函数，我们必须将所有这些可重用的函数放在一起，最终使其成为产品。 将所有较小的函数组合成更大的函数，最终，得到一个应用程序，这称为<strong>组合</strong>。</p></li></ul><h3 id="_2、虚拟dom" tabindex="-1"><a class="header-anchor" href="#_2、虚拟dom"><span>2、虚拟DOM⭐</span></a></h3><h4 id="什么是虚拟dom" tabindex="-1"><a class="header-anchor" href="#什么是虚拟dom"><span>什么是虚拟DOM？</span></a></h4><p>用JS模拟DOM结构，DOM变化的对比，放在JS层进行（因为前端语言中只有JS是图灵完备语言）</p><p><a href="https://blog.csdn.net/Roselane_Begger/article/details/101176694" target="_blank" rel="noopener noreferrer">什么是图灵完备语言？</a></p><ul><li><p>创建真实DOM损耗的性能远大于创建虚拟DOM损耗的性能。</p></li><li><p>虚拟DOM提高性能，不是说不操作DOM，而是减少操作DOM的次数，减少回流和重绘。</p></li><li><p>虚拟 dom 相当于在 js 和真实 dom 中间加了一个缓存，利用 <strong>dom diff 算法避免了没有必要的 dom 操作</strong>，从而提高性能。</p></li></ul><h4 id="虚拟dom的优点" tabindex="-1"><a class="header-anchor" href="#虚拟dom的优点"><span><strong>虚拟DOM的优点</strong></span></a></h4><p>1、<strong>性能优化</strong>：在直接操作真实的 DOM 时，每次更改都会导致页面重新渲染，这是一个昂贵的操作。而虚拟 DOM 可以先在内存中进行批量的更新，然后再一次性地将最终的变更应用到实际的 DOM 上，从而减少了重绘和回流的次数。</p><p>2、<strong>代码简洁</strong>：虚拟 DOM 使得 React 组件可以用更简洁、更具声明性的代码编写。开发者只需要关心应用的状态和如何根据状态渲染 UI，而不需要关心 DOM 操作的具体细节。</p><p>3、<strong>跨平台</strong>：React Native 利用了虚拟 DOM 的概念，可以在不同的平台上（如 iOS 和 Android）创建相似的用户界面，而不仅仅是Web。</p><h4 id="虚拟dom实现" tabindex="-1"><a class="header-anchor" href="#虚拟dom实现"><span>虚拟DOM实现</span></a></h4><p><strong>1、state数据</strong></p><p><strong>2、JSX模板</strong></p><p><strong>3、数据+模板 生成虚拟DOM（虚拟DOM就是一个JS对象，用它来描述真实DOM）（损耗了性能）</strong></p><p><code>[&#39;div&#39;, {id: &#39;abc&#39;}, [&#39;span&#39;, {}, &#39;hello world&#39;]]</code></p><p><strong>4、用虚拟DOM的结构，生成真实的DOM来显示</strong></p><p><code>&lt;div id=&#39;abc&#39;&gt;&lt;span&gt;hello world&lt;/span&gt;&lt;/div&gt;</code></p><p><strong>5、state发生变化</strong></p><p><strong>6、数据+模板 生成新的虚拟DOM（极大地提升了性能）</strong></p><p><code>[&#39;div&#39;, {id: &#39;abc&#39;}, [&#39;span&#39;, {}, &#39;byebye&#39;]]</code></p><p><strong>7、比较原始虚拟DOM和新的虚拟DOM的区别，找到区别是span中的内容（极大地提升了性能）</strong></p><p><strong>8、直接操作DOM，改变span中的内容</strong></p><p>JSX =&gt; createElement =&gt; 虚拟DOM（JS对象）=&gt; 真实DOM</p><p><strong>jsx本质</strong></p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> imgElem</span><span style="color:#D4D4D4;"> = </span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">div</span><span style="color:#9CDCFE;"> id</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;div1&quot;</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">some text</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">	&lt;</span><span style="color:#569CD6;">img</span><span style="color:#9CDCFE;"> src</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">imgUrl</span><span style="color:#569CD6;">}</span><span style="color:#808080;"> /&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 编译后</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">React</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">createElement</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;div&quot;</span><span style="color:#D4D4D4;">, {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    id:</span><span style="color:#CE9178;"> &quot;div1&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}, </span><span style="color:#9CDCFE;">React</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">createElement</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;p&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#569CD6;">null</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&quot;some text&quot;</span><span style="color:#D4D4D4;">), </span><span style="color:#9CDCFE;">React</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">createElement</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;img&quot;</span><span style="color:#D4D4D4;">, {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    src:</span><span style="color:#9CDCFE;"> imgUrl</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}))</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="diff-算法" tabindex="-1"><a class="header-anchor" href="#diff-算法"><span>diff 算法</span></a></h4><h5 id="react-早期版本中的-diff-算法" tabindex="-1"><a class="header-anchor" href="#react-早期版本中的-diff-算法"><span>React 早期版本中的 Diff 算法</span></a></h5><p>在 React 15 及更早的版本中，diff 算法主要基于以下三个假设：</p><ol><li><strong>在同一个层级上，如果两个元素的类型不同，则认为它们之间没有关联</strong>。这意味着 React 会删除旧元素，并添加新元素。</li><li><strong>对于同类型的元素，如果它们拥有相同的 key，React 认为这两个元素是同一个元素</strong>。因此，React 只会更新这个元素的属性或子元素。</li><li><strong>对于拥有 key 的元素列表，React 会尝试找到相同 key 的元素并复用它们</strong>。如果没有指定 key，React 只能依赖元素的位置来进行匹配。</li></ol><p>这个算法的基本思想是通过比较虚拟 DOM 树的前后快照来找出最小的变更集，并将这些变更应用到实际的 DOM 上。</p><h5 id="react-16-中的-fiber-架构" tabindex="-1"><a class="header-anchor" href="#react-16-中的-fiber-架构"><span>React 16 中的 Fiber 架构</span></a></h5><p>随着 React 16 的发布，原有的 diff 算法被 Fiber 架构所替代。Fiber 是一种新的数据结构，它提供了更好的性能和更灵活的工作机制。Fiber 节点不仅包含关于组件的信息，还包含关于如何处理这些节点的指令。</p><p><strong>工作流程概述</strong></p><ul><li><strong>Reconciliation</strong>：当组件的状态或属性发生变化时，React 会重新渲染组件及其子组件，并创建一个新的虚拟 DOM 树。接着，React 会将新树与旧树进行比较，这个过程就是 Reconciliation。</li><li><strong>Commit 阶段</strong>：在 Reconciliation 完成后，React 会执行 Commit 阶段，将差异应用到实际的 DOM 上。在这个阶段，React 会批量执行 DOM 更新，以减少重绘和回流。</li></ul><h4 id="虚拟dom的缺点" tabindex="-1"><a class="header-anchor" href="#虚拟dom的缺点"><span>虚拟DOM的缺点</span></a></h4><ol><li><strong>内存开销</strong>：虚拟DOM本身占用内存，对于大型应用可能会增加内存使用。</li><li><strong>初始化成本</strong>：创建虚拟DOM树需要计算资源，可能导致初次加载时性能下降。</li><li><strong>过度渲染</strong>：虽然React通过差异计算来最小化DOM操作，但如果组件频繁地重新渲染，即使只是局部更新，也可能导致性能问题。特别是在复杂的组件中，如果<code>render</code>方法中的逻辑较为复杂，那么频繁的重新渲染可能会降低应用性能。</li><li><strong>生命周期方法的滥用</strong>：不当使用生命周期方法可能导致不必要的重新渲染。</li><li><strong>状态管理不当</strong>：不合理的状态更新会导致不必要的性能损耗。</li><li><strong>性能瓶颈</strong>：在大量数据更新或复杂DOM操作时可能出现性能瓶颈。</li><li><strong>调试难度</strong>：虚拟DOM增加了调试的复杂性。</li></ol><h4 id="如何避免虚拟dom的缺点" tabindex="-1"><a class="header-anchor" href="#如何避免虚拟dom的缺点"><span>如何避免虚拟DOM的缺点</span></a></h4><ul><li><strong>优化状态更新</strong>：合理使用<code>setState</code>，避免不必要的状态更新。</li><li><strong>使用PureComponent或shouldComponentUpdate</strong>：确保只有在必要时才进行重新渲染。</li><li><strong>性能监控</strong>：使用React DevTools等工具来监控应用的性能，发现并解决性能瓶颈。</li><li><strong>懒加载和代码分割</strong>：通过懒加载和代码分割减少初始加载时间和内存使用。</li><li><strong>合理的组件划分</strong>：将组件划分得足够小，以便在需要时仅重新渲染受影响的部分。</li></ul><h3 id="_3、react-fiber架构" tabindex="-1"><a class="header-anchor" href="#_3、react-fiber架构"><span>3、React Fiber架构⭐</span></a></h3><p>React Fiber 是React16版本中引入的一种新的协调算法，它彻底改变了React的渲染机制，使其更加高效和灵活。解决了以前的更新机制的问题，即在长时间的更新过程中，主线程会被阻塞，导致应用无法及时响应用户输入的问题。</p><h4 id="传统reconciliation算法的缺点" tabindex="-1"><a class="header-anchor" href="#传统reconciliation算法的缺点"><span><strong>传统Reconciliation算法的缺点</strong></span></a></h4><ul><li><p>同步执行：传统的Reconciliation算法在每次更新时都会同步执行整个Virtual DOM树的比较，如果树很大，就会导致渲染卡顿，影响用户体验。</p></li><li><p>无法中断：一旦开始比较，就无法中途停止，这会导致长时间的操作阻塞主线程，影响其他任务的执行。</p></li></ul><h4 id="fiber-架构的优点" tabindex="-1"><a class="header-anchor" href="#fiber-架构的优点"><span><strong>Fiber 架构的优点</strong></span></a></h4><p>1、<strong>可中断性</strong>：</p><ul><li>在传统的 diff 算法中，整个过程是一次性的，并且必须在一次事件循环内完成。如果这个过程非常耗时，那么它可能会阻塞用户界面。Fiber 架构使得 React 能够在必要的时候中断工作，并在稍后的时间继续执行。这意味着即使在复杂的用户界面中，React 也能够保持流畅的用户体验。</li></ul><p>2、<strong>优先级调度</strong>：</p><ul><li>Fiber 引入了优先级的概念，可以根据任务的重要性来安排执行顺序。例如，用户交互（如点击按钮）通常具有较高的优先级，而后台任务（如加载数据）则可能具有较低的优先级。这有助于确保用户交互得到及时响应。</li></ul><p>3、<strong>并发渲染</strong>：</p><ul><li>虽然 React 目前还不支持真正的并发渲染到 DOM（即多个更新同时进行），但是 Fiber 的设计使得将来支持并发成为可能。这意味着在未来，React 可以在多个线程中同时处理不同的更新任务。</li></ul><p>4、<strong>错误边界</strong>：</p><ul><li>Fiber 架构还支持错误边界（Error Boundaries），这是一种特殊的 React 组件，可以在子组件抛出错误时捕获这些错误，并显示一个备用 UI，而不是使整个应用崩溃。这对于提高应用的稳定性和用户体验非常重要。</li></ul><h4 id="fiber-架构的核心概念" tabindex="-1"><a class="header-anchor" href="#fiber-架构的核心概念"><span><strong>Fiber 架构的核心概念</strong></span></a></h4><p>1、<strong>Fiber 结构</strong>：</p><ul><li>在 Fiber 架构中，每个 React 元素（即虚拟 DOM 节点）都有一个对应的 Fiber 节点。每个 Fiber 节点是一个对象，它包含了关于该元素的所有信息，比如类型、属性、状态以及其他重要的元数据。</li></ul><p>2、<strong>链表结构</strong>：</p><ul><li>与以前的单链表结构相比，Fiber 节点形成了一个双向链表结构，每个节点都有指向父节点和子节点的指针。这使得 React 可以更容易地在树中导航，并且可以方便地进行回溯和重试。</li></ul><p>3、<strong>工作单元</strong>：</p><ul><li>每个 Fiber 节点代表了一个工作单元（work unit），它可以独立于其他节点执行。这意味着 React 可以更容易地中断和恢复工作，从而提高性能。</li></ul><h4 id="fiber-架构的实现原理" tabindex="-1"><a class="header-anchor" href="#fiber-架构的实现原理"><span><strong>Fiber 架构的实现原理</strong></span></a></h4><ul><li><p>Fiber Node：React 使用Fiber Node来表示 Virtual DOM树中的每个节点，每个Fiber Node包含了节点类型、属性、子节点等信息，以及用来跟踪更新状态的指针。</p></li><li><p>Fiber Tree：React 使用Fiber Node构建了一个树状结构，称为Fiber Tree，每个 Fiber Node 对应Virtual DOM树中的一个节点。</p></li><li><p>Work in Progress Tree：在进行更新时，React会构建一个新的Fiber Tree,称为Work in ProgressTree，并将其与之前的Fiber Tree进行比较。</p></li><li><p>Commit Phase：当Work in ProgressTree 建立完成之后，React 会将WorkinProgress Tree 中的更新应用到真实的DOM树上，这个过程称为Commit Phase。</p></li></ul><h4 id="reconciliation-过程概述" tabindex="-1"><a class="header-anchor" href="#reconciliation-过程概述"><span>Reconciliation 过程概述</span></a></h4><p>在 React 的 Fiber 架构中，比较新旧虚拟 DOM 的过程被称为 Reconciliation。这个过程涉及到了一系列复杂的步骤，以便高效地确定需要在实际 DOM 中进行哪些更新。</p><ol><li><strong>初始化</strong>： <ul><li>当组件的状态或属性发生变化时，React 会调度一个更新。此时，React 会开始创建新的虚拟 DOM 树（我们称之为“新树”），并将其与旧的虚拟 DOM 树（“旧树”）进行比较。</li></ul></li><li><strong>创建 Fiber 树</strong>： <ul><li>React 会为每个虚拟 DOM 节点创建一个对应的 Fiber 节点。Fiber 节点包含了虚拟 DOM 节点的信息，还包括了额外的状态，如工作进度、优先级等。</li></ul></li><li><strong>递归比较</strong>： <ul><li>React 从根节点开始，递归地比较新旧虚拟 DOM 树。这个过程涉及到了多个步骤，包括但不限于： <ul><li><strong>比较元素类型</strong>：如果新旧元素的类型不同（例如，从 <code>&lt;div&gt;</code> 变为 <code>&lt;span&gt;</code>），那么旧的子树将被丢弃，新的子树将被创建。</li><li><strong>比较元素 key</strong>：如果元素有 key 属性，React 会使用 key 来识别元素，并尽可能地复用旧的元素。如果 key 不同，则认为是不同的元素。</li><li><strong>比较属性</strong>：如果元素类型相同且 key 相同，React 会比较元素的属性是否发生变化。如果有变化，React 会在实际 DOM 中更新这些属性。</li><li><strong>比较子元素</strong>：如果元素有子元素，React 会递归地对子元素进行相同的比较过程。</li></ul></li></ul></li><li><strong>标记更新</strong>： <ul><li>如果发现有需要更新的地方，React 会在对应的 Fiber 节点上标记需要执行的操作，如插入、删除或更新。</li></ul></li><li><strong>提交阶段</strong>： <ul><li>在 Reconciliation 完成后，React 会进入提交阶段（Commit phase），在这个阶段，React 会按照标记的操作来更新实际的 DOM。提交阶段也是分批次进行的，以减少浏览器的重绘和回流。</li></ul></li></ol><h3 id="_3、合成事件" tabindex="-1"><a class="header-anchor" href="#_3、合成事件"><span>3、合成事件</span></a></h3><p>React 的合成事件（Synthetic Events）是一种跨浏览器的封装事件，它为开发者提供了一套统一的事件处理接口，使得在不同浏览器中处理事件变得更为一致和可靠。React 使用合成事件来解决浏览器之间的事件处理差异，并提供了一些额外的功能，如事件池化，以提高性能。</p><p><strong>特点：</strong></p><ol><li><strong>跨浏览器兼容性</strong>：React的合成事件系统提供了一个统一的API，这样开发者就不需要担心不同浏览器之间存在的细微差别。</li><li><strong>事件委托</strong>：为了提高性能，React使用事件委托的方式，而不是为每个元素单独绑定事件监听器。这意味着所有的事件监听器都会绑定到最外层的容器节点上，当事件发生时，React会检查事件冒泡路径上的元素并调用相应的事件处理程序。</li><li><strong>统一的事件对象</strong>：React创建了自己的事件对象<code>SyntheticEvent</code>，这个对象拥有与原生DOM事件相似的方法（如<code>preventDefault()</code>和<code>stopPropagation()</code>），但是提供了一些额外的功能和一致性。</li><li><strong>事件池化</strong>：为了减少垃圾回收的压力，React对事件对象进行了池化管理。当事件触发后，事件对象会被复用而不是直接销毁，这可以减少内存消耗。</li></ol><p><strong>获取原生事件</strong>：</p><p>如果你需要访问原生DOM事件，可以通过<code>SyntheticEvent</code>的<code>nativeEvent</code>属性来获取：</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> handleClick</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#4FC1FF;"> nativeEvent</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">nativeEvent</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">  // 处理原生事件</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>React16</strong></p><ul><li>所有事件挂载到document上</li><li>event不是原生的，是SyntheticEvent合成事件对象</li><li>和Vue事件不同，和DOM事件也不同</li></ul><p><strong>React17</strong></p><ul><li>绑定到root组件上</li><li>有利于多个React版本并存，例如微前端</li></ul><h3 id="_4、setstate之后发生了哪些事情" tabindex="-1"><a class="header-anchor" href="#_4、setstate之后发生了哪些事情"><span>4、setState之后发生了哪些事情</span></a></h3><ol><li><strong>状态更新</strong>：<code>setState</code>接收新的状态值，并合并到当前状态中。</li><li><strong>调度更新</strong>：React将状态更新加入队列，并可能与其他更新一起批量处理。</li><li><strong>计算差异</strong>：React根据新状态重新计算虚拟DOM，并找出需要更新的部分。</li><li><strong>实际DOM更新</strong>：React仅更新实际DOM中的必要部分。</li><li><strong>生命周期方法调用</strong>：在更新的不同阶段，React会调用相关的生命周期方法。</li><li><strong>完成更新</strong>：DOM更新完成后，本次更新过程结束。</li></ol><h3 id="_5、batchupdate-批处理" tabindex="-1"><a class="header-anchor" href="#_5、batchupdate-批处理"><span>5、batchUpdate（批处理）</span></a></h3><p>在 React 中，当组件的状态或属性发生变化时，通常会触发重新渲染。如果短时间内多次调用 <code>setState</code> 或者有多个更新被调度，React 会将这些更新合并在一起，一次性地更新 DOM。这种策略有助于减少浏览器的重绘（repainting）和回流（reflow），从而提高性能。</p><p><strong>BatchUpdate 的应用场景</strong></p><ul><li><strong>连续多次调用<code>setState</code></strong>：如果你在一个很短的时间内连续调用了多次<code>setState</code>，React会将这些状态更新合并为一个批次来处理。</li><li><strong>事件处理</strong>：在某些情况下，比如处理用户输入或多个事件时，React也会进行批量更新以减少DOM操作次数。</li><li><strong>定时任务</strong>：在使用<code>setTimeout</code>或<code>requestAnimationFrame</code>等异步任务时，React也会等待这些任务完成后再进行批量更新。</li></ul><p><strong>React 中的 BatchUpdate 实现</strong></p><p>在 React 16 引入 Fiber 架构之后，批处理变得更加高效和灵活。以下是一些关键点：</p><ol><li><strong>调度更新</strong>：当状态或属性发生变化时，React 会调度一个更新。这些更新被放入一个队列中等待处理。</li><li><strong>工作循环</strong>：React 的工作循环会检查是否有待处理的更新。如果有，它会开始 Reconciliation 过程，生成新的虚拟 DOM 树，并与旧的虚拟 DOM 树进行比较。</li><li><strong>提交更新</strong>：在 Reconciliation 完成后，React 会进入提交阶段（Commit phase），在这个阶段，React 会批量执行 DOM 更新。这意味着即使有多个更新，React 也会尽量一次性地将所有的变更应用到实际的 DOM 中。</li></ol><p><strong>如何手动触发 BatchUpdate</strong></p><p>在某些情况下，你可能希望手动控制批处理的时机。React 提供了一些方法来帮助开发者实现这一点：</p><ol><li><p><strong>使用 <code>React.unstable_batchedUpdates</code></strong>：</p><ul><li>在某些特定情况下，你可以使用 <code>React.unstable_batchedUpdates</code> 函数来手动触发批处理。这个函数允许你传递一个回调函数，在这个回调函数内的所有更新都将被批处理。</li></ul><div class="language-jsx line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="jsx" data-title="jsx"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-jsx;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;react&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> performBatchedUpdates</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  React</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">unstable_batchedUpdates</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 在这个回调函数内的所有更新将被批处理</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 例如调用多个 setState</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    component1</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">({ </span><span style="color:#9CDCFE;">count:</span><span style="color:#B5CEA8;"> 1</span><span style="color:#D4D4D4;"> });</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    component2</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">({ </span><span style="color:#9CDCFE;">text:</span><span style="color:#CE9178;"> &#39;Hello&#39;</span><span style="color:#D4D4D4;"> });</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  });</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>请注意，<code>React.unstable_batchedUpdates</code> 是一个实验性的 API，不推荐在生产环境中使用。在大多数情况下，React 会自动处理批处理，你不需要手动干预。</p><h3 id="_6、组件渲染过程" tabindex="-1"><a class="header-anchor" href="#_6、组件渲染过程"><span>6、组件渲染过程</span></a></h3><ol><li><p><strong>状态更新</strong>：当组件的状态（state）或属性（props）发生变化时，React 会触发组件的重新渲染。这通常是通过调用 <code>setState</code> 方法或通过外部传递新的 <code>props</code> 来实现的。</p></li><li><p><strong>构建新的虚拟DOM</strong>：React 会根据当前组件的最新状态和属性重新执行 <code>render</code> 方法，生成一个新的虚拟DOM树。这个新的虚拟DOM树包含了组件及其子组件的所有React元素。</p></li><li><p><strong>差异计算（Reconciliation）</strong>：React 使用一种称为 Reconciliation 的算法来比较新旧虚拟DOM树之间的差异。这一过程通常被称为“diff算法”，它会找出需要更新的最小变化集。</p></li><li><p><strong>DOM更新</strong>：根据差异计算的结果，React 只会对实际DOM中真正需要更新的部分进行变更。这一步骤中，React 尽可能地最小化DOM操作，以提高性能。</p></li><li><p><strong>生命周期方法调用</strong>：在不同的阶段，React 会调用组件的生命周期方法。对于类组件，这包括但不限于：</p><ul><li><code>shouldComponentUpdate</code>：在组件接收到新的props或state之前调用，允许我们控制组件是否需要更新。</li><li><code>render</code>：每次组件需要重新渲染时都会被调用。</li><li><code>getDerivedStateFromProps</code>（如果定义了的话）：在每次更新前调用，用于计算新的state。</li><li><code>componentDidUpdate</code>：在组件更新后立即调用。</li></ul><p>对于函数组件，React Hooks 提供了类似的机制：</p><ul><li><code>useEffect</code>：可以在组件挂载、卸载或更新时执行副作用操作。</li><li><code>useMemo</code> 和 <code>useCallback</code>：用于优化性能，避免每次渲染都重新创建函数或对象。</li></ul></li><li><p><strong>完成更新</strong>：一旦DOM更新完成，并且所有相关的生命周期方法都被正确执行，这次组件更新就完成了。</p></li></ol><h2 id="三、react-hooks" tabindex="-1"><a class="header-anchor" href="#三、react-hooks"><span>三、React Hooks</span></a></h2><h3 id="为什么会有react-hooks-它解决了哪些问题" tabindex="-1"><a class="header-anchor" href="#为什么会有react-hooks-它解决了哪些问题"><span>为什么会有React Hooks，它解决了哪些问题</span></a></h3><ul><li>完善函数组件的能力，函数组件更适合React组件</li><li>组件逻辑复用，Hooks表现更好，使用Hooks，相同逻辑可分割到一个一个的useEffect中，而不是像class组件一样，分布在各个生命周期中</li><li>class复杂组件正在变得费解，不易拆解，不易测试，逻辑混乱</li></ul><p><strong>class组件的问题</strong></p><ul><li>大型组件很难拆分和重构，很难测试（即class不易拆分）</li><li>相同业务逻辑，分散到各个方法中，逻辑混乱</li><li>复用逻辑变得复杂，如Mixins，HOC，Render Props</li></ul><p>所以函数组件更适合React组件，但需要Hooks增强功能</p><h3 id="state-hook" tabindex="-1"><a class="header-anchor" href="#state-hook"><span>State Hook</span></a></h3><h4 id="作用-让函数组件实现-state-和-setstate" tabindex="-1"><a class="header-anchor" href="#作用-让函数组件实现-state-和-setstate"><span>作用：让函数组件实现 state 和 setState</span></a></h4><ul><li>默认函数组件没有state</li><li>函数组件是一个纯函数，执行完即销毁，无法存储state</li><li>需要State Hook，即把state功能“钩”到纯函数中</li></ul><h4 id="usestate使用总结" tabindex="-1"><a class="header-anchor" href="#usestate使用总结"><span>useState使用总结</span></a></h4><ul><li><code>useState(0)</code>传入初始值，返回数组[state, setState]</li><li>通过state获取值</li><li>通过<code>setState(1)</code>修改值</li></ul><h4 id="hooks命名规范" tabindex="-1"><a class="header-anchor" href="#hooks命名规范"><span>Hooks命名规范</span></a></h4><ul><li>规定所有的Hooks都用use开头，如useXxx</li><li>自定义Hook也要以use开头</li><li>非Hooks的地方，尽量不要使用useXxx写法</li></ul><h4 id="代码演示" tabindex="-1"><a class="header-anchor" href="#代码演示"><span>代码演示</span></a></h4><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">useState</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> ClickCounter</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 数组的解构</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // useState 就是一个 Hook “钩”，最基本的一个 Hook</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">count</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setCount</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">// 传入一个初始值</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    function</span><span style="color:#DCDCAA;"> clickHandler</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        setCount</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> + </span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">你点击了 </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">count</span><span style="color:#569CD6;">}</span><span style="color:#D4D4D4;"> 次</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">button</span><span style="color:#9CDCFE;"> onClick</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">clickHandler</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">点击</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> ClickCounter</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="effect-hook" tabindex="-1"><a class="header-anchor" href="#effect-hook"><span>Effect Hook</span></a></h3><h4 id="作用-让组件模拟生命周期" tabindex="-1"><a class="header-anchor" href="#作用-让组件模拟生命周期"><span>作用：让组件模拟生命周期</span></a></h4><ul><li>默认函数组件没有生命周期</li><li>函数组件是一个纯函数，执行完即销毁，自己无法实现生命周期</li><li>使用Effect Hook 把生命周期“钩”到纯函数中</li></ul><h4 id="useeffect使用总结" tabindex="-1"><a class="header-anchor" href="#useeffect使用总结"><span>useEffect使用总结</span></a></h4><ul><li><p>模拟 componentDidMount - useEffect 依赖 []</p></li><li><p>模拟 componentDidUpdate - useEffect 无依赖， 或者依赖 [a, b]</p></li><li><p>模拟 componentWillUnMount - useEffect 中返回一个函数fn</p><ul><li>useEffect依赖[]，组件销毁时执行fn，等于WillUnMounted</li><li>useEffect无依赖或依赖[a, b]，组件更新时执行fn</li><li>即，下一次执行useEffect之前，就会执行fn，无论更新或卸载</li></ul></li></ul><h4 id="代码演示-1" tabindex="-1"><a class="header-anchor" href="#代码演示-1"><span>代码演示</span></a></h4><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">useState</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">useEffect</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> LifeCycles</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">count</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setCount</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 模拟 class 组件的 DidMount 和 DidUpdate</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    useEffect</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;在此发送一个 ajax 请求&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    })</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 模拟 class 组件的 DidMount</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    useEffect</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;加载完了&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }, []) </span><span style="color:#6A9955;">// 第二个参数是 [] （不依赖于任何 state）</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 模拟 class 组件的 DidUpdate</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    useEffect</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;更新了&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }, [</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;">]) </span><span style="color:#6A9955;">// 第二个参数就是依赖的 state</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 模拟 class 组件的 DidMount</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    useEffect</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        let</span><span style="color:#9CDCFE;"> timerId</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">window</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setInterval</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">Date</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">now</span><span style="color:#D4D4D4;">())</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }, </span><span style="color:#B5CEA8;">1000</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 返回一个函数</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 模拟 WillUnMount</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#D4D4D4;"> () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            window</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">clearInterval</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">timerId</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }, [])</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    function</span><span style="color:#DCDCAA;"> clickHandler</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        setCount</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> + </span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">你点击了 </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">count</span><span style="color:#569CD6;">}</span><span style="color:#D4D4D4;"> 次</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">button</span><span style="color:#9CDCFE;"> onClick</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">clickHandler</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">点击</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> LifeCycles</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="模拟willunmount-但不完全相等" tabindex="-1"><a class="header-anchor" href="#模拟willunmount-但不完全相等"><span>模拟WillUnMount，但不完全相等</span></a></h4><ul><li>useEffect依赖[]，组件销毁时执行fn，等于WillUnMounted</li><li>useEffect无依赖或依赖[a, b]，组件更新时执行fn</li><li>即，下一次执行useEffect之前，就会执行fn，无论更新或卸载</li></ul><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">useState</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">useEffect</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> FriendStatus</span><span style="color:#D4D4D4;">({ </span><span style="color:#9CDCFE;">friendId</span><span style="color:#D4D4D4;"> }) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">status</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setStatus</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">false</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // DidMount 和 DidUpdate</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    useEffect</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">`开始监听 </span><span style="color:#569CD6;">${</span><span style="color:#9CDCFE;">friendId</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;"> 在线状态`</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 【特别注意】</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 此处并不完全等同于 WillUnMount</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // props 发生变化，即更新，也会执行结束监听</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 准确的说：返回的函数，会在下一次 effect 执行之前，被执行</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#D4D4D4;"> () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">`结束监听 </span><span style="color:#569CD6;">${</span><span style="color:#9CDCFE;">friendId</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;"> 在线状态`</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    })</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        好友 </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">friendId</span><span style="color:#569CD6;">}</span><span style="color:#D4D4D4;"> 在线状态：</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">status</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">toString</span><span style="color:#D4D4D4;">()</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> FriendStatus</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="其他-hook" tabindex="-1"><a class="header-anchor" href="#其他-hook"><span>其他 Hook</span></a></h3><h4 id="useref" tabindex="-1"><a class="header-anchor" href="#useref"><span>useRef</span></a></h4><p>它允许你在渲染之间持久地引用值</p><p>useRef通常用于两种主要情况：访问 DOM 节点和保留渲染之间的值。</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">useRef</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">useEffect</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> UseRef</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> btnRef</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useRef</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">null</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">// 初始值</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // const numRef = useRef(0)</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // numRef.current</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    useEffect</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">btnRef</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">current</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">// DOM 节点</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }, [])</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">button</span><span style="color:#9CDCFE;"> ref</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">btnRef</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">click</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> UseRef</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="usecontext" tabindex="-1"><a class="header-anchor" href="#usecontext"><span>useContext</span></a></h4><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">useContext</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 主题颜色</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> themes</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    light:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        foreground:</span><span style="color:#CE9178;"> &#39;#000&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        background:</span><span style="color:#CE9178;"> &#39;#eee&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    dark:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        foreground:</span><span style="color:#CE9178;"> &#39;#fff&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        background:</span><span style="color:#CE9178;"> &#39;#222&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 创建 Context</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> ThemeContext</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">React</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">createContext</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">themes</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">light</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">// 初始值</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> ThemeButton</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> theme</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useContext</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">ThemeContext</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">button</span><span style="color:#9CDCFE;"> style</span><span style="color:#F44747;">={{ background: theme.background, color: theme.foreground }}&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        hello</span><span style="color:#9CDCFE;"> world</span></span></span>
<span class="line"><span class="line"><span style="color:#F44747;">    &lt;/button&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#F44747;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">function</span><span style="color:#F44747;"> Toolbar()</span><span style="color:#569CD6;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#4EC9B0;">ThemeButton</span><span style="color:#808080;">&gt;&lt;/</span><span style="color:#4EC9B0;">ThemeButton</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">function</span><span style="color:#F44747;"> App()</span><span style="color:#569CD6;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#4EC9B0;">ThemeContext.Provider</span><span style="color:#9CDCFE;"> value</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">themes</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">dark</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#4EC9B0;">Toolbar</span><span style="color:#808080;">&gt;&lt;/</span><span style="color:#4EC9B0;">Toolbar</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#4EC9B0;">ThemeContext.Provider</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">export</span><span style="color:#9CDCFE;"> default</span><span style="color:#9CDCFE;"> App</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="usereducer" tabindex="-1"><a class="header-anchor" href="#usereducer"><span>useReducer</span></a></h4><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">useReducer</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> initialState</span><span style="color:#D4D4D4;"> = { </span><span style="color:#9CDCFE;">count:</span><span style="color:#B5CEA8;"> 0</span><span style="color:#D4D4D4;"> }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#DCDCAA;"> reducer</span><span style="color:#D4D4D4;"> = (</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">action</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    switch</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">action</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">type</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        case</span><span style="color:#CE9178;"> &#39;increment&#39;</span><span style="color:#D4D4D4;">:</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">            return</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">count:</span><span style="color:#9CDCFE;"> state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> + </span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;"> }</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        case</span><span style="color:#CE9178;"> &#39;decrement&#39;</span><span style="color:#D4D4D4;">:</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">            return</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">count:</span><span style="color:#9CDCFE;"> state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> - </span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;"> }</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        default</span><span style="color:#D4D4D4;">:</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">            return</span><span style="color:#9CDCFE;"> state</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> App</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 很像 const [count, setCount] = useState(0)</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">state</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">dispatch</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useReducer</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">reducer</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">initialState</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        count: </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">button</span><span style="color:#9CDCFE;"> onClick</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#D4D4D4;">() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#DCDCAA;"> dispatch</span><span style="color:#D4D4D4;">({ </span><span style="color:#9CDCFE;">type:</span><span style="color:#CE9178;"> &#39;increment&#39;</span><span style="color:#D4D4D4;"> })</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">increment</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">button</span><span style="color:#9CDCFE;"> onClick</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#D4D4D4;">() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#DCDCAA;"> dispatch</span><span style="color:#D4D4D4;">({ </span><span style="color:#9CDCFE;">type:</span><span style="color:#CE9178;"> &#39;decrement&#39;</span><span style="color:#D4D4D4;"> })</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">decrement</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> App</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="usereducer-和-redux-的区别" tabindex="-1"><a class="header-anchor" href="#usereducer-和-redux-的区别"><span>useReducer 和 redux 的区别</span></a></h5><ul><li>useReducer是useState的代替方案，用于state复杂变化</li><li>useReducer是单个组件状态管理，组件通讯还需要props</li><li>redux是全局的状态管理，多组件共享数据</li></ul><h4 id="usememo" tabindex="-1"><a class="header-anchor" href="#usememo"><span>useMemo</span></a></h4><h5 id="usememo使用总结" tabindex="-1"><a class="header-anchor" href="#usememo使用总结"><span>useMemo使用总结</span></a></h5><ul><li>React默认会更新所有子组件</li><li>class组件使用SCU和PureComponent做优化</li><li>Hooks中使用useMemo，但优化的原理是相同的</li><li>memo封装子组件，useMemo封装数据</li></ul><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">useState</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">memo</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">useMemo</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 子组件</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 类似 class PureComponent ，对 props 进行浅层比较</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> Child</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">memo</span><span style="color:#D4D4D4;">(({ </span><span style="color:#9CDCFE;">userInfo</span><span style="color:#D4D4D4;"> }) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;Child render...&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">userInfo</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">This is Child </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">userInfo</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">name</span><span style="color:#569CD6;">}</span><span style="color:#569CD6;"> {</span><span style="color:#9CDCFE;">userInfo</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">age</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">})</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 父组件</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> App</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;Parent render...&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">count</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setCount</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">name</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setName</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;双越老师&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // const userInfo = { name, age: 20 }</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 用 useMemo 缓存数据，有依赖</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> userInfo</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useMemo</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">name</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">age:</span><span style="color:#B5CEA8;"> 21</span><span style="color:#D4D4D4;"> }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }, [</span><span style="color:#9CDCFE;">name</span><span style="color:#D4D4D4;">])</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            count is </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">count</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#569CD6;">button</span><span style="color:#9CDCFE;"> onClick</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#D4D4D4;">() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#DCDCAA;"> setCount</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> + </span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">)</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">click</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#4EC9B0;">Child</span><span style="color:#9CDCFE;"> userInfo</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">userInfo</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;&lt;/</span><span style="color:#4EC9B0;">Child</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> App</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="usecallback" tabindex="-1"><a class="header-anchor" href="#usecallback"><span>useCallback</span></a></h4><p><strong>useMemo缓存数据，useCallback缓存函数</strong></p><ul><li><p>都用于缓存数据，优化性能</p></li><li><p>两者接收的参数都是一样的，第一个参数表示一个回调函数，第二个表示依赖的数据</p></li><li><p>在依赖数据发生变化的时候，才会调用传进去的回调函数去重新计算结果，起到一个缓存的作用</p></li></ul><p>区别：</p><ul><li><p>useMemo 缓存的结果是回调函数中return回来的值，主要用于缓存计算结果的值，应用场景如需要计算的状态</p></li><li><p>useCallback 缓存的结果是函数，主要用于缓存函数，应用场景如需要缓存的函数，因为函数式组件每次任何一个state发生变化，会触发整个组件更新，一些函数是没有必要更新的，此时就应该缓存起来，提高性能，减少对资源的浪费</p><p>另外还需要注意的是，useCallback应该和React.memo配套使用，缺了一个都可能导致性能不升反而下降。</p></li></ul><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">useState</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">memo</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">useMemo</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">useCallback</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 子组件，memo 相当于 PureComponent</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> Child</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">memo</span><span style="color:#D4D4D4;">(({ </span><span style="color:#9CDCFE;">userInfo</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">onChange</span><span style="color:#D4D4D4;"> }) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;Child render...&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">userInfo</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">This is Child </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">userInfo</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">name</span><span style="color:#569CD6;">}</span><span style="color:#569CD6;"> {</span><span style="color:#9CDCFE;">userInfo</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">age</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">input</span><span style="color:#9CDCFE;"> onChange</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">onChange</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;&lt;/</span><span style="color:#569CD6;">input</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">})</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 父组件</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> App</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;Parent render...&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">count</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setCount</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">name</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setName</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;双越老师&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 用 useMemo 缓存数据</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> userInfo</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useMemo</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">name</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">age:</span><span style="color:#B5CEA8;"> 21</span><span style="color:#D4D4D4;"> }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }, [</span><span style="color:#9CDCFE;">name</span><span style="color:#D4D4D4;">])</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // function onChange(e) {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    //     console.log(e.target.value)</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // }</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 用 useCallback 缓存函数</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> onChange</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useCallback</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">e</span><span style="color:#569CD6;"> =&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }, [])</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            count is </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">count</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#569CD6;">button</span><span style="color:#9CDCFE;"> onClick</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#D4D4D4;">() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#DCDCAA;"> setCount</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> + </span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">)</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">click</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#4EC9B0;">Child</span><span style="color:#9CDCFE;"> userInfo</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">userInfo</span><span style="color:#569CD6;">}</span><span style="color:#9CDCFE;"> onChange</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">onChange</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;&lt;/</span><span style="color:#4EC9B0;">Child</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> App</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="uselayouteffect" tabindex="-1"><a class="header-anchor" href="#uselayouteffect"><span>useLayoutEffect</span></a></h4><p>用法与useEffect相似</p><p>区别</p><ul><li><code>useEffect</code> 是异步执行的，而<code>useLayoutEffect</code>是同步执行的。</li><li><code>useEffect</code> 的执行时机是浏览器完成渲染之后，而 <code>useLayoutEffect</code> 的执行时机是浏览器把内容真正渲染到界面之前，和 <code>componentDidMount</code> 等价。</li></ul><p>总结</p><ol><li>优先使用 <code>useEffect</code>，因为它是异步执行的，不会阻塞渲染</li><li>会影响到渲染的操作尽量放到 <code>useLayoutEffect</code>中去，避免出现闪烁问题</li><li><code>useLayoutEffect</code>和<code>componentDidMount</code>是等价的，会同步调用，阻塞渲染</li><li>在服务端渲染的时候使用会有一个 warning，因为它可能导致首屏实际内容和服务端渲染出来的内容不一致。</li></ol><h4 id="useupdateeffect" tabindex="-1"><a class="header-anchor" href="#useupdateeffect"><span>useUpdateEffect</span></a></h4><p>ahooks里的</p><p><code>useUpdateEffect</code> 用法等同于 <code>useEffect</code>，但是会<strong>忽略首次执行</strong>，只在依赖更新时执行。</p><h4 id="usememoizedfn" tabindex="-1"><a class="header-anchor" href="#usememoizedfn"><span>useMemoizedFn</span></a></h4><p>ahooks里的</p><p>我在实现多页签方案时有实际使用</p><ul><li><p>一般情况下，可以使用 useMemoizedFn 完全代替 useCallback</p></li><li><p>在某些场景中，我们需要使用 useCallback 来记住一个函数，但是在第二个参数 deps 变化时，会重新生成函数，导致函数地址变化。</p></li><li><p>使用 useMemoizedFn，可以省略第二个参数 deps，同时保证函数地址永远不会变化。</p></li></ul><h3 id="自定义-hook" tabindex="-1"><a class="header-anchor" href="#自定义-hook"><span>自定义 Hook</span></a></h3><h4 id="自定义useaxios" tabindex="-1"><a class="header-anchor" href="#自定义useaxios"><span>自定义useAxios</span></a></h4><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">useState</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">useEffect</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> axios</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;axios&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 封装 axios 发送网络请求的自定义 Hook</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> useAxios</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">url</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">loading</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setLoading</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">false</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">data</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setData</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">()</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">error</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setError</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">()</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    useEffect</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 利用 axios 发送网络请求</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        setLoading</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">true</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        axios</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">get</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">url</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">// 发送一个 get 请求</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            .</span><span style="color:#DCDCAA;">then</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">res</span><span style="color:#569CD6;"> =&gt;</span><span style="color:#DCDCAA;"> setData</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">res</span><span style="color:#D4D4D4;">))</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            .</span><span style="color:#DCDCAA;">catch</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">err</span><span style="color:#569CD6;"> =&gt;</span><span style="color:#DCDCAA;"> setError</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">err</span><span style="color:#D4D4D4;">))</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            .</span><span style="color:#DCDCAA;">finally</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#DCDCAA;"> setLoading</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">false</span><span style="color:#D4D4D4;">))</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }, [</span><span style="color:#9CDCFE;">url</span><span style="color:#D4D4D4;">])</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">loading</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">data</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">error</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> useAxios</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 第三方 Hook</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// https://nikgraf.github.io/react-hooks/</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// https://github.com/umijs/hooks</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> useAxios</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;../customHooks/useAxios&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> App</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> url</span><span style="color:#D4D4D4;"> = </span><span style="color:#CE9178;">&#39;http://localhost:3000/&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 数组解构</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">loading</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">data</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">error</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useAxios</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">url</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">loading</span><span style="color:#D4D4D4;">) </span><span style="color:#C586C0;">return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">loading...</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#9CDCFE;"> error</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        ? </span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span><span style="color:#569CD6;">{</span><span style="color:#4FC1FF;">JSON</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">stringify</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">error</span><span style="color:#D4D4D4;">)</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        : </span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span><span style="color:#569CD6;">{</span><span style="color:#4FC1FF;">JSON</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">stringify</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">data</span><span style="color:#D4D4D4;">)</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> App</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="自定义usemouseposition" tabindex="-1"><a class="header-anchor" href="#自定义usemouseposition"><span>自定义useMousePosition</span></a></h4><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">useState</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">useEffect</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> useMousePosition</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">x</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setX</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">y</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setY</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    useEffect</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        function</span><span style="color:#DCDCAA;"> mouseMoveHandler</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">            setX</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">clientX</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">            setY</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">clientY</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 绑定事件</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        document</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">body</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">addEventListener</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;mousemove&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">mouseMoveHandler</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 解绑事件</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#D4D4D4;"> () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#9CDCFE;"> document</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">body</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">removeEventListener</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;mousemove&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">mouseMoveHandler</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }, [])</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">x</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">y</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> useMousePosition</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> useMousePosition</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;../customHooks/useMousePosition&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> App</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">x</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">y</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useMousePosition</span><span style="color:#D4D4D4;">()</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#9CDCFE;"> style</span><span style="color:#F44747;">={{ height: &#39;500px&#39;, backgroundColor: &#39;#ccc&#39; }}&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#F44747;">        &lt;p&gt;鼠标位置</span><span style="color:#569CD6;"> {</span><span style="color:#9CDCFE;">x</span><span style="color:#569CD6;">}</span><span style="color:#569CD6;"> {</span><span style="color:#9CDCFE;">y</span><span style="color:#569CD6;">}</span><span style="color:#F44747;">&lt;/p&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#F44747;">    &lt;/div&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#F44747;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">export</span><span style="color:#9CDCFE;"> default</span><span style="color:#9CDCFE;"> App</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="倒计时useinterval" tabindex="-1"><a class="header-anchor" href="#倒计时useinterval"><span>倒计时useInterval</span></a></h4><p>ahooks中有这个功能</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">useEffect</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">useRef</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">/**</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;"> * </span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;"> * </span><span style="color:#569CD6;">@param</span><span style="color:#4EC9B0;"> {*}</span><span style="color:#9CDCFE;"> fn</span><span style="color:#6A9955;"> 回调函数</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;"> * </span><span style="color:#569CD6;">@param</span><span style="color:#4EC9B0;"> {*}</span><span style="color:#9CDCFE;"> delay</span><span style="color:#6A9955;"> 延迟时间</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;"> * </span><span style="color:#569CD6;">@param</span><span style="color:#4EC9B0;"> {*}</span><span style="color:#9CDCFE;"> options</span><span style="color:#6A9955;"> {immediate} 是否立即执行</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;"> */</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> useInterval</span><span style="color:#D4D4D4;">(</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    fn</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    delay</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    options</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> immediate</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">options</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">immediate</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> fnRef</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useRef</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    fnRef</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">current</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">fn</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    useEffect</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        if</span><span style="color:#D4D4D4;"> (</span><span style="color:#569CD6;">typeof</span><span style="color:#9CDCFE;"> delay</span><span style="color:#D4D4D4;"> !== </span><span style="color:#CE9178;">&#39;number&#39;</span><span style="color:#D4D4D4;"> || </span><span style="color:#9CDCFE;">delay</span><span style="color:#D4D4D4;"> &lt; </span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">) </span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">immediate</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            fnRef</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">current</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> timer</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">setInterval</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            fnRef</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">current</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }, </span><span style="color:#9CDCFE;">delay</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#D4D4D4;"> () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">            clearInterval</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">timer</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        };</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }, [</span><span style="color:#9CDCFE;">delay</span><span style="color:#D4D4D4;">]);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> useInterval</span><span style="color:#D4D4D4;">;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">interval</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setInterval</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">undefined</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">count</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setCount</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">5</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#DCDCAA;"> handleGo</span><span style="color:#D4D4D4;"> = () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">history</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">push</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;/&#39;</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">};</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">useInterval</span><span style="color:#D4D4D4;">(</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">      if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> &gt; </span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        setCount</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> - </span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      }</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">      if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> === </span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        setInterval</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">undefined</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        handleGo</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    interval</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      immediate:</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  );</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="hooks-使用规范" tabindex="-1"><a class="header-anchor" href="#hooks-使用规范"><span>Hooks 使用规范</span></a></h3><ul><li>只能用于React函数组件和自定义Hook中，其他地方不可以</li><li>只能用于顶层代码，不能在循环、判断中使用Hooks（Hooks严重依赖于调用顺序，如果Hooks出现在循环、判断里，则无法保证顺序一致）</li><li>useEffect内部不能修改state，直接在<code>useEffect</code>中修改状态可能会导致状态更新的顺序混乱，可能会引发无限循环的重新渲染。</li><li>eslint插件eslint-plugin-resct-hooks可以帮到你</li></ul><h3 id="规范和注意事项" tabindex="-1"><a class="header-anchor" href="#规范和注意事项"><span>规范和注意事项</span></a></h3><ul><li><p>useState初始化值，只有第一次有效</p><ul><li>render: 初始化 state</li><li>re-render: 只恢复初始化的 state 值，不会再重新设置新的值。只能用 setName 修改</li></ul></li><li><p>useEffect内部不能修改state</p><ul><li>依赖为 [] 时： re-render 不会重新执行 effect 函数</li><li>没有依赖：re-render 会重新执行 effect 函数</li></ul></li><li><p>useEffect可能出现死循环</p><ul><li>当依赖中有引用对象时，会出现死循环</li><li>使用useRef来解决</li></ul></li></ul><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">useState</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">useRef</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">useEffect</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> UseEffectChangeState</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">count</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setCount</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 模拟 DidMount</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> countRef</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useRef</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    useEffect</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;useEffect...&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 定时任务</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> timer</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">setInterval</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;setInterval...&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">countRef</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">current</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">            // setCount(count + 1)</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">            setCount</span><span style="color:#D4D4D4;">(++</span><span style="color:#9CDCFE;">countRef</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">current</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }, </span><span style="color:#B5CEA8;">1000</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 清除定时任务</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#D4D4D4;"> () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#DCDCAA;"> clearTimeout</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">timer</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }, []) </span><span style="color:#6A9955;">// 依赖为 []</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 依赖为 [] 时： re-render 不会重新执行 effect 函数</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 没有依赖：re-render 会重新执行 effect 函数</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">count: </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">count</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> UseEffectChangeState</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="react-hooks-性能优化" tabindex="-1"><a class="header-anchor" href="#react-hooks-性能优化"><span>React Hooks 性能优化</span></a></h3><ul><li><p>useMemo缓存数据，useCallback缓存函数</p></li><li><p>相当于class组件的SCU和PureComponent</p></li></ul><h3 id="hooks-相比-hoc-和-render-props-有哪些优点" tabindex="-1"><a class="header-anchor" href="#hooks-相比-hoc-和-render-props-有哪些优点"><span>Hooks 相比 HOC 和 Render Props 有哪些优点</span></a></h3><ul><li>完全符合Hooks原有规则，没有其他要求，易理解记忆</li><li>变量作用域明确</li><li>不会产生组件嵌套</li></ul></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="vp-meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 980715844@qq.com">csmSimona</span><!----><!--]--><!--]--></span></div></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-BmN7UyQ9.js" defer></script>
  </body>
</html>
