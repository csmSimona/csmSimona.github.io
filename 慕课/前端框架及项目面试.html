<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.15" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #22272e;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (userMode === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (userMode === 'dark' || systemDarkMode) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <title>前端框架及项目面试 | myDocs</title><meta name="description" content="我的学习笔记文档">
    <link rel="preload" href="/csmSimona.github.io/assets/style-CoTrOZ3q.css" as="style"><link rel="stylesheet" href="/csmSimona.github.io/assets/style-CoTrOZ3q.css">
    <link rel="modulepreload" href="/csmSimona.github.io/assets/app-C5r9pUv_.js"><link rel="modulepreload" href="/csmSimona.github.io/assets/前端框架及项目面试.html-C5ZY48q2.js"><link rel="modulepreload" href="/csmSimona.github.io/assets/vux过程-DmZDyE4E.js">
    <link rel="prefetch" href="/csmSimona.github.io/assets/index.html-CGTBXp-i.js" as="script"><link rel="prefetch" href="/csmSimona.github.io/assets/JavaScript的优缺点.html-EY1XsMdz.js" as="script"><link rel="prefetch" href="/csmSimona.github.io/assets/js异步及处理异步的几种方法.html-CRPb8Om8.js" as="script"><link rel="prefetch" href="/csmSimona.github.io/assets/正则表达式入门.html-Be-oqimT.js" as="script"><link rel="prefetch" href="/csmSimona.github.io/assets/nodejs.html-DKsDo5Sz.js" as="script"><link rel="prefetch" href="/csmSimona.github.io/assets/Python编程：从入门到实践.html-BzUuA_GF.js" as="script"><link rel="prefetch" href="/csmSimona.github.io/assets/Echarts基本使用.html-BXe4eHh1.js" as="script"><link rel="prefetch" href="/csmSimona.github.io/assets/Git小记.html-DOnDhuE-.js" as="script"><link rel="prefetch" href="/csmSimona.github.io/assets/Linux基本命令.html--pxPah7S.js" as="script"><link rel="prefetch" href="/csmSimona.github.io/assets/Three.js学习笔记.html-BT9iC7kr.js" as="script"><link rel="prefetch" href="/csmSimona.github.io/assets/webpack概念与配置.html-Q7q7lhlm.js" as="script"><link rel="prefetch" href="/csmSimona.github.io/assets/CSS小记.html-CP4aUAoQ.js" as="script"><link rel="prefetch" href="/csmSimona.github.io/assets/HTML小记.html-aBPmhMFk.js" as="script"><link rel="prefetch" href="/csmSimona.github.io/assets/JavaScript小记.html-DWhHLUeE.js" as="script"><link rel="prefetch" href="/csmSimona.github.io/assets/React小记.html-BNgxGq73.js" as="script"><link rel="prefetch" href="/csmSimona.github.io/assets/TypeScript小记.html-DP785PZo.js" as="script"><link rel="prefetch" href="/csmSimona.github.io/assets/Vue小记.html-DxeizF1_.js" as="script"><link rel="prefetch" href="/csmSimona.github.io/assets/前端性能优化.html-C7Uv-I3d.js" as="script"><link rel="prefetch" href="/csmSimona.github.io/assets/手写js.html-CX1d3f2Y.js" as="script"><link rel="prefetch" href="/csmSimona.github.io/assets/计算机网络.html-DUUfX56A.js" as="script"><link rel="prefetch" href="/csmSimona.github.io/assets/Vue.js源码全方位深入解析.html-DMiEVPcD.js" as="script"><link rel="prefetch" href="/csmSimona.github.io/assets/排序.html-91Poymuu.js" as="script"><link rel="prefetch" href="/csmSimona.github.io/assets/算法题.html-D-d1vTfc.js" as="script"><link rel="prefetch" href="/csmSimona.github.io/assets/《CSS揭秘》学习笔记.html-CQLGa1v8.js" as="script"><link rel="prefetch" href="/csmSimona.github.io/assets/404.html-m7PJ0pTb.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/csmSimona.github.io/"><!----><span class="vp-site-name" aria-hidden="true">myDocs</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/csmSimona.github.io/" aria-label="首页"><!---->首页<!----></a></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="前端基础汇总"><span class="title">前端基础汇总</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="前端基础汇总"><span class="title">前端基础汇总</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/JavaScript%E5%B0%8F%E8%AE%B0.html" aria-label="JavaScript小记"><!---->JavaScript小记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/HTML%E5%B0%8F%E8%AE%B0.html" aria-label="HTML小记"><!---->HTML小记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/CSS%E5%B0%8F%E8%AE%B0.html" aria-label="CSS小记"><!---->CSS小记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.html" aria-label="计算机网络"><!---->计算机网络<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/React%E5%B0%8F%E8%AE%B0.html" aria-label="React小记"><!---->React小记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/Vue%E5%B0%8F%E8%AE%B0.html" aria-label="Vue小记"><!---->Vue小记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/%E6%89%8B%E5%86%99js.html" aria-label="手写js"><!---->手写js<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html" aria-label="前端性能优化"><!---->前端性能优化<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/JavaScript/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%85%A5%E9%97%A8.html" aria-label="正则表达式入门"><!---->正则表达式入门<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/TypeScript%E5%B0%8F%E8%AE%B0.html" aria-label="TypeScript小记"><!---->TypeScript小记<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/csmSimona.github.io/%E6%85%95%E8%AF%BE/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E5%8F%8A%E9%A1%B9%E7%9B%AE%E9%9D%A2%E8%AF%95.html" aria-label="前端框架及项目面试"><!---->前端框架及项目面试<!----></a></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="算法"><span class="title">算法</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="算法"><span class="title">算法</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E7%AE%97%E6%B3%95/%E6%8E%92%E5%BA%8F.html" aria-label="排序"><!---->排序<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95%E9%A2%98.html" aria-label="算法题"><!---->算法题<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/csmSimona.github.io/node/nodejs.html" aria-label="nodejs"><!---->nodejs<!----></a></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="其他"><span class="title">其他</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="其他"><span class="title">其他</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E5%85%B6%E4%BB%96/Git%E5%B0%8F%E8%AE%B0.html" aria-label="Git小记"><!---->Git小记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E5%85%B6%E4%BB%96/webpack%E6%A6%82%E5%BF%B5%E4%B8%8E%E9%85%8D%E7%BD%AE.html" aria-label="webpack概念与配置"><!---->webpack概念与配置<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E5%85%B6%E4%BB%96/Linux%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4.html" aria-label="Linux基本命令"><!---->Linux基本命令<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E5%85%B6%E4%BB%96/Echarts%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8.html" aria-label="Echarts基本使用"><!---->Echarts基本使用<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E5%85%B6%E4%BB%96/Three.js%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html" aria-label="Three.js学习笔记"><!---->Three.js学习笔记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E5%85%B6%E4%BB%96/%E3%80%8ACSS%E6%8F%AD%E7%A7%98%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E3%80%8ACSS%E6%8F%AD%E7%A7%98%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html" aria-label="《CSS揭秘》学习笔记"><!---->《CSS揭秘》学习笔记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E6%85%95%E8%AF%BE/Vue.js%E6%BA%90%E7%A0%81%E5%85%A8%E6%96%B9%E4%BD%8D%E6%B7%B1%E5%85%A5%E8%A7%A3%E6%9E%90.html" aria-label="Vue.js源码全方位深入解析"><!---->Vue.js源码全方位深入解析<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="python"><span class="title">python</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="python"><span class="title">python</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/python/Python%E7%BC%96%E7%A8%8B%EF%BC%9A%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%AE%9E%E8%B7%B5.html" aria-label="python入门"><!---->python入门<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/csmSimona" aria-label="Github" rel="noopener noreferrer" target="_blank"><!---->Github<!----></a></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="Search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/csmSimona.github.io/" aria-label="首页"><!---->首页<!----></a></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="前端基础汇总"><span class="title">前端基础汇总</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="前端基础汇总"><span class="title">前端基础汇总</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/JavaScript%E5%B0%8F%E8%AE%B0.html" aria-label="JavaScript小记"><!---->JavaScript小记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/HTML%E5%B0%8F%E8%AE%B0.html" aria-label="HTML小记"><!---->HTML小记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/CSS%E5%B0%8F%E8%AE%B0.html" aria-label="CSS小记"><!---->CSS小记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.html" aria-label="计算机网络"><!---->计算机网络<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/React%E5%B0%8F%E8%AE%B0.html" aria-label="React小记"><!---->React小记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/Vue%E5%B0%8F%E8%AE%B0.html" aria-label="Vue小记"><!---->Vue小记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/%E6%89%8B%E5%86%99js.html" aria-label="手写js"><!---->手写js<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html" aria-label="前端性能优化"><!---->前端性能优化<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/JavaScript/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%85%A5%E9%97%A8.html" aria-label="正则表达式入门"><!---->正则表达式入门<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/TypeScript%E5%B0%8F%E8%AE%B0.html" aria-label="TypeScript小记"><!---->TypeScript小记<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/csmSimona.github.io/%E6%85%95%E8%AF%BE/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E5%8F%8A%E9%A1%B9%E7%9B%AE%E9%9D%A2%E8%AF%95.html" aria-label="前端框架及项目面试"><!---->前端框架及项目面试<!----></a></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="算法"><span class="title">算法</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="算法"><span class="title">算法</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E7%AE%97%E6%B3%95/%E6%8E%92%E5%BA%8F.html" aria-label="排序"><!---->排序<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95%E9%A2%98.html" aria-label="算法题"><!---->算法题<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/csmSimona.github.io/node/nodejs.html" aria-label="nodejs"><!---->nodejs<!----></a></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="其他"><span class="title">其他</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="其他"><span class="title">其他</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E5%85%B6%E4%BB%96/Git%E5%B0%8F%E8%AE%B0.html" aria-label="Git小记"><!---->Git小记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E5%85%B6%E4%BB%96/webpack%E6%A6%82%E5%BF%B5%E4%B8%8E%E9%85%8D%E7%BD%AE.html" aria-label="webpack概念与配置"><!---->webpack概念与配置<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E5%85%B6%E4%BB%96/Linux%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4.html" aria-label="Linux基本命令"><!---->Linux基本命令<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E5%85%B6%E4%BB%96/Echarts%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8.html" aria-label="Echarts基本使用"><!---->Echarts基本使用<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E5%85%B6%E4%BB%96/Three.js%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html" aria-label="Three.js学习笔记"><!---->Three.js学习笔记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E5%85%B6%E4%BB%96/%E3%80%8ACSS%E6%8F%AD%E7%A7%98%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E3%80%8ACSS%E6%8F%AD%E7%A7%98%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html" aria-label="《CSS揭秘》学习笔记"><!---->《CSS揭秘》学习笔记<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/%E6%85%95%E8%AF%BE/Vue.js%E6%BA%90%E7%A0%81%E5%85%A8%E6%96%B9%E4%BD%8D%E6%B7%B1%E5%85%A5%E8%A7%A3%E6%9E%90.html" aria-label="Vue.js源码全方位深入解析"><!---->Vue.js源码全方位深入解析<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="python"><span class="title">python</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="python"><span class="title">python</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/csmSimona.github.io/python/Python%E7%BC%96%E7%A8%8B%EF%BC%9A%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%AE%9E%E8%B7%B5.html" aria-label="python入门"><!---->python入门<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/csmSimona" aria-label="Github" rel="noopener noreferrer" target="_blank"><!---->Github<!----></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">前端框架及项目面试 <!----></p><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div class="theme-default-content" vp-content><!--[--><!--]--><div><h1 id="前端框架及项目面试" tabindex="-1"><a class="header-anchor" href="#前端框架及项目面试"><span>前端框架及项目面试</span></a></h1><h2 id="vue使用" tabindex="-1"><a class="header-anchor" href="#vue使用"><span>Vue使用</span></a></h2><h3 id="vue基本使用" tabindex="-1"><a class="header-anchor" href="#vue基本使用"><span>Vue基本使用</span></a></h3><ul><li><p>条件渲染</p><ul><li>v-if v-else 的用法，可使用变量，也可以使用 === 表达式</li><li>v-if 和 v-show 的区别？</li><li>v-if 和 v-show 的使用场景？数据改变频繁用 v-show</li></ul></li><li><p>列表渲染</p><ul><li><p>如何遍历对象？也可以用v-for</p></li><li><p>key的重要性，key不能乱写（如random或者index）</p></li><li><p>v-for 和 v-if 不能一起使用</p><p>v-for比v-if的优先级更高，这就说明在v-for的每次循环运行中每一次都会调用v-if的判断，所以不推荐v-if和v-for在同一个标签内同时使用。</p><p>解决方法：过滤一个列表中的项目 (比如 v-for=“user in users” v-if=“user.isActive”)。在这种情形下，请将 users替换为一个计算属性 (比如 activeUsers)，让其返回过滤后的列表</p></li></ul></li><li><p>事件</p><ul><li><p>event参数，自定义参数</p><p>1.event是原生的event对象，没有经过任何的装饰</p><p>2.事件被挂载到当前元素</p></li><li><p>事件修饰符</p><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#6A9955;">&lt;!-- 阻止单击事件继续传播 --&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">a</span><span style="color:#9CDCFE;"> v-on</span><span style="color:#D4D4D4;">:</span><span style="color:#9CDCFE;">click</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">stop</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">doThis</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#808080;">&gt;&lt;/</span><span style="color:#569CD6;">a</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">&lt;!-- 提交事件不再重载页面 --&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">form</span><span style="color:#9CDCFE;"> v-on</span><span style="color:#D4D4D4;">:</span><span style="color:#9CDCFE;">submit</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">prevent</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">onSubmit</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#808080;">&gt;&lt;/</span><span style="color:#569CD6;">form</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">&lt;!-- 修饰符可以串联 --&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">a</span><span style="color:#9CDCFE;"> v-on</span><span style="color:#D4D4D4;">:</span><span style="color:#9CDCFE;">click</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">stop</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">prevent</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">doThat</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#808080;">&gt;&lt;/</span><span style="color:#569CD6;">a</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">&lt;!-- 只有修饰符 --&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">form</span><span style="color:#9CDCFE;"> v-on</span><span style="color:#D4D4D4;">:</span><span style="color:#9CDCFE;">submit</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">prevent</span><span style="color:#808080;">&gt;&lt;/</span><span style="color:#569CD6;">form</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">&lt;!-- 添加事件监听器时使用事件捕获模式 --&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">&lt;!-- 事件捕获：事件从最不精确的对象(document对象)开始触发，然后到最精确 --&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">div</span><span style="color:#9CDCFE;"> v-on</span><span style="color:#D4D4D4;">:</span><span style="color:#9CDCFE;">click</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">capture</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">doThis</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">...</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">&lt;!-- 只当在 event.target 是当前元素自身时触发处理函数 --&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">&lt;!-- 即事件不是从内部元素触发的 --&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">div</span><span style="color:#9CDCFE;"> v-on</span><span style="color:#D4D4D4;">:</span><span style="color:#9CDCFE;">click</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">self</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">doThat</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">...</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>按键修饰符</p><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#6A9955;">&lt;!-- 即使 Alt 或 Shift 被一同按下时也会触发 --&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">button</span><span style="color:#D4D4D4;"> @</span><span style="color:#9CDCFE;">click</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">ctrl</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">onClick</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">A</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">&lt;!-- 有且只有 Ctrl 被按下的时候才触发 --&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">button</span><span style="color:#D4D4D4;"> @</span><span style="color:#9CDCFE;">click</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">ctrl</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">exact</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">onCtrlClick</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">A</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">&lt;!-- 没有任何系统修饰符被按下的时候才触发 --&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">button</span><span style="color:#D4D4D4;"> @</span><span style="color:#9CDCFE;">click</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">exact</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">onCtrlClick</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">A</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>【观察】事件 被绑定到哪里？</p></li></ul></li><li><p>表单</p><ul><li><p>v-model</p><p><code>&lt;textarea v-model=&quot;desc&quot;&gt;&lt;/textarea&gt;</code></p><p>注意：<code>&lt;textarea&gt;{{desc}}&lt;/textarea&gt;</code>是不允许的</p></li><li><p>常见的表单项 textarea checkbox radio select</p></li><li><p>修饰符 lazy number trim （v-model.lazy、v-model.number、v-model.trim）</p><ul><li>在输入框中，v-model 默认是同步数据，使用 <strong>.lazy</strong> 会转变为在 change 事件中同步 ， 也就是在<strong>失去焦点 或者 按下回车键时才更新</strong></li><li><strong>.number 修饰符可以将 输入的值转化为Number类型</strong> ，否则虽然你输入的是数字 但它的类型其实是String，在数字输入框中比较有用</li><li><strong>.trim</strong> 修饰符会自动过滤掉输入的<strong>首尾空格</strong></li></ul></li></ul></li></ul><h3 id="vue组件使用" tabindex="-1"><a class="header-anchor" href="#vue组件使用"><span>Vue组件使用</span></a></h3><ul><li><p>props 和 $emit（父子组件之间的通讯）</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C8C8C8;">props</span><span style="color:#D4D4D4;">: {</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    list</span><span style="color:#D4D4D4;">: {</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        type</span><span style="color:#D4D4D4;">: </span><span style="color:#9CDCFE;">Array</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        default</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">            return</span><span style="color:#D4D4D4;"> []</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">$emit</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">事件方法</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">值</span><span style="color:#D4D4D4;">)</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>组件间通讯 - 自定义事件（组件之间没有关系或者层级比较深）</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> event</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;./event.js&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">$emit</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">事件方法</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">值</span><span style="color:#D4D4D4;">)</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 及时解绑自定义事件</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">beforeDestory</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 及时销毁，否则可能造成内存泄漏</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    event</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">$off</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;onAddTitle&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">addTitleHandler</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>event.js</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> Vue</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;vue&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#569CD6;"> new</span><span style="color:#DCDCAA;"> Vue</span><span style="color:#D4D4D4;">()</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>组件生命周期</p><ul><li><p>单个组件</p><p>created 页面还没开始渲染，但Vue实例已经初始化完成</p><p>mounted 页面渲染完成 基本情况在mounted中进行操作，如ajax获取信息，绑定事件等</p><p>beforeDestroy 解除绑定，销毁子组件以及事件监听器，如自定义事件，setTimeout，window、document事件</p></li><li><p>父子组件</p><p>父组件先开始初始化，再子组件初始化，子组件渲染完成后，父组件才渲染完成</p><p>index created</p><p>list created</p><p>list mounted</p><p>index mounted</p><p>父组件先开始进入更新状态，再子组件，子组件更新完成后，父组件才更新完成</p><p>index beforeUpdate</p><p>list beforeUpdate</p><p>list updated</p><p>index updated</p><p>销毁destroy同理</p></li></ul></li></ul><h3 id="vue高级特性" tabindex="-1"><a class="header-anchor" href="#vue高级特性"><span>Vue高级特性</span></a></h3><ul><li><p>自定义组件的 v-model（如颜色选择）</p><p>index.vue</p><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">{{name}}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#569CD6;">CustomVModel</span><span style="color:#9CDCFE;"> v-model</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">name</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#808080;"> /&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">templete</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">script</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> CustomVModel</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;./CustomVModel&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">export</span><span style="color:#C586C0;"> default</span><span style="color:#D4D4D4;">{</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">	components</span><span style="color:#D4D4D4;">: {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    	CustomVModel</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">	},</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    data</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            name:</span><span style="color:#CE9178;"> &#39;csm&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">script</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>CustomVModel.Vue</p><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    &lt;!--	</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        注意：</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        1.input使用:value而不是v-model</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        2.change和model.event要对应起来</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        3.content属性对应起来（model里面定义的prop对应props里面的属性）</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    --&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#569CD6;">input</span><span style="color:#9CDCFE;"> type</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;text&quot;</span><span style="color:#D4D4D4;"> :</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">content</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#D4D4D4;"> @</span><span style="color:#9CDCFE;">input</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#DCDCAA;">$emit</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;change&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">$event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">)</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">templete</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">script</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">export</span><span style="color:#C586C0;"> default</span><span style="color:#D4D4D4;">{</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">	model</span><span style="color:#D4D4D4;">: {</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    	prop</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;content&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        event</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;change&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">	},</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    props</span><span style="color:#D4D4D4;">:{</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        content</span><span style="color:#D4D4D4;">: </span><span style="color:#9CDCFE;">String</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        default</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">            return</span><span style="color:#CE9178;"> &#39;&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">script</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>$nextTick，ref</p><ul><li>Vue是异步渲染</li><li>data改变之后，DOM不会立刻渲染</li><li>$nextTick会在DOM渲染之后被触发，以获取最新DOM节点</li></ul><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">	&lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">ul</span><span style="color:#9CDCFE;"> ref</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;ul1&quot;</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#569CD6;">li</span><span style="color:#C586C0;"> v-for</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">in</span><span style="color:#9CDCFE;"> list</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#D4D4D4;"> :</span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">{{item}}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">li</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#569CD6;">ul</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">button</span><span style="color:#D4D4D4;"> @</span><span style="color:#9CDCFE;">click</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">addItem</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            添加一项</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">script</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    data</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            list:</span><span style="color:#D4D4D4;"> [</span><span style="color:#CE9178;">&#39;a&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;b&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;c&#39;</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        methods</span><span style="color:#D4D4D4;">: {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">            addItem</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">                this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">list</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">push</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">`</span><span style="color:#569CD6;">${</span><span style="color:#9CDCFE;">Date</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">now</span><span style="color:#D4D4D4;">()</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;">`</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">                this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">list</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">push</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">`</span><span style="color:#569CD6;">${</span><span style="color:#9CDCFE;">Date</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">now</span><span style="color:#D4D4D4;">()</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;">`</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">                this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">list</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">push</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">`</span><span style="color:#569CD6;">${</span><span style="color:#9CDCFE;">Date</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">now</span><span style="color:#D4D4D4;">()</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;">`</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">                // 1.异步渲染，$nextTick待DOM渲染完后再回调</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">                // 2.页面渲染时会将data的修改做整合，多次data修改只会渲染一次</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">                this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">$nextTick</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">                    const</span><span style="color:#4FC1FF;"> ulElem</span><span style="color:#D4D4D4;"> = </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">$refs</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">ul1</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">ulElem</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">childNodes</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">length</span><span style="color:#D4D4D4;">)   </span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">                    // 点击后 6，如果没有$nextTick是3</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">                })</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">script</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>slot</p><p>没有插槽的情况下在组件标签内写一些内容是不起任何作用的，当在组件中声明了slot元素后，在组件元素内写的内容就会替换slot。</p><p>用于父组件中往子组件中插入一段内容。</p><ul><li><p>基本使用</p><p>index.vue</p><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">	&lt;</span><span style="color:#569CD6;">SlotDemo</span><span style="color:#D4D4D4;"> :</span><span style="color:#9CDCFE;">url</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">website</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">url</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    	{{website.title}}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">SlotDemo</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">script</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> SlotDemo</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;./SlotDemo&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    components:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        SlotDemo</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    data</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            website:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                url:</span><span style="color:#CE9178;"> &#39;http://imooc.com/&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                title:</span><span style="color:#CE9178;"> &#39;imooc&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                subTitle:</span><span style="color:#CE9178;"> &#39;程序员的梦工厂&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">script</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>SlotDemo.vue</p><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">	&lt;</span><span style="color:#569CD6;">a</span><span style="color:#D4D4D4;"> :</span><span style="color:#9CDCFE;">href</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">url</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">slot</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            默认内容，即父组件没设置内容时，这里显示</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#569CD6;">slot</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">a</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>作用域插槽</p><p>作用域插槽的主要作用是在书写插槽内容时可以获取到插槽作用域的值</p><p>index.Vue</p><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">	&lt;</span><span style="color:#569CD6;">ScopedSlotDemo</span><span style="color:#D4D4D4;"> :</span><span style="color:#9CDCFE;">url</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">website</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">url</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    	&lt;</span><span style="color:#569CD6;">template</span><span style="color:#9CDCFE;"> v-slot</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">slotProps</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">            &lt;!-- slotProps.slotData 等于 子组件中的website --&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">			{{slotProps.slotData.title}}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">		&lt;/</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">ScopedSlotDemo</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">script</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> ScopedSlotDemo</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;./ScopedSlotDemo&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    components:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        ScopedSlotDemo</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    data</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            website:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                url:</span><span style="color:#CE9178;"> &#39;http://imooc.com/&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                title:</span><span style="color:#CE9178;"> &#39;imooc&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                subTitle:</span><span style="color:#CE9178;"> &#39;程序员的梦工厂&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">script</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ScopedSlotDemo</p><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#569CD6;">a</span><span style="color:#D4D4D4;"> :</span><span style="color:#9CDCFE;">href</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">url</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">slot</span><span style="color:#D4D4D4;"> :</span><span style="color:#9CDCFE;">slotData</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">website</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            {{website.subTitle}} </span><span style="color:#6A9955;">&lt;!-- 默认值显示 subTitle ，即父组件不传内容时 --&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#569CD6;">slot</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">a</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">script</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    props:</span><span style="color:#D4D4D4;"> [</span><span style="color:#CE9178;">&#39;url&#39;</span><span style="color:#D4D4D4;">],</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    data</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            website:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                url:</span><span style="color:#CE9178;"> &#39;http://wangEditor.com/&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                title:</span><span style="color:#CE9178;"> &#39;wangEditor&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                subTitle:</span><span style="color:#CE9178;"> &#39;轻量级富文本编辑器&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">script</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>具名插槽</p><p>index.Vue</p><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">	&lt;</span><span style="color:#569CD6;">NamedSlot</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        &lt;!-- 缩写 &lt;template #header&gt; --&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">template</span><span style="color:#9CDCFE;"> v-slot</span><span style="color:#D4D4D4;">:</span><span style="color:#9CDCFE;">header</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        	&lt;</span><span style="color:#569CD6;">h1</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">将插入header slot中</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">h1</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">		&lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">将插入到main slot中，即未命名的slot</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">		&lt;</span><span style="color:#569CD6;">template</span><span style="color:#9CDCFE;"> v-slot</span><span style="color:#D4D4D4;">:</span><span style="color:#9CDCFE;">footer</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        	&lt;</span><span style="color:#569CD6;">h1</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">将插入footer slot中</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">h1</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">NamedSlot</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>NamedSlot.Vue</p><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">	&lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">header</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        	&lt;</span><span style="color:#569CD6;">slot</span><span style="color:#9CDCFE;"> name</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;header&quot;</span><span style="color:#808080;">&gt;&lt;/</span><span style="color:#569CD6;">slot</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#569CD6;">header</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">main</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        	&lt;</span><span style="color:#569CD6;">slot</span><span style="color:#808080;">&gt;&lt;/</span><span style="color:#569CD6;">slot</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#569CD6;">main</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">footer</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        	&lt;</span><span style="color:#569CD6;">slot</span><span style="color:#9CDCFE;"> name</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;footer&quot;</span><span style="color:#808080;">&gt;&lt;/</span><span style="color:#569CD6;">slot</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#569CD6;">footer</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li><p>动态组件</p><ul><li>用法 <code>&lt;component :is=&quot;component-name&quot; /&gt;</code> 传组件名</li><li>需要根据数据，动态渲染的场景，如常见的有文本，视频，图片组件的新闻详情页。即组件类型不确定。</li><li>每次都会销毁和重建，为了性能优化，也可以使用keep-alive缓存</li></ul></li><li><p>异步组件</p><ul><li><p>import()函数</p><p>同步引入组件：<code>import formDemo from &#39;./formDemo&#39;</code></p><p>异步引入组件：</p><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#D4D4D4;">components:{</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">	formDemo: () =&gt; import(&#39;./formDemo&#39;)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>按需加载，异步加载大组件</p></li></ul></li><li><p>keep-alive</p><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">keep-alive</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">	&lt;KeepAliveStageA v-if=&quot;state === &#39;A&#39;&quot; /&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    &lt;KeepAliveStageB v-if=&quot;state === &#39;B&#39;&quot; /&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    &lt;KeepAliveStageC v-if=&quot;state === &#39;C&#39;&quot; /&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">keep-alive</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>缓存组件</p></li><li><p>频繁切换，不需要重复渲染，用于tab切换等</p></li><li><p>Vue常见性能优化</p></li><li><p>v-show和keep-alive的区别：</p><p>v-show是在css层面，控制元素的显示方式，将display属性在block和none来回切换；</p><p>keep-alive是vue中的一个抽象组件，用于保存组件的渲染状态。</p></li></ul><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">keep-alive</span><span style="color:#D4D4D4;"> :</span><span style="color:#9CDCFE;">include</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">whiteList</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#D4D4D4;"> :</span><span style="color:#9CDCFE;">exclude</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">blackList</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#D4D4D4;"> :</span><span style="color:#9CDCFE;">max</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">amount</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    &lt;router-view&gt;&lt;/router-view&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">keep-alive</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>include</strong>定义缓存白名单，keep-alive会缓存命中的组件；<strong>exclude</strong>定义缓存黑名单，被命中的组件将不会被缓存；<strong>max</strong>定义缓存组件上限，超出上限使用LRU的策略置换缓存数据。</p><blockquote><p><a href="https://links.jianshu.com/go?to=https%3A%2F%2Fbaike.baidu.com%2Fitem%2F%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%2F5633616" target="_blank" rel="noopener noreferrer">内存管理</a>的一种页面置换算法，对于在内存中但又不用的<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fbaike.baidu.com%2Fitem%2F%E6%95%B0%E6%8D%AE%E5%9D%97%2F107672" target="_blank" rel="noopener noreferrer">数据块</a>（内存块）叫做LRU，操作系统会根据哪些数据属于LRU而将其移出内存而腾出空间来加载另外的数据。</p></blockquote></li><li><p>mixin</p><p>mixin.js</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    data</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            city:</span><span style="color:#CE9178;"> &#39;&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    methods:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        showName</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">name</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>index.Vue</p><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">script</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> myMixin</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;./mixin&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    mixins:</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">myMixin</span><span style="color:#D4D4D4;">], </span><span style="color:#6A9955;">// 可以添加多个，会自动合并起来</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    data</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            name:</span><span style="color:#CE9178;"> &#39;&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    methods:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">script</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>多个组件有相同逻辑，抽离出来</li><li>mixin并不是完美的解决方案，会有一些问题 <ul><li>变量来源不明确，不利于阅读</li><li>多mixin可能造成命名冲突</li><li>mixin和组件可能出现多对多的关系，复杂度较高</li></ul></li><li>Vue3提出的Composition API旨在解决这些问题</li></ul></li></ul><h3 id="vuex使用" tabindex="-1"><a class="header-anchor" href="#vuex使用"><span>Vuex使用</span></a></h3><ul><li><p>用于Vue组件</p><ul><li>dispatch</li><li>commit</li><li>mapState</li><li>mapGetters</li><li>mapActions</li><li>mapMutations</li></ul></li><li><p>actions中才能做异步操作，不能在mutations中做</p><p><img src="/csmSimona.github.io/assets/vux%E8%BF%87%E7%A8%8B-DYgreTLi.png" alt="vux过程"></p></li></ul><h3 id="vue-router使用" tabindex="-1"><a class="header-anchor" href="#vue-router使用"><span>Vue-router使用</span></a></h3><ul><li><p>路由模式（hash，H5 history）</p><ul><li>hash模式（默认），如 http://abc.com/#/user/10</li><li>H5 history模式，如 http://abc.com/user/20</li><li>后者需要server端支持，因此无特殊需求可选择前者</li></ul></li><li><p>路由配置（动态路由，懒加载）</p><ul><li><p>动态路由</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> User</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    template:</span><span style="color:#CE9178;"> &#39;&lt;div&gt;User {{ $route.params.id }}&lt;/div&gt;&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> router</span><span style="color:#D4D4D4;"> = </span><span style="color:#569CD6;">new</span><span style="color:#DCDCAA;"> VueRouter</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    routes:</span><span style="color:#D4D4D4;"> [</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 动态路径参数 以冒号开头 能命中&#39;/user/20&#39;,&#39;/user/10&#39;等格式的路由</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        { </span><span style="color:#9CDCFE;">path:</span><span style="color:#CE9178;"> &#39;/user/:id&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">components:</span><span style="color:#9CDCFE;"> User</span><span style="color:#D4D4D4;"> }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">})</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>懒加载</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> router</span><span style="color:#D4D4D4;"> = </span><span style="color:#569CD6;">new</span><span style="color:#DCDCAA;"> VueRouter</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    routes:</span><span style="color:#D4D4D4;"> [</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        { </span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            path:</span><span style="color:#CE9178;"> &#39;/user/:id&#39;</span><span style="color:#D4D4D4;">, </span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">            // 异步加载组件</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">            components</span><span style="color:#9CDCFE;">:</span><span style="color:#D4D4D4;"> () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#569CD6;"> import</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;./../components/Navigator&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">})</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li></ul><h2 id="vue原理" tabindex="-1"><a class="header-anchor" href="#vue原理"><span>Vue原理</span></a></h2><h3 id="组件化基础" tabindex="-1"><a class="header-anchor" href="#组件化基础"><span>组件化基础</span></a></h3><ul><li>“很久以前”就有组件化</li><li>数据驱动视图（MVVM，setState）</li></ul><h3 id="响应式" tabindex="-1"><a class="header-anchor" href="#响应式"><span>响应式</span></a></h3><ul><li><p>组件data的数据一旦变化，立刻触发视图更新</p></li><li><p>核心API - Object.defineProperty</p><ul><li><p>基本用法</p><p><code>Object.defineProperty(obj, props, descriptor)</code></p><p>作用： 在对象上定义一个新属性或者修改原有属性</p><p>返回值： 修改后的目标对象obj</p><p>参数定义：</p><ul><li><p>obj: 在其上定义或修改属性的目标对象</p></li><li><p>props: 属性名称</p></li><li><p>descriptor: 属性描述符</p></li></ul><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> data</span><span style="color:#D4D4D4;"> = {}</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> name</span><span style="color:#D4D4D4;"> = </span><span style="color:#CE9178;">&#39;zhangsan&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">Object</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">defineProperty</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">data</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&quot;name&quot;</span><span style="color:#D4D4D4;">, {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    get</span><span style="color:#9CDCFE;">:</span><span style="color:#569CD6;"> function</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;get&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#9CDCFE;"> name</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    set</span><span style="color:#9CDCFE;">:</span><span style="color:#569CD6;"> function</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">newVal</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;set&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        name</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">newVal</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">})</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 测试</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p>console.log(data.name) // get zhangsan data.name = &#39;lisi&#39; // set</p><div class="language-text line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-text;"><code><span class="line"><span class="line"><span></span></span></span>
<span class="line"><span class="line"><span>- 如何深度监听data变化（简单实现）</span></span></span>
<span class="line"><span class="line"><span></span></span></span>
<span class="line"><span class="line"><span>```js</span></span></span>
<span class="line"><span class="line"><span>function updateView() {</span></span></span>
<span class="line"><span class="line"><span>    console.log(&#39;视图更新&#39;)</span></span></span>
<span class="line"><span class="line"><span>}</span></span></span>
<span class="line"><span class="line"><span>function defineReactive(target, key, value) {</span></span></span>
<span class="line"><span class="line"><span>    // 深度监听</span></span></span>
<span class="line"><span class="line"><span>    observe(value)</span></span></span>
<span class="line"><span class="line"><span>    // 核心API</span></span></span>
<span class="line"><span class="line"><span>    Object.defineProperty(target, key, {</span></span></span>
<span class="line"><span class="line"><span>        get() {</span></span></span>
<span class="line"><span class="line"><span>            return value</span></span></span>
<span class="line"><span class="line"><span>        },</span></span></span>
<span class="line"><span class="line"><span>        set(newValue) {</span></span></span>
<span class="line"><span class="line"><span>            if (newValue !== value) {</span></span></span>
<span class="line"><span class="line"><span>                // 设置新值</span></span></span>
<span class="line"><span class="line"><span>                observe(newValue)</span></span></span>
<span class="line"><span class="line"><span>                value = newValue</span></span></span>
<span class="line"><span class="line"><span>                // 触发更新视图</span></span></span>
<span class="line"><span class="line"><span>                updateView()</span></span></span>
<span class="line"><span class="line"><span>            }</span></span></span>
<span class="line"><span class="line"><span>        }</span></span></span>
<span class="line"><span class="line"><span>    })</span></span></span>
<span class="line"><span class="line"><span>}</span></span></span>
<span class="line"><span class="line"><span></span></span></span>
<span class="line"><span class="line"><span>function observe(target) {</span></span></span>
<span class="line"><span class="line"><span>    if (typeof target !== &#39;object&#39; || target === null) {</span></span></span>
<span class="line"><span class="line"><span>        // 不是对象或数组</span></span></span>
<span class="line"><span class="line"><span>        return target</span></span></span>
<span class="line"><span class="line"><span>    }</span></span></span>
<span class="line"><span class="line"><span>    // 重新定义各个熟悉（for in也可以遍历数组）</span></span></span>
<span class="line"><span class="line"><span>    for (let key in target) {</span></span></span>
<span class="line"><span class="line"><span>        defineReactive(target, key, target[key])</span></span></span>
<span class="line"><span class="line"><span>    }</span></span></span>
<span class="line"><span class="line"><span>}</span></span></span>
<span class="line"><span class="line"><span></span></span></span>
<span class="line"><span class="line"><span>const data = {</span></span></span>
<span class="line"><span class="line"><span>    name: &#39;zhangsan&#39;,</span></span></span>
<span class="line"><span class="line"><span>    age: 20,</span></span></span>
<span class="line"><span class="line"><span>    info: {</span></span></span>
<span class="line"><span class="line"><span>        address: &#39;beijing&#39; // 需要深度监听</span></span></span>
<span class="line"><span class="line"><span>    }</span></span></span>
<span class="line"><span class="line"><span>}</span></span></span>
<span class="line"><span class="line"><span></span></span></span>
<span class="line"><span class="line"><span>data.info.address = &#39;shanghai&#39;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>如何监听数组变化</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 重新定义数组原型</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> oldArrayProperty</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">Array</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">propertype</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 创建新对象，原型指向oldArrayProperty，再扩展新的方法不会影响原型</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> arrProto</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">Object</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">create</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">oldArrayProperty</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 比如 这个新对象有push方法，则先实现他自己定义的push方法</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 然后再处理原型数组的push方法  </span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 即 Array.prototype.push(this, ...arguments)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">[</span><span style="color:#CE9178;">&#39;push&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;pop&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;shift&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;splice&#39;</span><span style="color:#D4D4D4;">].</span><span style="color:#DCDCAA;">forEach</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">methodName</span><span style="color:#569CD6;"> =&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    arrProto</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">methodName</span><span style="color:#D4D4D4;">] = </span><span style="color:#569CD6;">function</span><span style="color:#D4D4D4;"> () {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        updateView</span><span style="color:#D4D4D4;">() </span><span style="color:#6A9955;">//触发视图更新</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 再去实现原型数组中对应的方法</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        oldArrayProperty</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">methodName</span><span style="color:#D4D4D4;">].</span><span style="color:#DCDCAA;">call</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">, ...</span><span style="color:#569CD6;">arguments</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">})</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> observe</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    if</span><span style="color:#D4D4D4;"> (</span><span style="color:#569CD6;">typeof</span><span style="color:#9CDCFE;"> target</span><span style="color:#D4D4D4;"> !== </span><span style="color:#CE9178;">&#39;object&#39;</span><span style="color:#D4D4D4;"> ||</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;"> === </span><span style="color:#569CD6;">null</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#9CDCFE;"> target</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 监听数组</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">Array</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">isArray</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">)) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        target</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">__proto__</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">arrProto</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    for</span><span style="color:#D4D4D4;"> (</span><span style="color:#569CD6;">let</span><span style="color:#9CDCFE;"> key</span><span style="color:#569CD6;"> in</span><span style="color:#9CDCFE;"> target</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        defineReactive</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">])</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>一些缺点（Vue3.0启用Proxy）</p><ul><li>深度监听需要递归到底，一次性计算量大</li><li>无法监听新增/删除属性（因此出现 Vue.set Vue.delete 来弥补该缺点）</li><li>无法原生监听数组，需要特殊处理</li></ul></li><li><p>Proxy有兼容性问题，且无法polyfill</p></li></ul></li></ul><h3 id="vdom-虚拟dom-和diff" tabindex="-1"><a class="header-anchor" href="#vdom-虚拟dom-和diff"><span>⭐vdom（虚拟dom）和diff</span></a></h3><p>（<a href="../%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/react%E5%9F%BA%E7%A1%80">react基础</a>中有写react相关虚拟dom和diff算法）</p><ul><li>vdom是实现vue和React的重要基石</li><li>diff算法是vdom中最核心、最关键的部分</li></ul><h4 id="vdom" tabindex="-1"><a class="header-anchor" href="#vdom"><span>vdom</span></a></h4><p>用JS模拟DOM结构，计算出更小的变更，操作DOM（具体可以看 react基础 中 虚拟DOM 这一节）</p><h5 id="用js模拟dom结构" tabindex="-1"><a class="header-anchor" href="#用js模拟dom结构"><span>用js模拟DOM结构</span></a></h5><div class="language-html line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="html" data-title="html"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-html;"><code><span class="line"><span class="line"><span style="color:#6A9955;">&lt;!-- DOM结构 --&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">div</span><span style="color:#9CDCFE;"> id</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;div1&quot;</span><span style="color:#9CDCFE;"> class</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;container&quot;</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        vdom</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#569CD6;">ul</span><span style="color:#9CDCFE;"> style</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;font-size: 20px;&quot;</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">li</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">a</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">li</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">ul</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// js模拟</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">{</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    tag</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;div&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    props</span><span style="color:#D4D4D4;">: {</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        className</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;container&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        id</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;div1&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    children</span><span style="color:#D4D4D4;">: [</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            tag:</span><span style="color:#CE9178;"> &#39;p&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            children:</span><span style="color:#CE9178;"> &#39;vdom&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }, {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            tag:</span><span style="color:#CE9178;"> &#39;ul&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            props:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                style:</span><span style="color:#CE9178;"> &#39;font-size: 20px;&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            },</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            children:</span><span style="color:#D4D4D4;"> [</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">                {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                    tag:</span><span style="color:#CE9178;"> &#39;li&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                    children:</span><span style="color:#CE9178;"> &#39;a&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">                }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            ]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="通过snabbdom学习vdom" tabindex="-1"><a class="header-anchor" href="#通过snabbdom学习vdom"><span>通过snabbdom学习vdom</span></a></h5><p>snabbdom：性能强大的虚拟dom库</p><ul><li>用js模拟dom结构（vnode）</li><li>新旧vnode对比，得出最小的更新范围，最后更新dom</li><li>数据驱动视图的模式下，高效控制dom操作</li></ul><h4 id="diff算法" tabindex="-1"><a class="header-anchor" href="#diff算法"><span>diff算法</span></a></h4><ul><li>只比较同一层级，不跨级比较</li><li>tag不相同，则直接删掉重建，不再深度比较</li><li>tag和key，两者都相同，则认为是相同节点，不再深度比较</li></ul><p>从snabbdom源码（snabbdom.ts）看diff算法：</p><ul><li>h函数（生成vnode对象）</li><li>patch函数</li><li>patchVnode函数</li><li>addVnodes removeVnodes</li><li>updateChildren函数（key的重要性）</li></ul><h3 id="模板编译" tabindex="-1"><a class="header-anchor" href="#模板编译"><span>模板编译</span></a></h3><h4 id="with语法" tabindex="-1"><a class="header-anchor" href="#with语法"><span>with语法</span></a></h4><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;"> const</span><span style="color:#4FC1FF;"> obj</span><span style="color:#D4D4D4;"> = {</span><span style="color:#9CDCFE;">a:</span><span style="color:#B5CEA8;"> 100</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">b:</span><span style="color:#B5CEA8;"> 200</span><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;"> // 使用with，能改变{}内自由变量的查找方式</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;"> // 将{}内自由变量，当做obj的属性来查找</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;"> with</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">obj</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">   console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">a</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">   console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">b</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">   console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">c</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">// 会报错</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;"> }</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="vue-template-complier-将模板编译为render函数" tabindex="-1"><a class="header-anchor" href="#vue-template-complier-将模板编译为render函数"><span>vue-template-complier 将模板编译为render函数</span></a></h4><div class="language-bash line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-bash;"><code><span class="line"><span class="line"><span style="color:#DCDCAA;">npm</span><span style="color:#CE9178;"> i</span><span style="color:#CE9178;"> vue-template-complier</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>编译成render函数</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> compiler</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">require</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;vue-template-compiler&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 插值</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> template</span><span style="color:#D4D4D4;"> = </span><span style="color:#CE9178;">`&lt;p&gt;{{message}}&lt;/p&gt;`</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 编译出的render函数</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">with</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">){</span><span style="color:#C586C0;">return</span><span style="color:#DCDCAA;"> _c</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;p&#39;</span><span style="color:#D4D4D4;">,[</span><span style="color:#DCDCAA;">_v</span><span style="color:#D4D4D4;">(</span><span style="color:#DCDCAA;">_s</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">message</span><span style="color:#D4D4D4;">))])}</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// h -&gt; vnode</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// _c -&gt; createElement -&gt; vnode</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 表达式</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> template</span><span style="color:#D4D4D4;"> = </span><span style="color:#CE9178;">`&lt;p&gt;{{flag ? message : &#39;no message found&#39;}}&lt;/p&gt;`</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">with</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">){</span><span style="color:#C586C0;">return</span><span style="color:#DCDCAA;"> _c</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;p&#39;</span><span style="color:#D4D4D4;">,[</span><span style="color:#DCDCAA;">_v</span><span style="color:#D4D4D4;">(</span><span style="color:#DCDCAA;">_s</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">flag</span><span style="color:#D4D4D4;"> ? </span><span style="color:#9CDCFE;">message</span><span style="color:#D4D4D4;"> : </span><span style="color:#CE9178;">&#39;no message found&#39;</span><span style="color:#D4D4D4;">))])}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 属性和动态属性</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> template</span><span style="color:#D4D4D4;"> = </span><span style="color:#CE9178;">`</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">    &lt;div id=&quot;div1&quot; class=&quot;container&quot;&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">        &lt;img :src=&quot;imgUrl&quot;/&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">    &lt;/div&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">`</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">with</span><span style="color:#D4D4D4;"> (</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#DCDCAA;"> _c</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;div&quot;</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">staticClass:</span><span style="color:#CE9178;"> &quot;container&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">attrs:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">id:</span><span style="color:#CE9178;"> &quot;div1&quot;</span><span style="color:#D4D4D4;"> } }, [</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        _c</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;img&quot;</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">attrs:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">src:</span><span style="color:#9CDCFE;"> imgUrl</span><span style="color:#D4D4D4;"> } }),</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ]);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 条件</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> template</span><span style="color:#D4D4D4;"> = </span><span style="color:#CE9178;">`</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">    &lt;div&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">        &lt;p v-if=&quot;flag === &#39;a&#39;&quot;&gt;A&lt;/p&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">        &lt;p v-else&gt;B&lt;/p&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">    &lt;/div&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">`</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">with</span><span style="color:#D4D4D4;"> (</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#DCDCAA;"> _c</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;div&quot;</span><span style="color:#D4D4D4;">, [</span><span style="color:#9CDCFE;">flag</span><span style="color:#D4D4D4;"> === </span><span style="color:#CE9178;">&quot;a&quot;</span><span style="color:#D4D4D4;"> ? </span><span style="color:#DCDCAA;">_c</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;p&quot;</span><span style="color:#D4D4D4;">, [</span><span style="color:#DCDCAA;">_v</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;A&quot;</span><span style="color:#D4D4D4;">)]) : </span><span style="color:#DCDCAA;">_c</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;p&quot;</span><span style="color:#D4D4D4;">, [</span><span style="color:#DCDCAA;">_v</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;B&quot;</span><span style="color:#D4D4D4;">)])]);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 循环</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> template</span><span style="color:#D4D4D4;"> = </span><span style="color:#CE9178;">`</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">    &lt;ul&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">        &lt;li v-for=&quot;item in list&quot; :key=&quot;item.id&quot;&gt;{{item.title}}&lt;/li&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">    &lt;/ul&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">`</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">with</span><span style="color:#D4D4D4;"> (</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#DCDCAA;"> _c</span><span style="color:#D4D4D4;">(</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">        &quot;ul&quot;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        _l</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">list</span><span style="color:#D4D4D4;">, </span><span style="color:#569CD6;">function</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">            return</span><span style="color:#DCDCAA;"> _c</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;li&quot;</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">key:</span><span style="color:#9CDCFE;"> item</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;"> }, [</span><span style="color:#DCDCAA;">_v</span><span style="color:#D4D4D4;">(</span><span style="color:#DCDCAA;">_s</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">title</span><span style="color:#D4D4D4;">))]);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }),</span></span></span>
<span class="line"><span class="line"><span style="color:#B5CEA8;">        0</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    );</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 事件</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> template</span><span style="color:#D4D4D4;"> = </span><span style="color:#CE9178;">`</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">    &lt;button @click=&quot;clickHandler&quot;&gt;submit&lt;/button&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">`</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">with</span><span style="color:#D4D4D4;"> (</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#DCDCAA;"> _c</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;button&quot;</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">on:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">click:</span><span style="color:#9CDCFE;"> clickHandler</span><span style="color:#D4D4D4;"> } }, [</span><span style="color:#DCDCAA;">_v</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;submit&quot;</span><span style="color:#D4D4D4;">)]);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// v-model</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> template</span><span style="color:#D4D4D4;"> = </span><span style="color:#CE9178;">`&lt;input type=&quot;text&quot; v-model=&quot;name&quot;&gt;`</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 主要看 input 事件</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">with</span><span style="color:#D4D4D4;"> (</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#DCDCAA;"> _c</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;input&quot;</span><span style="color:#D4D4D4;">, {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        directives:</span><span style="color:#D4D4D4;"> [</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                name:</span><span style="color:#CE9178;"> &quot;model&quot;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                rawName:</span><span style="color:#CE9178;"> &quot;v-model&quot;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                value:</span><span style="color:#9CDCFE;"> name</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                expression:</span><span style="color:#CE9178;"> &quot;name&quot;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        ],</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        attrs:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">type:</span><span style="color:#CE9178;"> &quot;text&quot;</span><span style="color:#D4D4D4;"> },</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        domProps:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">value:</span><span style="color:#9CDCFE;"> name</span><span style="color:#D4D4D4;"> },</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        on:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">            input</span><span style="color:#9CDCFE;">:</span><span style="color:#569CD6;"> function</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">$event</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">                if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">$event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">composing</span><span style="color:#D4D4D4;">) </span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                name</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">$event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    });</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 编译</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> res</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">compiler</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">compile</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">template</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">res</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">render</span><span style="color:#D4D4D4;">)</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 从 vue 源码中找到缩写函数的含义</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> installRenderHelpers</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    target</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">_o</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">markOnce</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    target</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">_n</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">toNumber</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    target</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">_s</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">toString</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    target</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">_l</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">renderList</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    target</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">_t</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">renderSlot</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    target</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">_q</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">looseEqual</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    target</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">_i</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">looseIndexOf</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    target</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">_m</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">renderStatic</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    target</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">_f</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">resolveFilter</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    target</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">_k</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">checkKeyCodes</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    target</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">_b</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">bindObjectProps</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    target</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">_v</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">createTextVNode</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    target</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">_e</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">createEmptyVNode</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    target</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">_u</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">resolveScopedSlots</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    target</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">_g</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">bindObjectListeners</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    target</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">_d</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">bindDynamicKeys</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    target</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">_p</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">prependModifier</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="执行render函数生成vnode" tabindex="-1"><a class="header-anchor" href="#执行render函数生成vnode"><span>执行render函数生成vnode</span></a></h4><p>看上面vdom</p><h3 id="组件渲染过程" tabindex="-1"><a class="header-anchor" href="#组件渲染过程"><span>⭐组件渲染过程</span></a></h3><ul><li>初次渲染过程</li></ul><ol><li>解析模板为render 函数（或在开发环境已完成，vue-loader）</li><li>触发响应式，监听data属性 getter setter</li><li>执行render函数，生成vnode，patch(elem, vnode)</li></ol><ul><li>更新过程</li></ul><ol><li>修改data，触发setter（此前在getter中已被监听）</li><li>重新执行render函数，生成newVnode</li><li>patch(vnode, newVnode)</li></ol><ul><li>异步渲染</li></ul><ol><li>$nextTick</li><li>汇总data的修改，一次性更新视图</li><li>减少DOM操作次数，提高性能</li></ol><h3 id="前端路由" tabindex="-1"><a class="header-anchor" href="#前端路由"><span>前端路由</span></a></h3><p>（具体可看：<a href="../%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/vue.js%E5%9F%BA%E7%A1%80">vue.js基础/单页面两种路由模式：hash与history</a>）</p><h4 id="hash" tabindex="-1"><a class="header-anchor" href="#hash"><span>hash</span></a></h4><p>hash的特点</p><ul><li>hash变化会触发网页跳转，即浏览器的前进、后退</li><li>hash变化不会刷新页面，SPA必须的特点</li><li>hash永远不会提交到server端（前端自生自灭）</li></ul><p>hash 变化，包括：</p><p>a. JS 修改 url</p><p>b. 手动修改 url 的 hash</p><p>c. 浏览器前进、后退</p><p><strong>window.onhashchange</strong></p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 监听hash变化</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">window</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">onhashchange</span><span style="color:#D4D4D4;"> = (</span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;old url&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">oldURL</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;new url&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">newURL</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;hash:&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">location</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">hash</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 进行一些操作</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="h5-history" tabindex="-1"><a class="header-anchor" href="#h5-history"><span>h5 history</span></a></h4><ul><li>用url规范的路由，但跳转时不刷新页面</li><li>history.pushState、history.replaceState</li><li>window.onpopstate</li><li>需要后端支持</li></ul><p><strong>history.pushState</strong>方法接受三个参数，依次为：</p><p>1、state：一个与指定网址相关的状态对象，popstate事件触发时，该对象会传入回调函数。如果不需要这个对象，此处可以填null。可用它来传一些数据</p><p>2、title：新页面的标题，但是所有浏览器目前都忽略这个值，因此这里可以填null。</p><p>3、url：新的网址，必须与当前页面处在同一个域。浏览器的地址栏将显示这个网址。</p><p>history.replaceState方法跟pushState一样只不过replaceState是修改当前的状态。</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 页面初次加载，获取 path</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">document</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">addEventListener</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;DOMContentLoaded&#39;</span><span style="color:#D4D4D4;">, () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;load&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">location</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">pathname</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">})</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 打开一个新的路由</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 【注意】用 pushState 方式，浏览器不会刷新页面</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">document</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">getElementById</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;btn1&#39;</span><span style="color:#D4D4D4;">).</span><span style="color:#DCDCAA;">addEventListener</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;click&#39;</span><span style="color:#D4D4D4;">, () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> state</span><span style="color:#D4D4D4;"> = { </span><span style="color:#9CDCFE;">name:</span><span style="color:#CE9178;"> &#39;page1&#39;</span><span style="color:#D4D4D4;"> }</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;切换路由到&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;page1&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    history</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">pushState</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;page1&#39;</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">// 重要！！</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">})</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 监听浏览器前进、后退</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">window</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">onpopstate</span><span style="color:#D4D4D4;"> = (</span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> { </span><span style="color:#6A9955;">// 重要！！</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;onpopstate&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">location</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">pathname</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 需要 server 端配合，可参考</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// https://router.vuejs.org/zh/guide/essentials/history-mode.html#%E5%90%8E%E7%AB%AF%E9%85%8D%E7%BD%AE%E4%BE%8B%E5%AD%90</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="两者选择" tabindex="-1"><a class="header-anchor" href="#两者选择"><span>两者选择</span></a></h4><ul><li>toB的系统推荐用hash，简单易用，对url规范不敏感</li><li>toC的系统，可以考虑选择h5 history，但需要服务端支持</li></ul><h3 id="面试真题演练" tabindex="-1"><a class="header-anchor" href="#面试真题演练"><span>面试真题演练</span></a></h3><h5 id="v-show和v-if的区别" tabindex="-1"><a class="header-anchor" href="#v-show和v-if的区别"><span>v-show和v-if的区别</span></a></h5><ul><li>v-show通过css display控制显示和隐藏</li><li>v-if 组件真正的渲染和销毁，而不是显示和隐藏</li><li>频繁切换显示状态用v-show，否则用v-if</li></ul><h5 id="为何v-for中要用key" tabindex="-1"><a class="header-anchor" href="#为何v-for中要用key"><span>为何v-for中要用key</span></a></h5><ul><li>必须用key，且不能是index和random</li><li>diff算法中通过tag和key来判断，是否是sameNode</li><li>减少渲染次数，提升渲染性能</li></ul><h5 id="描述vue组件生命周期-有父子组件的情况" tabindex="-1"><a class="header-anchor" href="#描述vue组件生命周期-有父子组件的情况"><span>描述Vue组件生命周期（有父子组件的情况）</span></a></h5><ul><li>单组件生命周期图</li><li>父子组件生命周期关系</li></ul><h5 id="vue组件如何通讯-常见" tabindex="-1"><a class="header-anchor" href="#vue组件如何通讯-常见"><span>Vue组件如何通讯（常见）</span></a></h5><ul><li>父子组件props和this.$emit</li><li>自定义组件event.$on event.$off event.$emit</li><li>vuex</li></ul><h5 id="描述组件渲染和更新的过程" tabindex="-1"><a class="header-anchor" href="#描述组件渲染和更新的过程"><span>描述组件渲染和更新的过程</span></a></h5><ul><li>render函数</li><li>data setter和getter</li><li>watcher监听数据setter和getter</li><li>触发re-render</li></ul><h5 id="双向数据绑定v-model的实现原理" tabindex="-1"><a class="header-anchor" href="#双向数据绑定v-model的实现原理"><span>双向数据绑定v-model的实现原理</span></a></h5><ul><li>input元素的value = this.name</li><li>绑定input事件this.name = $event.target.value</li><li>data更新触发re-render</li></ul><h5 id="对mvvm的理解" tabindex="-1"><a class="header-anchor" href="#对mvvm的理解"><span>⭐对MVVM的理解</span></a></h5><p>（具体可看：<a href="../%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/vue.js%E5%9F%BA%E7%A1%80">vue.js基础/#二、MVVM</a>）</p><p>是指数据层（Model）-视图层（View）-数据视图（ViewModel）的响应式框架：</p><p>1、修改View层，Model对应数据发生变化。</p><p>2、Model数据变化，不需要查找DOM，直接更新View。</p><p>3、在MVVM架构下，View 和 Model 之间并没有直接的联系，而是通过ViewModel进行交互。</p><p>4、ViewModel 通过双向数据绑定把 View 层和 Model 层连接了起来，而View 和 Model 之间的同步工作完全是自动的，无需人为干涉，因此开发者只需关注业务逻辑，不需要手动操作DOM， 不需要关注数据状态的同步问题，复杂的数据状态维护完全由 MVVM 来统一管理。</p><p>5、实现mvvm的双向绑定，是采用<strong>数据劫持结合发布者-订阅者模式</strong>的方式，<strong>通过Proxy来劫持各个属性的set，get，在数据变动时发布消息给订阅者，触发相应的监听回调</strong>。</p><p>就必须要实现以下几点：</p><p>1、实现一个数据监听器Observer，能够对数据对象的所有属性进行监听，如有变动可拿到最新值并通知订阅者</p><p>2、实现一个指令解析器Compile，对每个元素节点的指令进行扫描和解析，根据指令模板替换数据，以及绑定相应的更新函数</p><p>3、实现一个Watcher，作为连接Observer和Compile的桥梁，能够订阅并收到每个属性变动的通知，执行指令绑定的相应回调函数，从而更新视图</p><p>4、mvvm入口函数，整合以上三者</p><h5 id="computed有何特点" tabindex="-1"><a class="header-anchor" href="#computed有何特点"><span>computed有何特点</span></a></h5><ul><li>缓存，data不变不会重新计算</li><li>提高性能</li></ul><h5 id="为何组件data必须是一个函数" tabindex="-1"><a class="header-anchor" href="#为何组件data必须是一个函数"><span>为何组件data必须是一个函数？</span></a></h5><ul><li><p>vue组件相当于class，它可能会被用到很多地方，这就类似于new class实例</p></li><li><p>而对于每一个实例，data都必须是独立的，所以要用函数返回</p></li><li><p>如果不用函数，那多个实例就公用一个data了</p></li></ul><h5 id="ajax请求应该放在哪个生命周期" tabindex="-1"><a class="header-anchor" href="#ajax请求应该放在哪个生命周期"><span>ajax请求应该放在哪个生命周期</span></a></h5><ul><li>mounted</li><li>JS是单线程的，ajax异步获取数据</li><li>放在mounted之前没有用，只会让逻辑更加混乱（event loop 因为生命周期是同步的，ajax是异步的，异步事件是在所有同步执行完成之后执行，放在created，会让人觉得ajax执行在mounted前，即mounted前就已经获得了ajax数据，其实ajax数据是在vue初始化完成后才获取的）</li></ul><h5 id="如何将组件所有props传递给子组件" tabindex="-1"><a class="header-anchor" href="#如何将组件所有props传递给子组件"><span>如何将组件所有props传递给子组件</span></a></h5><ul><li>$props</li><li><code>&lt;User v-bind=&quot;$props&quot; /&gt;</code></li></ul><h5 id="如何自己实现v-model" tabindex="-1"><a class="header-anchor" href="#如何自己实现v-model"><span>如何自己实现v-model</span></a></h5><p>看上面vue高级特性 - 自定义组件 v-model</p><h5 id="多个组件有相同的逻辑-如何抽离" tabindex="-1"><a class="header-anchor" href="#多个组件有相同的逻辑-如何抽离"><span>多个组件有相同的逻辑，如何抽离</span></a></h5><ul><li>mixin（还有缺点）</li></ul><h5 id="何时使用异步组件" tabindex="-1"><a class="header-anchor" href="#何时使用异步组件"><span>何时使用异步组件</span></a></h5><ul><li>加载大组件</li><li>路由异步加载</li></ul><h5 id="何时使用keep-alive" tabindex="-1"><a class="header-anchor" href="#何时使用keep-alive"><span>何时使用keep-alive</span></a></h5><ul><li>缓存组件，不需要重复渲染</li><li>如多个静态tab页的切换</li><li>优化性能</li></ul><h5 id="何时需要使用beforedestory" tabindex="-1"><a class="header-anchor" href="#何时需要使用beforedestory"><span>何时需要使用beforeDestory</span></a></h5><ul><li>解绑自定义事件event.$off</li><li>清除定时器</li><li>解绑自定义的DOM事件，如addEventListener window scroll等</li></ul><h5 id="vuex中action和mutation有何区别" tabindex="-1"><a class="header-anchor" href="#vuex中action和mutation有何区别"><span>vuex中action和mutation有何区别</span></a></h5><ul><li>action中处理异步，mutation不可以</li><li>mutation做原子操作</li><li>action可以整合多个mutation</li></ul><h5 id="vue如何监听数组变化" tabindex="-1"><a class="header-anchor" href="#vue如何监听数组变化"><span>vue如何监听数组变化</span></a></h5><ul><li>Object.defineProperty不能监听数组变化</li><li>重新定义原型，重写push pop等方法，实现监听</li><li>Proxy可以原生支持监听数组变化</li></ul><h5 id="diff算法的时间复杂度" tabindex="-1"><a class="header-anchor" href="#diff算法的时间复杂度"><span>diff算法的时间复杂度</span></a></h5><ul><li>O(n)</li><li>在O(n^3)基础上做了一些调整</li></ul><h5 id="简述diff算法过程" tabindex="-1"><a class="header-anchor" href="#简述diff算法过程"><span>简述diff算法过程</span></a></h5><ul><li>patch(elem, vnode)和patch(vnode, newVnode)</li><li>patchVnode和addVnodes和removeVnodes</li><li>updateChildren(key的重要性)</li></ul><h5 id="vue为何是异步渲染-nexttick何用" tabindex="-1"><a class="header-anchor" href="#vue为何是异步渲染-nexttick何用"><span>vue为何是异步渲染，$nextTick何用</span></a></h5><ul><li>异步渲染（以及合并data修改），以提高渲染性能</li><li>$nextTick在DOM更新完之后，触发回调</li></ul><h5 id="vue常见性能优化" tabindex="-1"><a class="header-anchor" href="#vue常见性能优化"><span>⭐vue常见性能优化</span></a></h5><ul><li><p>合理使用v-show和v-if</p></li><li><p>合理使用computed</p></li><li><p>v-for避免和v-if同时使用</p></li><li><p>自定义事件、dom事件、定时器等及时销毁</p></li><li><p>合理使用异步组件</p></li><li><p>合理使用keep-alive</p></li><li><p>data层级不要太深</p></li><li><p>使用vue-loader在开发环境做模板编译（预编译）</p></li><li><p>webpack层面的优化</p></li><li><p>前端通用的性能优化，如图片懒加载</p></li><li><p>使用SSR</p></li></ul><h2 id="vue3学习" tabindex="-1"><a class="header-anchor" href="#vue3学习"><span>Vue3学习</span></a></h2><h3 id="vue2-x-有哪些不足" tabindex="-1"><a class="header-anchor" href="#vue2-x-有哪些不足"><span>vue2.x 有哪些不足</span></a></h3><ul><li>vue2.x对数组对象的深层监听无法实现。因为组件每次渲染都是将data里的数据通过Object.defineProperty进行响应式或者双向绑定上，之前没有后加的属性是不会被绑定上，也就不会触发更新渲染。</li><li>vue2.x在模板编译过程中会涉及到许多不必要的CPU工作。</li><li>随着功能的增长，复杂组件的代码变得难以维护。</li><li>vue2.x是采用Facebook的Flow做类型检查，但在某些情况下推断有问题，且对typescript支持不太友好（需要使用一堆装饰器语法）。</li></ul><h3 id="vue3比vue2有什么优势" tabindex="-1"><a class="header-anchor" href="#vue3比vue2有什么优势"><span>Vue3比Vue2有什么优势</span></a></h3><ul><li>性能更好</li><li>体积更小</li><li>更好的ts支持</li><li>更好的代码组织</li><li>更好的逻辑抽离</li><li>更多新功能</li></ul><h4 id="源码优化" tabindex="-1"><a class="header-anchor" href="#源码优化"><span>源码优化</span></a></h4><ul><li>更好的代码管理方式：monorepo 根据功能将不同的模块拆分到packages目录下不同的子目录中。这样使得模块拆分更细化，职责划分更明确，模块之间的依赖关系也更加明确，开发人员也更容易阅读、理解和更改所有模块源码，提高代码的可维护性。</li><li>采用typescript开发，也省去了单独维护d.ts文件的麻烦。</li></ul><h4 id="性能优化" tabindex="-1"><a class="header-anchor" href="#性能优化"><span>性能优化</span></a></h4><ul><li>源码体积优化：移除了一些冷门的feature（比如filter、inline-template等），引入tree-shaking技术减少打包体积。</li><li>数据劫持优化：使用Proxy代替vue2.x中的defineProperty，能够深层监听数组对象的变化。</li><li>编译优化：检测出模板中的静态节点、子树甚至数据对象，并在生成的代码中将它们提升到渲染函数之外。这样可以避免在每次渲染时重新创建这些对象，从而大大提高内存使用率并减少垃圾回收的频率。</li><li>语法API优化：推出composition API优化逻辑组合和优化逻辑复用。</li></ul><h3 id="vue3生命周期" tabindex="-1"><a class="header-anchor" href="#vue3生命周期"><span>Vue3生命周期</span></a></h3><h4 id="options-api生命周期" tabindex="-1"><a class="header-anchor" href="#options-api生命周期"><span>Options API生命周期</span></a></h4><ul><li><p>beforeDestory改为beforeUnmount</p></li><li><p>destoryed改为unmounted</p></li><li><p>其他沿用vue2的生命周期</p></li></ul><h4 id="composition-api生命周期" tabindex="-1"><a class="header-anchor" href="#composition-api生命周期"><span>Composition API生命周期</span></a></h4><table><thead><tr><th>Options API</th><th>setup内部的钩子</th></tr></thead><tbody><tr><td>beforeCreate</td><td>不需要</td></tr><tr><td>created</td><td>不需要</td></tr><tr><td>beforeMount</td><td>onBeforeMount</td></tr><tr><td>mounted</td><td>onMounted</td></tr><tr><td>beforeUpdate</td><td>onBeforeUpdate</td></tr><tr><td>updated</td><td>onUpdated</td></tr><tr><td>beforeUnmount</td><td>onBeforeUnmount</td></tr><tr><td>unmounted</td><td>onUnmounted</td></tr><tr><td>errorCaptured</td><td>onErrorCaptured</td></tr><tr><td>renderTracked</td><td>onRenderTracked</td></tr><tr><td>renderTriggered</td><td>onRenderTriggered</td></tr></tbody></table><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">onBeforeMount</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">onMounted</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">onBeforeUpdate</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">onUpdated</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">onBeforeUnmount</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">onUnmounted</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;vue&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 等于 beforeCreate 和 created</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    setup</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;setup&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        onBeforeMount</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;onBeforeMount&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        })</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        onMounted</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;onMounted&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        })</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        onBeforeUpdate</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;onBeforeUpdate&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        })</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        onUpdated</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;onUpdated&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        })</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        onBeforeUnmount</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;onBeforeUnmount&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        })</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        onUnmounted</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;onUnmounted&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        })</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="如何选择" tabindex="-1"><a class="header-anchor" href="#如何选择"><span>如何选择</span></a></h4><ul><li>不建议共用，会引起混乱</li><li>小型项目、业务逻辑简单，用Options API</li><li>中大型项目、业务逻辑复杂，用Composition API</li></ul><h3 id="如何理解ref-toref-和-torefs" tabindex="-1"><a class="header-anchor" href="#如何理解ref-toref-和-torefs"><span>如何理解ref toRef 和 toRefs</span></a></h3><h4 id="ref" tabindex="-1"><a class="header-anchor" href="#ref"><span>ref</span></a></h4><p>如果想要使用vue3 CompositionAPI的方式写程序，就必须用reactive和ref 创建响应式对象</p><p>因为CompositionAPI的方式不支持vue2 的data</p><ul><li><p>生成值类型的响应式数据</p></li><li><p>可用于模板和reactive</p><p><strong>reactive</strong>：接受一个普通对象，返回该普通对象的响应式代理。等同于Vue2.x里面的Vue.observable()</p></li><li><p>通过.value修改值</p></li></ul><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">ref demo {{ageRef}} {{state.name}}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">script</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">ref</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">reactive</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;vue&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    name:</span><span style="color:#CE9178;"> &#39;Ref&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    setup</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> ageRef</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">ref</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">20</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">// 值类型 响应式 </span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> nameRef</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">ref</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;双越&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> state</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">reactive</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            name:</span><span style="color:#9CDCFE;"> nameRef</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        })</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        setTimeout</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;ageRef&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">ageRef</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            ageRef</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;"> = </span><span style="color:#B5CEA8;">25</span><span style="color:#6A9955;"> // .value 修改值</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            nameRef</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;"> = </span><span style="color:#CE9178;">&#39;双越A&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }, </span><span style="color:#B5CEA8;">1500</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            ageRef</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            state</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">script</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以获取DOM元素</p><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#569CD6;">p</span><span style="color:#9CDCFE;"> ref</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;elemRef&quot;</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">我是一行文字</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">script</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">ref</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">onMounted</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;vue&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    name:</span><span style="color:#CE9178;"> &#39;RefTemplate&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    setup</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> elemRef</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">ref</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">null</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        onMounted</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;ref template&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">elemRef</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">innerHTML</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">elemRef</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        })</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            elemRef</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">script</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="toref" tabindex="-1"><a class="header-anchor" href="#toref"><span>toRef</span></a></h4><p>针对一个响应式对象（reactive封装）的prop，创建一个ref</p><p>具有响应式，两者保持引用关系</p><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">toRef demo - {{ageRef}} - {{state.name}} {{state.age}}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">script</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">ref</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">toRef</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">reactive</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;vue&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    name:</span><span style="color:#CE9178;"> &#39;ToRef&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    setup</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> state</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">reactive</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            age:</span><span style="color:#B5CEA8;"> 20</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            name:</span><span style="color:#CE9178;"> &#39;双越&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        })</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> age1</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">computed</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">            return</span><span style="color:#9CDCFE;"> state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">age</span><span style="color:#D4D4D4;"> + </span><span style="color:#B5CEA8;">1</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        })</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // // toRef 如果用于普通对象（非响应式对象），产出的结果不具备响应式</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // const state = {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        //     age: 20,</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        //     name: &#39;双越&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> ageRef</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">toRef</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;age&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 验证引用关系</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        setTimeout</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">age</span><span style="color:#D4D4D4;"> = </span><span style="color:#B5CEA8;">25</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }, </span><span style="color:#B5CEA8;">1500</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        setTimeout</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            ageRef</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;"> = </span><span style="color:#B5CEA8;">30</span><span style="color:#6A9955;"> // .value 修改值</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }, </span><span style="color:#B5CEA8;">3000</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            state</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            ageRef</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">script</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="torefs" tabindex="-1"><a class="header-anchor" href="#torefs"><span>toRefs</span></a></h4><ul><li>将响应式对象（reactive封装）转化为普通对象</li><li>对象的每个prop都是对应的ref</li><li>两者保持引用关系</li></ul><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">toRefs demo {{age}} {{name}}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">script</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">ref</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">toRef</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">toRefs</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">reactive</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;vue&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    name:</span><span style="color:#CE9178;"> &#39;ToRefs&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    setup</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> state</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">reactive</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            age:</span><span style="color:#B5CEA8;"> 20</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            name:</span><span style="color:#CE9178;"> &#39;双越&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        })</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> stateAsRefs</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">toRefs</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">// 将响应式对象，变成普通对象</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // const { age: ageRef, name: nameRef } = stateAsRefs // 每个属性，都是 ref 对象</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // return {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        //     ageRef,</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        //     nameRef</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 验证引用关系</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        setTimeout</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">age</span><span style="color:#D4D4D4;"> = </span><span style="color:#B5CEA8;">25</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }, </span><span style="color:#B5CEA8;">1500</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#9CDCFE;"> stateAsRefs</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        </span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 如果直接解构会丢失响应式数据（就是没有双向数据绑定了）</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // return {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        //     ...state</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">script</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="应用" tabindex="-1"><a class="header-anchor" href="#应用"><span>应用</span></a></h5><p><strong>合成函数返回响应式对象</strong></p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> useFeatureX</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> state</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">reactive</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        x:</span><span style="color:#B5CEA8;"> 1</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        y:</span><span style="color:#B5CEA8;"> 2</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    })</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 逻辑运行状态，省略N行</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 返回时转换为ref</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#DCDCAA;"> toRefs</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    setup</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 可以在不失去响应性的情况下破坏结构</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#D4D4D4;"> { </span><span style="color:#4FC1FF;">x</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">y</span><span style="color:#D4D4D4;"> } = </span><span style="color:#DCDCAA;">useFeatureX</span><span style="color:#D4D4D4;">()</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            x</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">y</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="最佳使用方式" tabindex="-1"><a class="header-anchor" href="#最佳使用方式"><span>最佳使用方式</span></a></h4><ul><li>用reactive做对象的响应式，用ref做值类型的响应式</li><li>setup中返回toRefs(state)，或者toRef(state, &#39;xxx&#39;)</li><li>ref的变量命名都用xxxRef</li><li>合成函数返回响应式对象时，使用toRefs</li></ul><h4 id="为什么存在" tabindex="-1"><a class="header-anchor" href="#为什么存在"><span>为什么存在</span></a></h4><h5 id="为什么需要ref" tabindex="-1"><a class="header-anchor" href="#为什么需要ref"><span>为什么需要ref</span></a></h5><ul><li>返回值类型，会丢失响应式</li><li>如在setup、computed、合成函数，都有可能返回值类型</li></ul><h5 id="为什么需要-value" tabindex="-1"><a class="header-anchor" href="#为什么需要-value"><span>为什么需要.value</span></a></h5><ul><li>ref是一个对象（不丢失响应式），value存储值</li><li>通过.value属性的get和set实现响应式</li><li>用于模板、reactive时，不需要.value，其他情况都需要</li></ul><h5 id="为什么需要toref和torefs" tabindex="-1"><a class="header-anchor" href="#为什么需要toref和torefs"><span>为什么需要toRef和toRefs</span></a></h5><ul><li>初衷：不丢失响应式的情况下，把对象数据 分解/扩散</li><li>前提：针对的是响应式对象（reactive封装的）非普通对象</li><li>注意：不创造响应式，而是延续响应式</li></ul><h3 id="vue3升级了哪些重要的功能" tabindex="-1"><a class="header-anchor" href="#vue3升级了哪些重要的功能"><span>vue3升级了哪些重要的功能</span></a></h3><h4 id="createapp" tabindex="-1"><a class="header-anchor" href="#createapp"><span>createApp</span></a></h4><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// vue2.x</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> app</span><span style="color:#D4D4D4;"> = </span><span style="color:#569CD6;">new</span><span style="color:#DCDCAA;"> Vue</span><span style="color:#D4D4D4;">({ </span><span style="color:#6A9955;">/* 选项 */</span><span style="color:#D4D4D4;">})</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">Vue</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">use</span><span style="color:#D4D4D4;">(</span><span style="color:#6A9955;">/* ... */</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">Vue</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">mixin</span><span style="color:#D4D4D4;">(</span><span style="color:#6A9955;">/* ... */</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">Vue</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">component</span><span style="color:#D4D4D4;">(</span><span style="color:#6A9955;">/* ... */</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">Vue</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">directive</span><span style="color:#D4D4D4;">(</span><span style="color:#6A9955;">/* ... */</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// vue3.x</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> app</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">Vue</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">createApp</span><span style="color:#D4D4D4;">({ </span><span style="color:#6A9955;">/* 选项 */</span><span style="color:#D4D4D4;">})</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">app</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">use</span><span style="color:#D4D4D4;">(</span><span style="color:#6A9955;">/* ... */</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">app</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">mixin</span><span style="color:#D4D4D4;">(</span><span style="color:#6A9955;">/* ... */</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">app</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">component</span><span style="color:#D4D4D4;">(</span><span style="color:#6A9955;">/* ... */</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">app</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">directive</span><span style="color:#D4D4D4;">(</span><span style="color:#6A9955;">/* ... */</span><span style="color:#D4D4D4;">)</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="emits属性" tabindex="-1"><a class="header-anchor" href="#emits属性"><span>emits属性</span></a></h4><p>父组件</p><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">HelloWorld</span><span style="color:#D4D4D4;"> :</span><span style="color:#9CDCFE;">msg</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">msg</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#D4D4D4;"> @</span><span style="color:#9CDCFE;">onSayHello</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">sayHello</span><span style="color:#D4D4D4;">&quot;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>子组件</p><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#D4D4D4;">export default {</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    name: &#39;HelloWorld&#39;,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    props: {</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    	msg: String</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">	emits: [&#39;onSayHello&#39;],</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    setup(props, { emit }) {</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    	emit(&#39;onSayHello&#39;, &#39;aaa&#39;)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="生命周期" tabindex="-1"><a class="header-anchor" href="#生命周期"><span>生命周期</span></a></h4><p>看上面</p><h4 id="多事件" tabindex="-1"><a class="header-anchor" href="#多事件"><span>多事件</span></a></h4><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#6A9955;">&lt;!-- 在methods里定义one two两个函数--&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">button</span><span style="color:#D4D4D4;"> @</span><span style="color:#9CDCFE;">click</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#DCDCAA;">one</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">$event</span><span style="color:#D4D4D4;">), </span><span style="color:#DCDCAA;">two</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">$event</span><span style="color:#D4D4D4;">)</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    Submit</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="fragment" tabindex="-1"><a class="header-anchor" href="#fragment"><span>Fragment</span></a></h4><p>模板中不需要再加一个div</p><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#6A9955;">&lt;!-- vue2.x 组件模板 --&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">	&lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">h3</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">{{title}}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">h3</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">div</span><span style="color:#9CDCFE;"> v-html</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">content</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#808080;">&gt;&lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">&lt;!-- vue3 组件模板 --&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#569CD6;">h3</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">{{title}}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">h3</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#569CD6;">div</span><span style="color:#9CDCFE;"> v-html</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">content</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#808080;">&gt;&lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="移除-sync" tabindex="-1"><a class="header-anchor" href="#移除-sync"><span>移除.sync</span></a></h4><p>改成v-model:xx形式，都是语法糖</p><h4 id="异步组件的写法" tabindex="-1"><a class="header-anchor" href="#异步组件的写法"><span>异步组件的写法</span></a></h4><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#6A9955;">&lt;!-- vue2 写法 --&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">new Vue({</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    // ...</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    components: {</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    	&#39;my-component&#39;: () =&gt; import(&#39;./my-component.vue&#39;)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">})</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">&lt;!-- vue3 写法 --&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">import { createApp, defineAsyncComponent } from &#39;vue&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">createApp({</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">	// ...</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    components: {</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    	AsyncComponent: defineAsyncComponent(() =&gt; import(&#39;./my-component.vue&#39;))</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">})</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="移除filter" tabindex="-1"><a class="header-anchor" href="#移除filter"><span>移除filter</span></a></h4><h4 id="teleport" tabindex="-1"><a class="header-anchor" href="#teleport"><span>Teleport</span></a></h4><p><code>to=&quot;body&quot;</code> 加到body里面</p><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">button</span><span style="color:#D4D4D4;"> @</span><span style="color:#9CDCFE;">click</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">modalOpen</span><span style="color:#D4D4D4;"> = </span><span style="color:#569CD6;">true</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    Open full screen modal! (with teleport)</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">teleport</span><span style="color:#9CDCFE;"> to</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;body&quot;</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">	&lt;div v-if=&quot;modalOpen&quot;&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        &lt;div&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            &lt;button @click=&quot;modalOpen = false&quot;&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">                Close</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            &lt;/button&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        &lt;/div&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    &lt;/div&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">teleport</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="suspense" tabindex="-1"><a class="header-anchor" href="#suspense"><span>Suspense</span></a></h4><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">Suspense</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">	&lt;template&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    	&lt;Test1/&gt; &lt;!-- 是一个异步组件 --&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    &lt;/template&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    &lt;!-- #fallback 就是一个具名插槽</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">		即Suspense组件内部，有两个slot，</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">		其中一个具名为fallback--&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    &lt;template #fallback&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    	loading</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    &lt;/template&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">Suspense</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="composition-api" tabindex="-1"><a class="header-anchor" href="#composition-api"><span>Composition API</span></a></h4><p>看上面</p><h3 id="composition-api如何实现代码逻辑复用" tabindex="-1"><a class="header-anchor" href="#composition-api如何实现代码逻辑复用"><span>Composition API如何实现代码逻辑复用</span></a></h3><ul><li>抽离逻辑代码到一个函数</li><li>函数命名约定为useXxxx格式（React Hooks也是）</li><li>在setup中引用useXxxx函数</li></ul><p><strong>代码演示：MousePosition</strong></p><p>useMousePosition.js</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">ref</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">onMounted</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">onUnmounted</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;vue&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> useMousePosition</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> x</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">ref</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> y</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">ref</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    function</span><span style="color:#DCDCAA;"> update</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        x</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">pageX</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        y</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">pageY</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    onMounted</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;useMousePosition mounted&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        window</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">addEventListener</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;mousemove&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">update</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    })</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    onUnmounted</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;useMousePosition unMounted&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        window</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">removeEventListener</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;mousemove&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">update</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    })</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        x</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        y</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>index.vue</p><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">mouse position {{x}} {{y}}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">script</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> useMousePosition</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;./useMousePosition&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    name:</span><span style="color:#CE9178;"> &#39;MousePosition&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    setup</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#D4D4D4;"> { </span><span style="color:#4FC1FF;">x</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">y</span><span style="color:#D4D4D4;"> } = </span><span style="color:#DCDCAA;">useMousePosition</span><span style="color:#D4D4D4;">()</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            x</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            y</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">script</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="vue3如何实现响应式" tabindex="-1"><a class="header-anchor" href="#vue3如何实现响应式"><span>Vue3如何实现响应式</span></a></h3><h4 id="回顾vue2-x的object-defineproperty" tabindex="-1"><a class="header-anchor" href="#回顾vue2-x的object-defineproperty"><span>回顾Vue2.x的Object.defineProperty</span></a></h4><p>看上面：Vue原理 - 响应式</p><h4 id="学习proxy语法" tabindex="-1"><a class="header-anchor" href="#学习proxy语法"><span>学习Proxy语法</span></a></h4><p>Proxy基本使用</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// const data = {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">//     name: &#39;zhangsan&#39;,</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">//     age: 20,</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// }</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> data</span><span style="color:#D4D4D4;"> = [</span><span style="color:#CE9178;">&#39;a&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;b&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;c&#39;</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> proxyData</span><span style="color:#D4D4D4;"> = </span><span style="color:#569CD6;">new</span><span style="color:#DCDCAA;"> Proxy</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">data</span><span style="color:#D4D4D4;">, {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    get</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">receiver</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 只处理本身（非原型的）属性</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> ownKeys</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">Reflect</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">ownKeys</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">ownKeys</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">includes</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">)) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;get&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">// 监听</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> result</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">Reflect</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">get</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">receiver</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#9CDCFE;"> result</span><span style="color:#6A9955;"> // 返回结果</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    set</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">val</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">receiver</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 重复的数据，不处理</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">val</span><span style="color:#D4D4D4;"> === </span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">]) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">            return</span><span style="color:#569CD6;"> true</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> result</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">Reflect</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">set</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">val</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">receiver</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;set&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">val</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // console.log(&#39;result&#39;, result) // true</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#9CDCFE;"> result</span><span style="color:#6A9955;"> // 是否设置成功</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    deleteProperty</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> result</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">Reflect</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">deleteProperty</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;delete property&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // console.log(&#39;result&#39;, result) // true</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#9CDCFE;"> result</span><span style="color:#6A9955;"> // 是否删除成功</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">})</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Reflect的作用</p><ul><li>和Proxy能力一一对应</li><li>规范化、标准化、函数式</li><li>替代掉Obejct上的工具函数，如Object.getOwnPropertyNames(obj) 可用 Reflect.ownKeys(obj) 来代替</li></ul><h4 id="vue3如何用proxy实现响应式" tabindex="-1"><a class="header-anchor" href="#vue3如何用proxy实现响应式"><span>Vue3如何用Proxy实现响应式</span></a></h4><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 创建响应式</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> reactive</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;"> = {}) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    if</span><span style="color:#D4D4D4;"> (</span><span style="color:#569CD6;">typeof</span><span style="color:#9CDCFE;"> target</span><span style="color:#D4D4D4;"> !== </span><span style="color:#CE9178;">&#39;object&#39;</span><span style="color:#D4D4D4;"> || </span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;"> == </span><span style="color:#569CD6;">null</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 不是对象或数组，则返回</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#9CDCFE;"> target</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 代理配置</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> proxyConf</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        get</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">receiver</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">            // 只处理本身（非原型的）属性</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">            const</span><span style="color:#4FC1FF;"> ownKeys</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">Reflect</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">ownKeys</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">            if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">ownKeys</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">includes</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">)) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;get&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">// 监听</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    </span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">            const</span><span style="color:#4FC1FF;"> result</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">Reflect</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">get</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">receiver</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        </span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">            // 深度监听</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">            // 性能如何提升的？</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">            return</span><span style="color:#DCDCAA;"> reactive</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">result</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        },</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        set</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">val</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">receiver</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">            // 重复的数据，不处理</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">            if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">val</span><span style="color:#D4D4D4;"> === </span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">]) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">                return</span><span style="color:#569CD6;"> true</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    </span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">            const</span><span style="color:#4FC1FF;"> ownKeys</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">Reflect</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">ownKeys</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">            if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">ownKeys</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">includes</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">)) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;已有的 key&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            } </span><span style="color:#C586C0;">else</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;新增的 key&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">            const</span><span style="color:#4FC1FF;"> result</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">Reflect</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">set</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">val</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">receiver</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;set&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">val</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">            // console.log(&#39;result&#39;, result) // true</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">            return</span><span style="color:#9CDCFE;"> result</span><span style="color:#6A9955;"> // 是否设置成功</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        },</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        deleteProperty</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">            const</span><span style="color:#4FC1FF;"> result</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">Reflect</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">deleteProperty</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;delete property&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">            // console.log(&#39;result&#39;, result) // true</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">            return</span><span style="color:#9CDCFE;"> result</span><span style="color:#6A9955;"> // 是否删除成功</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 生成代理对象</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> observed</span><span style="color:#D4D4D4;"> = </span><span style="color:#569CD6;">new</span><span style="color:#DCDCAA;"> Proxy</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">proxyConf</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#9CDCFE;"> observed</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 测试数据</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> data</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    name:</span><span style="color:#CE9178;"> &#39;zhangsan&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    age:</span><span style="color:#B5CEA8;"> 20</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    info:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        city:</span><span style="color:#CE9178;"> &#39;beijing&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        a:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            b:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                c:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                    d:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                        e:</span><span style="color:#B5CEA8;"> 100</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">                    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">                }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> proxyData</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">reactive</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">data</span><span style="color:#D4D4D4;">)</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="proxy实现响应式特点" tabindex="-1"><a class="header-anchor" href="#proxy实现响应式特点"><span>⭐Proxy实现响应式特点</span></a></h4><ul><li>深度监听，性能更好</li><li>可监听 新增/删除 属性</li><li>可监听数组变化</li><li>Proxy能规避Object.defineProperty的问题</li><li>但是现在无法兼容所有浏览器，无法polyfill</li></ul><h3 id="watch和watcheffect的区别是什么" tabindex="-1"><a class="header-anchor" href="#watch和watcheffect的区别是什么"><span>watch和watchEffect的区别是什么</span></a></h3><p><a href="https://juejin.cn/post/7092412488725037087" target="_blank" rel="noopener noreferrer">Vue3中 watch、watchEffect 详解</a></p><ul><li>两者都可监听data属性变化</li><li>watch需要明确监听哪个属性</li><li>watchEffect会根据其中的属性，自动监听其变化</li><li>watchEffect 也是一个帧听器，是一个副作用函数。 它会监听引用数据类型的所有属性，不需要具体到某个属性，一旦运行就会立即监听，组件卸载的时候会停止监听。</li></ul><h4 id="watch" tabindex="-1"><a class="header-anchor" href="#watch"><span>watch</span></a></h4><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#DCDCAA;">setup</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> numberRef</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">ref</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">100</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> state</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">reactive</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        name:</span><span style="color:#CE9178;"> &#39;ccc&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        age:</span><span style="color:#B5CEA8;"> 20</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    })</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    watch</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">numberRef</span><span style="color:#D4D4D4;">, (</span><span style="color:#9CDCFE;">newNumber</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">oldNumber</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;ref watch&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">newNumber</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">oldNumber</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">          // , {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">          //     immediate: true // 初始化之前就监听，可选</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">          // }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">         )</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    setTimeout</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        numberRef</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;"> = </span><span style="color:#B5CEA8;">200</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }, </span><span style="color:#B5CEA8;">1500</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    watch</span><span style="color:#D4D4D4;">(</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 第一个参数，确定要监听哪个属性</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#9CDCFE;"> state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">age</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 第二个参数，回调函数</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        (</span><span style="color:#9CDCFE;">newAge</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">oldAge</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;state watch&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">newAge</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">oldAge</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        },</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 第三个参数，配置项</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            immediate:</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// 初始化之前就监听，可选</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">            // deep: true // 深度监听</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    )</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    setTimeout</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">age</span><span style="color:#D4D4D4;"> = </span><span style="color:#B5CEA8;">25</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }, </span><span style="color:#B5CEA8;">1500</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    setTimeout</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">name</span><span style="color:#D4D4D4;"> = </span><span style="color:#CE9178;">&#39;ccc&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }, </span><span style="color:#B5CEA8;">3000</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        numberRef</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        ...</span><span style="color:#DCDCAA;">toRefs</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="watcheffect" tabindex="-1"><a class="header-anchor" href="#watcheffect"><span>watchEffect</span></a></h4><p>立即执行传入的一个函数，并响应式追踪其依赖，并在其依赖变更时重新运行该函数</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#DCDCAA;">setup</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> numberRef</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">ref</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">100</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> state</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">reactive</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        name:</span><span style="color:#CE9178;"> &#39;ccc&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        age:</span><span style="color:#B5CEA8;"> 20</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    })</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    watchEffect</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 初始化时，一定会执行一次（收集要监听的数据）</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;state.age&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">age</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;state.name&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">name</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    })</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    setTimeout</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">age</span><span style="color:#D4D4D4;"> = </span><span style="color:#B5CEA8;">25</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }, </span><span style="color:#B5CEA8;">1500</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    setTimeout</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">name</span><span style="color:#D4D4D4;"> = </span><span style="color:#CE9178;">&#39;ccc&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }, </span><span style="color:#B5CEA8;">3000</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        numberRef</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        ...</span><span style="color:#DCDCAA;">toRefs</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="setup中如何获取组件实例" tabindex="-1"><a class="header-anchor" href="#setup中如何获取组件实例"><span>setup中如何获取组件实例</span></a></h3><ul><li>在setup和其他Composition API中没有this</li><li>可通过getCurrentInstance获取当前实例</li><li>若使用Options API可照常使用this</li></ul><h3 id="vue3为何比vue2快" tabindex="-1"><a class="header-anchor" href="#vue3为何比vue2快"><span>vue3为何比vue2快</span></a></h3><p>可以在<a href="https://vue-next-template-explorer.netlify.app/" target="_blank" rel="noopener noreferrer">Vue3 Templete Expolorer</a>源码编译尝试</p><h4 id="proxy响应式" tabindex="-1"><a class="header-anchor" href="#proxy响应式"><span>Proxy响应式</span></a></h4><h4 id="patchflag-静态标记" tabindex="-1"><a class="header-anchor" href="#patchflag-静态标记"><span>PatchFlag（静态标记）</span></a></h4><ul><li>编译模板时，动态节点做标记</li><li>标记，分为不同的类型，如TEXT PROPS</li><li>diff算法时，可以区分静态节点，以及不同类型的动态节点</li></ul><p><img src="/csmSimona.github.io/assets/vue23diff%E5%AF%B9%E6%AF%94-ReH9pulb.jpg" alt=""></p><h4 id="hoiststatic" tabindex="-1"><a class="header-anchor" href="#hoiststatic"><span>hoistStatic</span></a></h4><ul><li>将静态节点的定义，提升到父作用域，缓存起来</li><li>多个相邻的静态节点，会被合并起来</li><li>典型的拿空间换时间的优化策略</li></ul><h4 id="cachehandler-缓存事件" tabindex="-1"><a class="header-anchor" href="#cachehandler-缓存事件"><span>cacheHandler（缓存事件）</span></a></h4><h4 id="ssr优化" tabindex="-1"><a class="header-anchor" href="#ssr优化"><span>SSR优化</span></a></h4><ul><li>静态节点直接输出，绕过了vdom</li><li>动态节点，还是需要动态渲染</li></ul><h4 id="tree-shaking" tabindex="-1"><a class="header-anchor" href="#tree-shaking"><span>tree-shaking</span></a></h4><p>编译时，根据不同的情况，引入不同的API</p><h3 id="vite是什么" tabindex="-1"><a class="header-anchor" href="#vite是什么"><span>Vite是什么</span></a></h3><ul><li>一个前端打包工具，Vue作者发起的项目</li><li>借助Vue的影响力，发展较快，和webpack竞争</li><li>优势：开发环境下无需打包，启动快 <ul><li>因为开发环境使用ES6 Module，无须打包 <code>&lt;script type=&quot;module&quot;&gt;</code></li><li>生产环境使用rollup，并不会快很多</li></ul></li></ul><h3 id="composition-api和react-hooks的对比" tabindex="-1"><a class="header-anchor" href="#composition-api和react-hooks的对比"><span>⭐Composition API和React Hooks的对比</span></a></h3><ul><li>前者setup只会被调用一次，而后者函数会被多次调用</li><li>前者无需useMemo useCallback，因为setup只调用一次</li><li>前者无需顾虑调用顺序，而后者需要保证hooks的顺序一致</li><li>前者 reactive+ref 比后者 useState，要难理解</li></ul><h2 id="react使用" tabindex="-1"><a class="header-anchor" href="#react使用"><span>React使用</span></a></h2><h3 id="react基本使用" tabindex="-1"><a class="header-anchor" href="#react基本使用"><span>React基本使用</span></a></h3><h4 id="jsx语法" tabindex="-1"><a class="header-anchor" href="#jsx语法"><span>JSX语法</span></a></h4><ul><li><p>变量、表达式</p><p>我们可以在JSX中使用JS表达式（不能适用于语句），表达式写在大括号“{}”中</p><ul><li><p><code>{2+2}</code> <code>{user.firstName}</code> <code>{formatName(user)}</code></p></li><li><p>在JSX中不能使用if-else语句，但可以使用conditional（三元运算）表达式来替代</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> show</span><span style="color:#D4D4D4;"> = </span><span style="color:#569CD6;">true</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">{</span><span style="color:#9CDCFE;">show</span><span style="color:#D4D4D4;"> ? </span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">img</span><span style="color:#9CDCFE;"> src</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;xxx.png&quot;</span><span style="color:#808080;">/&gt;</span><span style="color:#D4D4D4;"> : </span><span style="color:#CE9178;">&#39;&#39;</span><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>循环</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> list</span><span style="color:#D4D4D4;"> = [</span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">, </span><span style="color:#B5CEA8;">2</span><span style="color:#D4D4D4;">, </span><span style="color:#B5CEA8;">3</span><span style="color:#D4D4D4;">, </span><span style="color:#B5CEA8;">4</span><span style="color:#D4D4D4;">, </span><span style="color:#B5CEA8;">5</span><span style="color:#D4D4D4;">];</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">{</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    list</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">map</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">li</span><span style="color:#9CDCFE;"> key</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">index</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">item</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">li</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    })</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li><p>class style</p><ul><li><p>React推荐使用内联样式。我们可以使用camelCase语法设置内联样式。</p><p>React会在指定元素数字后自动添加px</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">var</span><span style="color:#9CDCFE;"> myStyle</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    fontSize:</span><span style="color:#B5CEA8;"> 100</span><span style="color:#D4D4D4;">,  </span><span style="color:#6A9955;">// css中为font-size</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    color:</span><span style="color:#CE9178;"> &#39;#FF0000&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">};</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">h1</span><span style="color:#9CDCFE;"> style</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">myStyle</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">xxx</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">h1</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">h1</span><span style="color:#9CDCFE;"> style</span><span style="color:#F44747;"> =</span><span style="color:#9CDCFE;"> {{background: red;}}</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">xxx</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">h1</span><span style="color:#808080;">&gt;</span><span style="color:#6A9955;"> //两个大括号</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">red</span><span style="color:#D4D4D4;">-</span><span style="color:#9CDCFE;">btn</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    background</span><span style="color:#D4D4D4;">: </span><span style="color:#9CDCFE;">red</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">h1</span><span style="color:#9CDCFE;"> className</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&#39;red-btn&#39;</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">xxx</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">h1</span><span style="color:#808080;">&gt;</span><span style="color:#6A9955;">  // 使用className而不是class</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li><p>原生HTML</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">var</span><span style="color:#9CDCFE;"> item</span><span style="color:#D4D4D4;"> = </span><span style="color:#CE9178;">`&lt;h1&gt;hello&lt;/h1&gt;`</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">li</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">	key</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">index</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">	onClick</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">handleItemDelete</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">bind</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;">)</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    dangerouslySetInnerHTML</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">__html</span><span style="color:#D4D4D4;">: </span><span style="color:#9CDCFE;">item</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">li</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h4 id="子元素和组件" tabindex="-1"><a class="header-anchor" href="#子元素和组件"><span>子元素和组件</span></a></h4><h4 id="条件渲染" tabindex="-1"><a class="header-anchor" href="#条件渲染"><span>条件渲染</span></a></h4><ul><li><p>if else</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> whiteBtn</span><span style="color:#D4D4D4;"> = </span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">button</span><span style="color:#9CDCFE;"> className</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;btn-white&quot;</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">white btn</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> blackBtn</span><span style="color:#D4D4D4;"> = </span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">button</span><span style="color:#9CDCFE;"> className</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;btn-black&quot;</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">black btn</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">if</span><span style="color:#D4D4D4;"> (</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">theme</span><span style="color:#D4D4D4;"> === </span><span style="color:#CE9178;">&#39;black&#39;</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#9CDCFE;"> blackBtn</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">} </span><span style="color:#C586C0;">else</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#9CDCFE;"> whiteBtn</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>三元表达式</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    {</span><span style="color:#569CD6;"> this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">theme</span><span style="color:#D4D4D4;"> === </span><span style="color:#CE9178;">&#39;black&#39;</span><span style="color:#D4D4D4;"> ? </span><span style="color:#9CDCFE;">blackBtn</span><span style="color:#D4D4D4;"> : </span><span style="color:#9CDCFE;">whiteBtn</span><span style="color:#569CD6;"> }</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>逻辑运算符 &amp;&amp; ||</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    {</span><span style="color:#569CD6;"> this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">theme</span><span style="color:#D4D4D4;"> === </span><span style="color:#CE9178;">&#39;black&#39;</span><span style="color:#D4D4D4;"> &amp;&amp; </span><span style="color:#9CDCFE;">blackBtn</span><span style="color:#569CD6;"> }</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>列表渲染</p><ul><li><p>map</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">class</span><span style="color:#4EC9B0;"> ListDemo</span><span style="color:#569CD6;"> extends</span><span style="color:#4EC9B0;"> React</span><span style="color:#D4D4D4;">.</span><span style="color:#4EC9B0;">Component</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    constructor</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        super</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            list:</span><span style="color:#D4D4D4;"> [</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">                {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                    id:</span><span style="color:#CE9178;"> &#39;id1&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                    title:</span><span style="color:#CE9178;"> &#39;title1&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">                },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">                {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                    id:</span><span style="color:#CE9178;"> &#39;id2&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                    title:</span><span style="color:#CE9178;"> &#39;title2&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">                },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">                {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                    id:</span><span style="color:#CE9178;"> &#39;id3&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                    title:</span><span style="color:#CE9178;"> &#39;title3&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">                }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            ]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    render</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">ul</span><span style="color:#808080;">&gt;</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">list</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">map</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">            return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">li</span><span style="color:#9CDCFE;"> key</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">id</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">index </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">index</span><span style="color:#569CD6;">}</span><span style="color:#D4D4D4;">; title </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">title</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">li</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        })</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">ul</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>key</p></li></ul></li></ul><h4 id="事件" tabindex="-1"><a class="header-anchor" href="#事件"><span>事件</span></a></h4><ul><li><p>bind this</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 将这种作用域的修改放在constructor中，保证作用域绑定操作只执行一次。</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">handleBtnClick</span><span style="color:#D4D4D4;"> = </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">handleBtnClick</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">bind</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">//绑定this为对应组件&lt;TodoList/&gt;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">button</span><span style="color:#9CDCFE;"> className</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;button&quot;</span><span style="color:#9CDCFE;"> onClick</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">handleBtnClick</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">提交</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">handleBtnClick</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // console.log(this)  // this默认是undefined</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        inputValue:</span><span style="color:#CE9178;"> &#39;&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    })</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 用静态方法，this指向当前实例 不需要再绑定this</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">handleBtnClick</span><span style="color:#D4D4D4;"> = () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        inputValue:</span><span style="color:#CE9178;"> &#39;&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    })</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>关于event参数</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#DCDCAA;">handleBtnClick</span><span style="color:#D4D4D4;"> = (</span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    event</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">preventDefault</span><span style="color:#D4D4D4;">()  </span><span style="color:#6A9955;">// 阻止默认行为</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    event</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">stopPropagation</span><span style="color:#D4D4D4;">() </span><span style="color:#6A9955;">// 阻止冒泡</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;target&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">)  </span><span style="color:#6A9955;">// 指向当前元素，即当前元素触发</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;current target&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">currentTarget</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">// 指向当前元素，假象！</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    </span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 注意，event其实是React封装的。可以看__proto__constructor是 SyntheticEvent</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    conole</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;event&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    </span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 原生event（event.nativeEvent）如下。其__proto__constructor是 MouseEvent</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;NativeEvent&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">nativeEvent</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;NativeEvent target&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">nativeEvent</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">//指向当前元素</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;NativeEvent current target&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">nativeEvent</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">currentTarget</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">	// 指向document元素/root组件</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>版本升级</strong></p><p>React16绑定到document</p><p><strong>React17事件绑定到root组件</strong></p><p>有利于多个React版本并存，例如微前端</p></li><li><p>传递自定义参数</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">button</span><span style="color:#9CDCFE;"> className</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;button&quot;</span><span style="color:#9CDCFE;"> onClick</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">handleBtnClick</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">title</span><span style="color:#D4D4D4;">)</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">提交</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">handleBtnClick</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">title</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">title</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;event&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">)  </span><span style="color:#6A9955;">// 最后追加一个参数，即可接收event</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h4 id="表单" tabindex="-1"><a class="header-anchor" href="#表单"><span>表单</span></a></h4><ul><li><p>受控组件</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#DCDCAA;">render</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">name</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">label</span><span style="color:#9CDCFE;"> htmlFor</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;inputName&quot;</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">姓名：</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">label</span><span style="color:#808080;">&gt;</span><span style="color:#569CD6;"> {</span><span style="color:#6A9955;">/* 用 htmlFor 代替 for */</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">input</span><span style="color:#9CDCFE;"> id</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;inputName&quot;</span><span style="color:#9CDCFE;"> value</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">name</span><span style="color:#569CD6;">}</span><span style="color:#9CDCFE;"> onChange</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">onInputChange</span><span style="color:#569CD6;">}</span><span style="color:#808080;">/&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">onInputChange</span><span style="color:#D4D4D4;"> = (</span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        name:</span><span style="color:#9CDCFE;"> e</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    })</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>input textarea select 用value</p></li><li><p>checkbox radio 用checked</p></li><li><p>组件和props（类型检查）</p><ul><li>props传递数据</li><li>props传递函数</li><li>props类型检查</li></ul><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> PropTypes</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;prop-types&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">class</span><span style="color:#4EC9B0;"> Input</span><span style="color:#569CD6;"> extends</span><span style="color:#4EC9B0;"> React</span><span style="color:#D4D4D4;">.</span><span style="color:#4EC9B0;">Component</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    constructor</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        super</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            title:</span><span style="color:#CE9178;"> &#39;&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    render</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#569CD6;">input</span><span style="color:#9CDCFE;"> value</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">title</span><span style="color:#569CD6;">}</span><span style="color:#9CDCFE;"> onChange</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">onTitleChange</span><span style="color:#569CD6;">}</span><span style="color:#808080;">/&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#569CD6;">button</span><span style="color:#9CDCFE;"> onClick</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">onSubmit</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">提交</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    onTitleChange</span><span style="color:#D4D4D4;"> = (</span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            title:</span><span style="color:#9CDCFE;"> e</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        })</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    onSubmit</span><span style="color:#D4D4D4;"> = () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#D4D4D4;"> { </span><span style="color:#4FC1FF;">submitTitle</span><span style="color:#D4D4D4;"> } = </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">props</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        submitTitle</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">title</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">// &#39;abc&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            title:</span><span style="color:#CE9178;"> &#39;&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        })</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// props 类型检查</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">Input</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">propTypes</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    submitTitle:</span><span style="color:#9CDCFE;"> PropTypes</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">func</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">isRequired</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">class</span><span style="color:#4EC9B0;"> List</span><span style="color:#569CD6;"> extends</span><span style="color:#4EC9B0;"> React</span><span style="color:#D4D4D4;">.</span><span style="color:#4EC9B0;">Component</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    constructor</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        super</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    render</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#D4D4D4;"> { </span><span style="color:#4FC1FF;">list</span><span style="color:#D4D4D4;"> } = </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">props</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">ul</span><span style="color:#808080;">&gt;</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">list</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">map</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">            return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">li</span><span style="color:#9CDCFE;"> key</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">id</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">                &lt;</span><span style="color:#569CD6;">span</span><span style="color:#808080;">&gt;</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">title</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">span</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;/</span><span style="color:#569CD6;">li</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        })</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">ul</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// props 类型检查</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">List</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">propTypes</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    list:</span><span style="color:#9CDCFE;"> PropTypes</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">arrayOf</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">PropTypes</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">object</span><span style="color:#D4D4D4;">).</span><span style="color:#9CDCFE;">isRequired</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">class</span><span style="color:#4EC9B0;"> Footer</span><span style="color:#569CD6;"> extends</span><span style="color:#4EC9B0;"> React</span><span style="color:#D4D4D4;">.</span><span style="color:#4EC9B0;">Component</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    constructor</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        super</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    render</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">            {this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">text</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">            {this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">length</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    componentDidUpdate</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;footer did update&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    shouldComponentUpdate</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">nextProps</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">nextState</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">nextProps</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">text</span><span style="color:#D4D4D4;"> !== </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">text</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            || </span><span style="color:#9CDCFE;">nextProps</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">length</span><span style="color:#D4D4D4;"> !== </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">length</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">            return</span><span style="color:#569CD6;"> true</span><span style="color:#6A9955;"> // 可以渲染</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#569CD6;"> false</span><span style="color:#6A9955;"> // 不重复渲染</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // React 默认：父组件有更新，子组件则无条件也更新！！！</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 性能优化对于 React 更加重要！</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // SCU 一定要每次都用吗？—— 需要的时候才优化</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">class</span><span style="color:#4EC9B0;"> TodoListDemo</span><span style="color:#569CD6;"> extends</span><span style="color:#4EC9B0;"> React</span><span style="color:#D4D4D4;">.</span><span style="color:#4EC9B0;">Component</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    constructor</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        super</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 状态（数据）提升</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            list:</span><span style="color:#D4D4D4;"> [</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">                {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                    id:</span><span style="color:#CE9178;"> &#39;id-1&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                    title:</span><span style="color:#CE9178;"> &#39;标题1&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">                },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">                {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                    id:</span><span style="color:#CE9178;"> &#39;id-2&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                    title:</span><span style="color:#CE9178;"> &#39;标题2&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">                },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">                {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                    id:</span><span style="color:#CE9178;"> &#39;id-3&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                    title:</span><span style="color:#CE9178;"> &#39;标题3&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">                }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            ],</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            footerInfo:</span><span style="color:#CE9178;"> &#39;底部文字&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    render</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#4EC9B0;">Input</span><span style="color:#9CDCFE;"> submitTitle</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">onSubmitTitle</span><span style="color:#569CD6;">}</span><span style="color:#808080;">/&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#4EC9B0;">List</span><span style="color:#9CDCFE;"> list</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">list</span><span style="color:#569CD6;">}</span><span style="color:#808080;">/&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#4EC9B0;">Footer</span><span style="color:#9CDCFE;"> text</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">footerInfo</span><span style="color:#569CD6;">}</span><span style="color:#9CDCFE;"> length</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">list</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">length</span><span style="color:#569CD6;">}</span><span style="color:#808080;">/&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    onSubmitTitle</span><span style="color:#D4D4D4;"> = (</span><span style="color:#9CDCFE;">title</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            list:</span><span style="color:#569CD6;"> this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">list</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">concat</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                id:</span><span style="color:#CE9178;"> `id-</span><span style="color:#569CD6;">${</span><span style="color:#9CDCFE;">Date</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">now</span><span style="color:#D4D4D4;">()</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;">`</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                title</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            })</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        })</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> TodoListDemo</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h4 id="state和setstate-重点" tabindex="-1"><a class="header-anchor" href="#state和setstate-重点"><span>state和setState（重点）</span></a></h4><ul><li><p>不可变值</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 不可变值（函数式编程，纯函数） - 数组</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> list5Copy</span><span style="color:#D4D4D4;"> = </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">list5</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">slice</span><span style="color:#D4D4D4;">()</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">list5Copy</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">splice</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">2</span><span style="color:#D4D4D4;">, </span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;a&#39;</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">// 中间插入/删除</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    list1:</span><span style="color:#569CD6;"> this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">list1</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">concat</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">100</span><span style="color:#D4D4D4;">), </span><span style="color:#6A9955;">// 追加</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    list2:</span><span style="color:#D4D4D4;"> [...</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">list2</span><span style="color:#D4D4D4;">, </span><span style="color:#B5CEA8;">100</span><span style="color:#D4D4D4;">], </span><span style="color:#6A9955;">// 追加</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    list3:</span><span style="color:#569CD6;"> this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">list3</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">slice</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">, </span><span style="color:#B5CEA8;">3</span><span style="color:#D4D4D4;">), </span><span style="color:#6A9955;">// 截取</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    list4:</span><span style="color:#569CD6;"> this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">list4</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">filter</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">item</span><span style="color:#569CD6;"> =&gt;</span><span style="color:#9CDCFE;"> item</span><span style="color:#D4D4D4;"> &gt; </span><span style="color:#B5CEA8;">100</span><span style="color:#D4D4D4;">), </span><span style="color:#6A9955;">// 筛选</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    list5:</span><span style="color:#9CDCFE;"> list5Copy</span><span style="color:#6A9955;"> // 其他操作</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">})</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 注意，不能直接对 this.state.list 进行 push pop splice 等，这样违反不可变值</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>可能是异步更新</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    count:</span><span style="color:#569CD6;"> this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> + </span><span style="color:#B5CEA8;">1</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}, () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 联想 Vue $nextTick - DOM</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;count by callback&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">// 回调函数中可以拿到最新的 state</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">})</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;count&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">// 异步的，拿不到最新值</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// setTimeout 中 setState 是同步的</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">setTimeout</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        count:</span><span style="color:#569CD6;"> this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> + </span><span style="color:#B5CEA8;">1</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    })</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;count in setTimeout&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}, </span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">)</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 自己定义的 DOM 事件，setState 是同步的</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">bodyClickHandler</span><span style="color:#D4D4D4;"> = () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        count:</span><span style="color:#569CD6;"> this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> + </span><span style="color:#B5CEA8;">1</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    })</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;count in body event&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">componentDidMount</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 自己定义的 DOM 事件，setState 是同步的</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    document</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">body</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">addEventListener</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;click&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">bodyClickHandler</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">componentWillUnmount</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 及时销毁自定义 DOM 事件</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    document</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">body</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">removeEventListener</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;click&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">bodyClickHandler</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // clearTimeout</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>可能会被合并</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 传入对象，会被合并（类似 Object.assign ）。执行结果只一次 +1</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    count:</span><span style="color:#569CD6;"> this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> + </span><span style="color:#B5CEA8;">1</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">})</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    count:</span><span style="color:#569CD6;"> this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> + </span><span style="color:#B5CEA8;">1</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">})</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    count:</span><span style="color:#569CD6;"> this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> + </span><span style="color:#B5CEA8;">1</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">})</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 传入函数，不会被合并。执行结果是 +3</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">prevState</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        count:</span><span style="color:#9CDCFE;"> prevState</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> + </span><span style="color:#B5CEA8;">1</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">})</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">prevState</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        count:</span><span style="color:#9CDCFE;"> prevState</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> + </span><span style="color:#B5CEA8;">1</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">})</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">prevState</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        count:</span><span style="color:#9CDCFE;"> prevState</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> + </span><span style="color:#B5CEA8;">1</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">})</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h4 id="组件生命周期" tabindex="-1"><a class="header-anchor" href="#组件生命周期"><span>组件生命周期</span></a></h4><p><a href="http://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/" target="_blank" rel="noopener noreferrer">React 组件生命周期图示</a></p><ul><li>constructor：在组件一创建的时刻就被调用。但不归类在React的生命周期中，因为它是ES6里面的东西，不是React独有的。</li><li>componentWillMount：在组件即将被挂载到页面的时刻自动执行。</li><li>componentDidMount：在组件被挂载后自动执行。</li><li>shouldComponentUpdate：组件被更新之前，自动被执行需要返回一个布尔值。true 更新 false 不会被更新</li><li>componentWillUpdate：组件被更新之前，它会自动执行，但是它在shouldComponentUpdate之后被执行，如果返回true就执行，如果返回false，这个函数就不会被执行了。</li><li>componentDidUpdate：组件被更新之后自动执行。</li><li>componentWillReceiveProps：一个组件要从父组件接受参数。只要父组件的render函数被重新执行了，子组件的这个生命周期函数就会被执行（如果这个组件第一次存在与父组件中，不会执行；如果这个组件之前已经存在于父组件中，才会执行）</li><li>componentWillUnmount：当这个组件即将被从页面中剔除的时候，会被执行。</li></ul><h3 id="react高级特性" tabindex="-1"><a class="header-anchor" href="#react高级特性"><span>React高级特性</span></a></h3><h4 id="函数组件" tabindex="-1"><a class="header-anchor" href="#函数组件"><span>函数组件</span></a></h4><ul><li>纯函数，输入props，输出JSX</li><li>没有组件实例</li><li>没有生命周期</li><li>没有state和setState，只能接收props</li><li>不能扩展其他方法</li></ul><h4 id="非受控组件" tabindex="-1"><a class="header-anchor" href="#非受控组件"><span>非受控组件</span></a></h4><ul><li>ref</li><li>defaultValue defaultChecked</li><li>手动操作DOM元素</li><li>使用场景：必须手动操作DOM 元素，setState实现不了的。如文件上传、某些富文本编辑器，需要传入DOM元素</li></ul><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">class</span><span style="color:#4EC9B0;"> App</span><span style="color:#569CD6;"> extends</span><span style="color:#4EC9B0;"> React</span><span style="color:#D4D4D4;">.</span><span style="color:#4EC9B0;">Component</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    constructor</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        super</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            name:</span><span style="color:#CE9178;"> &#39;双越&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            flag:</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">nameInputRef</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">React</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">createRef</span><span style="color:#D4D4D4;">() </span><span style="color:#6A9955;">// 创建 ref</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    render</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // input defaultValue</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">            {</span><span style="color:#6A9955;">/* 使用 defaultValue 而不是 value ，使用 ref */</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#569CD6;">input</span><span style="color:#9CDCFE;"> defaultValue</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">name</span><span style="color:#569CD6;">}</span><span style="color:#9CDCFE;"> ref</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">nameInputRef</span><span style="color:#569CD6;">}</span><span style="color:#808080;">/&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">            {</span><span style="color:#6A9955;">/* state 并不会随着改变 */</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#569CD6;">span</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">state.name: </span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">name</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">span</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#569CD6;">br</span><span style="color:#808080;">/&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#569CD6;">button</span><span style="color:#9CDCFE;"> onClick</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">alertName</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">alert name</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    alertName</span><span style="color:#D4D4D4;"> = () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> elem</span><span style="color:#D4D4D4;"> = </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">nameInputRef</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">current</span><span style="color:#6A9955;"> // 通过 ref 获取 DOM 节点</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        alert</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">elem</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">// 不是 this.state.name</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> App</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">class</span><span style="color:#4EC9B0;"> App</span><span style="color:#569CD6;"> extends</span><span style="color:#4EC9B0;"> React</span><span style="color:#D4D4D4;">.</span><span style="color:#4EC9B0;">Component</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    constructor</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        super</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">fileInputRef</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">React</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">createRef</span><span style="color:#D4D4D4;">()</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    render</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // file</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#569CD6;">input</span><span style="color:#9CDCFE;"> type</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;file&quot;</span><span style="color:#9CDCFE;"> ref</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">fileInputRef</span><span style="color:#569CD6;">}</span><span style="color:#808080;">/&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#569CD6;">button</span><span style="color:#9CDCFE;"> onClick</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">alertFile</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">alert file</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    alertFile</span><span style="color:#D4D4D4;"> = () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> elem</span><span style="color:#D4D4D4;"> = </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">fileInputRef</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">current</span><span style="color:#6A9955;"> // 通过 ref 获取 DOM 节点</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        alert</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">elem</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">files</span><span style="color:#D4D4D4;">[</span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">].</span><span style="color:#9CDCFE;">name</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> App</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>受控组件VS非受控组件</p><p>优先使用受控组件，符合React设计原则；必须操作DOM时，再使用非受控组件</p><ul><li><p>Portals</p><ul><li>组件默认会按照既定层次嵌套渲染</li><li>如何让组件渲染到父组件以外</li><li>使用场景 <ul><li>overflow: hidden</li><li>父组件z-index值太小</li><li>fixed需要放在body第一层级</li></ul></li></ul><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> ReactDOM</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;react-dom&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#CE9178;"> &#39;./style.css&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">class</span><span style="color:#4EC9B0;"> App</span><span style="color:#569CD6;"> extends</span><span style="color:#4EC9B0;"> React</span><span style="color:#D4D4D4;">.</span><span style="color:#4EC9B0;">Component</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    constructor</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        super</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    render</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // // 正常渲染</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // return &lt;div className=&quot;modal&quot;&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        //     {this.props.children} {/* vue slot */}</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // &lt;/div&gt;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 使用 Portals 渲染到 body 上。</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // fixed 元素要放在 body 上，有更好的浏览器兼容性。</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#9CDCFE;"> ReactDOM</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">createPortal</span><span style="color:#D4D4D4;">(</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#569CD6;">div</span><span style="color:#9CDCFE;"> className</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;modal&quot;</span><span style="color:#808080;">&gt;</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">children</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            document</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">body</span><span style="color:#6A9955;"> // DOM 节点</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        )</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> App</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h4 id="context" tabindex="-1"><a class="header-anchor" href="#context"><span>context</span></a></h4><p>优点：变量不用层层传递，省去无谓的传递props</p><p>缺点：使用全局变量的方法，会让组件失去独立性，复用起来更困难，会让组件变得不纯粹，不应该大规模使用。</p><ul><li>公共信息（语言、主题）传递给每个组件</li></ul><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 创建 Context 填入默认值（任何一个 js 变量）</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> ThemeContext</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">React</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">createContext</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;light&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 底层组件 - 函数式组件</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> ThemeLink</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // const theme = this.context // 会报错。函数式组件没有实例，即没有 this</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 函数式组件可以使用 Consumer</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#4EC9B0;">ThemeContext.Consumer</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        {</span><span style="color:#9CDCFE;"> value</span><span style="color:#569CD6;"> =&gt;</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">link&#39;s theme is </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">value</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span><span style="color:#569CD6;"> }</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#4EC9B0;">ThemeContext.Consumer</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 底层组件 - class 组件</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">class</span><span style="color:#4EC9B0;"> ThemedButton</span><span style="color:#569CD6;"> extends</span><span style="color:#4EC9B0;"> React</span><span style="color:#D4D4D4;">.</span><span style="color:#4EC9B0;">Component</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 指定 contextType 读取当前的 theme context。</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // static contextType = ThemeContext // 也可以用 ThemedButton.contextType = ThemeContext</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    render</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> theme</span><span style="color:#D4D4D4;"> = </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">context</span><span style="color:#6A9955;"> // React 会往上找到最近的 theme Provider，然后使用它的值。</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">button&#39;s theme is </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">theme</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">ThemedButton</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">contextType</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">ThemeContext</span><span style="color:#6A9955;"> // 指定 contextType 读取当前的 theme context。</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 中间的组件再也不必指明往下传递 theme 了。</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> Toolbar</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#D4D4D4;"> (</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#4EC9B0;">ThemedButton</span><span style="color:#808080;"> /&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#4EC9B0;">ThemeLink</span><span style="color:#808080;"> /&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    )</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">class</span><span style="color:#4EC9B0;"> App</span><span style="color:#569CD6;"> extends</span><span style="color:#4EC9B0;"> React</span><span style="color:#D4D4D4;">.</span><span style="color:#4EC9B0;">Component</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    constructor</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        super</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            theme:</span><span style="color:#CE9178;"> &#39;light&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    render</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#808080;"> &lt;</span><span style="color:#4EC9B0;">ThemeContext.Provider</span><span style="color:#9CDCFE;"> value</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">theme</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#4EC9B0;">Toolbar</span><span style="color:#808080;"> /&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#569CD6;">hr</span><span style="color:#808080;">/&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#569CD6;">button</span><span style="color:#9CDCFE;"> onClick</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">changeTheme</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">change theme</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#4EC9B0;">ThemeContext.Provider</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    changeTheme</span><span style="color:#D4D4D4;"> = () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            theme:</span><span style="color:#569CD6;"> this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">theme</span><span style="color:#D4D4D4;"> === </span><span style="color:#CE9178;">&#39;light&#39;</span><span style="color:#D4D4D4;"> ? </span><span style="color:#CE9178;">&#39;dark&#39;</span><span style="color:#D4D4D4;"> : </span><span style="color:#CE9178;">&#39;light&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        })</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> App</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="异步组件" tabindex="-1"><a class="header-anchor" href="#异步组件"><span>异步组件</span></a></h4><ul><li>import()</li><li>React.lazy</li><li>React.Suspense</li></ul><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> ContextDemo</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">React</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">lazy</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#569CD6;"> import</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;./ContextDemo&#39;</span><span style="color:#D4D4D4;">))</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">class</span><span style="color:#4EC9B0;"> App</span><span style="color:#569CD6;"> extends</span><span style="color:#4EC9B0;"> React</span><span style="color:#D4D4D4;">.</span><span style="color:#4EC9B0;">Component</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    constructor</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        super</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    render</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">引入一个动态组件</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#569CD6;">hr</span><span style="color:#808080;"> /&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#4EC9B0;">React.Suspense</span><span style="color:#9CDCFE;"> fallback</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">Loading...</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">                &lt;</span><span style="color:#4EC9B0;">ContextDemo</span><span style="color:#808080;">/&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;/</span><span style="color:#4EC9B0;">React.Suspense</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 1. 强制刷新，可看到 loading （看不到就限制一下 chrome 网速）</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 2. 看 network 的 js 加载</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> App</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="性能优化-其中高阶组件值得关注" tabindex="-1"><a class="header-anchor" href="#性能优化-其中高阶组件值得关注"><span>⭐性能优化（其中高阶组件值得关注）</span></a></h4><h5 id="shouldcomponentupdate-简称scu" tabindex="-1"><a class="header-anchor" href="#shouldcomponentupdate-简称scu"><span>shouldComponentUpdate（简称SCU）</span></a></h5><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#DCDCAA;">shouldComponentUpdate</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">nextProps</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">nextState</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">nextState</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> !== </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#569CD6;"> true</span><span style="color:#6A9955;"> // 可以渲染</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#569CD6;"> false</span><span style="color:#6A9955;"> // 不重复渲染</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>React 默认：父组件有更新，子组件则无条件也更新</p><p>SCU默认返回true</p><h5 id="purecomponent和react-memo" tabindex="-1"><a class="header-anchor" href="#purecomponent和react-memo"><span>PureComponent和React.memo</span></a></h5><ul><li><p>PureComponent SCU中实现了浅比较</p></li><li><p>memo 函数组件中的PureComponent</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> MyComponent</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 使用props渲染</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> areEqual</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">prevProps</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">nextProps</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    /* 如果把nextProps传入render方法的返回结果与</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    	将prevProps传入render方法的返回结果一致则返回true</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    	否则返回false</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    */</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> React</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">memo</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">MyComponent</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">areEqual</span><span style="color:#D4D4D4;">)</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>浅比较已使用大部分情况（尽量不要做深度比较）</p></li></ul><h5 id="不可变值-immutable-js" tabindex="-1"><a class="header-anchor" href="#不可变值-immutable-js"><span>不可变值 immutable.js</span></a></h5><p>immutable对象是不可直接赋值的对象,它可以有效的避免错误赋值的问题</p><h5 id="高阶组件hoc" tabindex="-1"><a class="header-anchor" href="#高阶组件hoc"><span>⭐高阶组件HOC</span></a></h5><p>这篇文章推荐阅读：<a href="https://juejin.cn/post/7220677873584734268" target="_blank" rel="noopener noreferrer">高阶组件（HOC）在 React 中的应用</a></p><ul><li><p>高阶组件（HOC）是一个接收组件作为参数并返回一个新组件的函数。换句话说，它是一种组件的转换器。</p></li><li><p>高阶组件通常用于在组件之间复用逻辑，例如状态管理、数据获取、访问控制等。</p></li><li><p>HOC 的一个常见示例是 React-Redux 的 <code>connect</code> 函数，它将 Redux store 连接到 React 组件，使组件可以访问和更新 store 中的状态。</p></li><li><p>我在实际工作中应用在了权限控制和错误边界中（看上面发的文章）</p></li></ul><p>基本使用</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 高阶组件不是一种功能，而是一种模式</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#DCDCAA;"> HOCFactory</span><span style="color:#D4D4D4;"> = (</span><span style="color:#9CDCFE;">Component</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    class</span><span style="color:#4EC9B0;"> HOC</span><span style="color:#569CD6;"> extends</span><span style="color:#4EC9B0;"> React</span><span style="color:#D4D4D4;">.</span><span style="color:#4EC9B0;">Component</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        render</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">            // 返回拼装的结果</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">            return</span><span style="color:#808080;"> &lt;</span><span style="color:#4EC9B0;">Component</span><span style="color:#569CD6;"> {</span><span style="color:#D4D4D4;">...</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">props</span><span style="color:#569CD6;">}</span><span style="color:#808080;">/&gt;</span><span style="color:#D4D4D4;"> </span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#4FC1FF;"> HOC</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> EnhancesComponent1</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">HOCFactory</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">WrappedComponent1</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> EnhancesComponent2</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">HOCFactory</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">WrappedComponent2</span><span style="color:#D4D4D4;">)</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>例子</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 高阶组件</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#DCDCAA;"> withMouse</span><span style="color:#D4D4D4;"> = (</span><span style="color:#9CDCFE;">Component</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    class</span><span style="color:#4EC9B0;"> withMouseComponent</span><span style="color:#569CD6;"> extends</span><span style="color:#4EC9B0;"> React</span><span style="color:#D4D4D4;">.</span><span style="color:#4EC9B0;">Component</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        constructor</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">            super</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">            this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;"> = { </span><span style="color:#9CDCFE;">x:</span><span style="color:#B5CEA8;"> 0</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">y:</span><span style="color:#B5CEA8;"> 0</span><span style="color:#D4D4D4;"> }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  </span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        handleMouseMove</span><span style="color:#D4D4D4;"> = (</span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">            this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                x:</span><span style="color:#9CDCFE;"> event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">clientX</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                y:</span><span style="color:#9CDCFE;"> event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">clientY</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            })</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  </span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        render</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">            return</span><span style="color:#D4D4D4;"> (</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">                &lt;</span><span style="color:#569CD6;">div</span><span style="color:#9CDCFE;"> style</span><span style="color:#F44747;">={{ height: &#39;500px&#39; }}</span><span style="color:#9CDCFE;"> onMouseMove</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">handleMouseMove</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">                    {</span><span style="color:#6A9955;">/* 1. 透传所有 props 2. 增加 mouse 属性 */</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">                    &lt;</span><span style="color:#4EC9B0;">Component</span><span style="color:#569CD6;"> {</span><span style="color:#D4D4D4;">...</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">props</span><span style="color:#569CD6;">}</span><span style="color:#9CDCFE;"> mouse</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#569CD6;">}</span><span style="color:#808080;">/&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">                &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            )</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#9CDCFE;"> withMouseComponent</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#DCDCAA;"> App</span><span style="color:#D4D4D4;"> = (</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> a</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">a</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> { </span><span style="color:#4FC1FF;">x</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">y</span><span style="color:#D4D4D4;"> } = </span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">mouse</span><span style="color:#6A9955;"> // 接收 mouse 属性</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#D4D4D4;"> (</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">div</span><span style="color:#9CDCFE;"> style</span><span style="color:#F44747;">={{ height: &#39;500px&#39; }}&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#F44747;">            &lt;h1&gt;The</span><span style="color:#9CDCFE;"> mouse</span><span style="color:#9CDCFE;"> position</span><span style="color:#9CDCFE;"> is</span><span style="color:#F44747;"> ({x},</span><span style="color:#569CD6;"> {</span><span style="color:#9CDCFE;">y</span><span style="color:#569CD6;">}</span><span style="color:#F44747;">)&lt;/h1&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#F44747;">            &lt;p&gt;{a}&lt;/p&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#F44747;">        &lt;/div&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#F44747;">    )</span></span></span>
<span class="line"><span class="line"><span style="color:#F44747;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">export</span><span style="color:#9CDCFE;"> default</span><span style="color:#F44747;"> withMouse(App)</span><span style="color:#6A9955;"> // 返回高阶函数</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>redux connect 是高阶组件</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">connect</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react-redux&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// connect是高阶组件</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> VisibleTodoList</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">connect</span><span style="color:#D4D4D4;">(</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">	mapStateToProps</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    mapDispatchToProps</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">)(</span><span style="color:#9CDCFE;">TodoList</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> VisibleTodolList</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="render-props" tabindex="-1"><a class="header-anchor" href="#render-props"><span>Render Props</span></a></h4><p>基本使用</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// Render Props的核心思想</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 通过一个函数将class组件的state作为props传递给纯函数组件</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">class</span><span style="color:#4EC9B0;"> Factory</span><span style="color:#569CD6;"> extends</span><span style="color:#4EC9B0;"> React</span><span style="color:#D4D4D4;">.</span><span style="color:#4EC9B0;">Component</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    constructor</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">            // state即多个组件的公共逻辑的数据</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 修改state</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    render</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">render</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">)</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#DCDCAA;"> App</span><span style="color:#D4D4D4;"> = () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> (</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#4EC9B0;">Factory</span><span style="color:#9CDCFE;"> render</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // render是一个函数组件</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        (</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">)</span><span style="color:#569CD6;">=&gt;</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">a</span><span style="color:#569CD6;">}</span><span style="color:#569CD6;"> {</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">b</span><span style="color:#569CD6;">}</span><span style="color:#D4D4D4;"> ... </span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    }</span><span style="color:#808080;">/&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">)</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>例子</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> PropTypes</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;prop-types&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">class</span><span style="color:#4EC9B0;"> Mouse</span><span style="color:#569CD6;"> extends</span><span style="color:#4EC9B0;"> React</span><span style="color:#D4D4D4;">.</span><span style="color:#4EC9B0;">Component</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    constructor</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        super</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;"> = { </span><span style="color:#9CDCFE;">x:</span><span style="color:#B5CEA8;"> 0</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">y:</span><span style="color:#B5CEA8;"> 0</span><span style="color:#D4D4D4;"> }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  </span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    handleMouseMove</span><span style="color:#D4D4D4;"> = (</span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">      this</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setState</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        x:</span><span style="color:#9CDCFE;"> event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">clientX</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        y:</span><span style="color:#9CDCFE;"> event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">clientY</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      })</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  </span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    render</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">      return</span><span style="color:#D4D4D4;"> (</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">div</span><span style="color:#9CDCFE;"> style</span><span style="color:#F44747;">={{ height: &#39;500px&#39; }}</span><span style="color:#9CDCFE;"> onMouseMove</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">handleMouseMove</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">            {</span><span style="color:#6A9955;">/* 将当前 state 作为 props ，传递给 render （render 是一个函数组件） */</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">            {this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">render</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">)</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      )</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">Mouse</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">propTypes</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    render:</span><span style="color:#9CDCFE;"> PropTypes</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">func</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">isRequired</span><span style="color:#6A9955;"> // 必须接收一个 render 属性，而且是函数</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#DCDCAA;"> App</span><span style="color:#D4D4D4;"> = (</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> (</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#569CD6;">div</span><span style="color:#9CDCFE;"> style</span><span style="color:#F44747;">={{ height: &#39;500px&#39; }}&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#F44747;">        &lt;p&gt;{props.a}&lt;/p&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#F44747;">        &lt;Mouse</span><span style="color:#9CDCFE;"> render</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">            /* render 是一个函数组件 */</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            ({ </span><span style="color:#9CDCFE;">x</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">y</span><span style="color:#D4D4D4;"> }) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">h1</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">The mouse position is (</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">x</span><span style="color:#569CD6;">}</span><span style="color:#D4D4D4;">, </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">y</span><span style="color:#569CD6;">}</span><span style="color:#D4D4D4;">)</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">h1</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        }</span><span style="color:#808080;">/&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        </span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    &lt;/</span><span style="color:#9CDCFE;">div</span><span style="color:#D4D4D4;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">/**</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;"> * 即，定义了 Mouse 组件，只有获取 x y 的能力。</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;"> * 至于 Mouse 组件如何渲染，App 说了算，通过 render props 的方式告诉 Mouse 。</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;"> */</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> App</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>HOC VS Render Props</p><ul><li>HOC：模式简单 但会增加组件层级</li><li>Render Props：代码简洁，学习成本较高</li><li>按需使用</li></ul><h3 id="redux使用" tabindex="-1"><a class="header-anchor" href="#redux使用"><span>Redux使用</span></a></h3><p><strong>基本概念</strong></p><p>具体看<a class="route-link" href="/csmSimona.github.io/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/react%E5%9F%BA%E7%A1%80.html">react基础 - redux</a></p><ul><li>store state</li><li>action</li><li>reducer</li></ul><p><strong>单向数据流</strong></p><ul><li>dispatch(action)</li><li>reducer =&gt; newState</li><li>subscribe触发通知</li></ul><p><strong>react-redux</strong></p><p>运用Provider将组件和store对接，使在Provider里的所有组件都能共享store里的数据，</p><p>使用connect将 Redux store 和 React 组件连接，使组件可以访问和更新 store 中的状态。</p><ul><li><p>Provider：作用：连接store，内部组件都有能力获取store的内容</p></li><li><p>connect：组件与store作连接</p></li><li><p>mapStateToProps：把store中state映射成组件中的props</p></li><li><p>mapDispatchToProps：将store.dispatch挂载到props上</p></li></ul><p><strong>异步action</strong></p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 同步action</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#569CD6;"> const</span><span style="color:#DCDCAA;"> addTodo</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">text</span><span style="color:#569CD6;"> =&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 返回action对象</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        type:</span><span style="color:#CE9178;"> &#39;ADD_TODO&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        id:</span><span style="color:#9CDCFE;"> nextTodoId</span><span style="color:#D4D4D4;">++,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        text</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 异步action</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#569CD6;"> const</span><span style="color:#DCDCAA;"> addTodoAsync</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">text</span><span style="color:#569CD6;"> =&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 返回函数，其中有dispatch参数</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">dispatch</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // ajax 异步获取数据</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        fetch</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">url</span><span style="color:#D4D4D4;">).</span><span style="color:#DCDCAA;">then</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">res</span><span style="color:#569CD6;"> =&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">            // 执行异步 action</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">            dispatch</span><span style="color:#D4D4D4;">(</span><span style="color:#DCDCAA;">addTodo</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">res</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">text</span><span style="color:#D4D4D4;">))</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        })</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>中间件</strong></p><p><strong>redux数据流图</strong></p><p><img src="/csmSimona.github.io/assets/redux%E6%95%B0%E6%8D%AE%E6%B5%81%E5%9B%BE-YAbqWv5M.jpg" alt="redux数据流图"></p><h3 id="react-router使用" tabindex="-1"><a class="header-anchor" href="#react-router使用"><span>React-router使用</span></a></h3><ul><li>路由模式（hash、H5 history），同vue-router</li><li>路由配置（动态路由、懒加载），同vue-router</li></ul><p><img src="/csmSimona.github.io/assets/react-router%E8%B7%AF%E7%94%B1%E6%A8%A1%E5%BC%8F-CFLigZr6.jpg" alt="react-router路由模式"></p><p><img src="/csmSimona.github.io/assets/react-router%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1-BEhNwp3K.jpg" alt="react-router动态路由"></p><p><img src="/csmSimona.github.io/assets/react-router%E8%B7%B3%E8%BD%AC%E8%B7%AF%E7%94%B1-BKkPn9JS.jpg" alt="react-router跳转路由"></p><p><img src="/csmSimona.github.io/assets/react-router%E6%87%92%E5%8A%A0%E8%BD%BD-B2S47Bbi.jpg" alt="react-router懒加载"></p><h2 id="react原理" tabindex="-1"><a class="header-anchor" href="#react原理"><span>React原理</span></a></h2><h3 id="函数式编程" tabindex="-1"><a class="header-anchor" href="#函数式编程"><span>函数式编程</span></a></h3><ul><li>纯函数</li><li>不可变值</li></ul><h3 id="vdom和diff" tabindex="-1"><a class="header-anchor" href="#vdom和diff"><span>vdom和diff</span></a></h3><p>以上述vue中类似</p><p>vdom</p><ul><li>h函数</li><li>vnode数据结构</li><li>patch函数</li></ul><p>diff</p><ul><li>只比较同一层级，不跨级比较</li><li>tag不相同，则直接删掉重建，不再深度比较</li><li>tag和key，两者都相同，则认为是相同节点，不再深度比较</li></ul><h3 id="jsx本质" tabindex="-1"><a class="header-anchor" href="#jsx本质"><span>JSX本质</span></a></h3><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> imgElem</span><span style="color:#D4D4D4;"> = </span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">div</span><span style="color:#9CDCFE;"> id</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;div1&quot;</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">some text</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">	&lt;</span><span style="color:#569CD6;">img</span><span style="color:#9CDCFE;"> src</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">imgUrl</span><span style="color:#569CD6;">}</span><span style="color:#808080;"> /&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 编译后</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">React</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">createElement</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;div&quot;</span><span style="color:#D4D4D4;">, {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    id:</span><span style="color:#CE9178;"> &quot;div1&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}, </span><span style="color:#9CDCFE;">React</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">createElement</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;p&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#569CD6;">null</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&quot;some text&quot;</span><span style="color:#D4D4D4;">), </span><span style="color:#9CDCFE;">React</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">createElement</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;img&quot;</span><span style="color:#D4D4D4;">, {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    src:</span><span style="color:#9CDCFE;"> imgUrl</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}))</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="合成事件" tabindex="-1"><a class="header-anchor" href="#合成事件"><span>合成事件</span></a></h3><p>React16</p><ul><li>所有事件挂载到document上</li><li>event不是原生的，是SyntheticEvent合成事件对象</li><li>和Vue事件不同，和DOM事件也不同</li></ul><p>为何要合成事件机制？</p><ul><li>更好的兼容性和跨平台</li><li>挂载到document，减少内存消耗，避免频繁解绑</li><li>方便事件的统一管理（如事务机制）</li></ul><p>React17</p><ul><li>绑定到root组件上</li><li>有利于多个React版本并存，例如微前端</li></ul><h3 id="setstate-和-batchupdate" tabindex="-1"><a class="header-anchor" href="#setstate-和-batchupdate"><span>setState 和 batchUpdate</span></a></h3><p>setState异步还是同步？</p><ul><li>无所谓同步还是异步</li><li>看是否能命中batchUpdate机制</li><li>判断isBatchingUpdates</li></ul><h4 id="setstate主流程" tabindex="-1"><a class="header-anchor" href="#setstate主流程"><span>setState主流程</span></a></h4><p><img src="/csmSimona.github.io/assets/setState%E4%B8%BB%E6%B5%81%E7%A8%8B-MfYINAIe.jpg" alt="setState主流程"></p><h4 id="batchupdate机制" tabindex="-1"><a class="header-anchor" href="#batchupdate机制"><span>batchUpdate机制</span></a></h4><p><strong>isBatchingUpdates</strong></p><p><img src="/csmSimona.github.io/assets/isBatchingUpdates-BDbxfI24.jpg" alt="isBatchingUpdates"></p><p>哪些能命中batchUpdate机制</p><ul><li>生命周期（和它调用的函数）</li><li>React中注册的事件（和它调用的函数）</li><li>React可以“管理”的入口</li></ul><p>哪些不能命中batchUpdate机制</p><ul><li>setTimeout setInterval等（和它调用的函数）</li><li>自定义的DOM事件（和它调用的函数）</li><li>React“管不到”的入口</li></ul><h4 id="transaction-事务-机制" tabindex="-1"><a class="header-anchor" href="#transaction-事务-机制"><span>transaction（事务）机制</span></a></h4><p><img src="/csmSimona.github.io/assets/transaction%E4%BA%8B%E5%8A%A1%E6%9C%BA%E5%88%B6-DvP0ylEV.jpg" alt="transaction事务机制"></p><h3 id="组件渲染过程-1" tabindex="-1"><a class="header-anchor" href="#组件渲染过程-1"><span>组件渲染过程</span></a></h3><ul><li>props state</li><li>render() 生成 vnode</li><li>patch(elem, vnode)</li></ul><p>组件更新过程</p><ul><li>setState(newState) =&gt; dirtyComponents（可能有子组件）</li><li>render() 生成 newVnode</li><li>patch(vnode, newVnode)</li></ul><p>patch拆分成两个阶段：</p><p>1、reconciliation阶段：执行diff算法，纯JS计算</p><p>2、commit阶段：将diff结果渲染DOM</p><p>可能会有性能问题</p><ul><li>JS是单线程，且和DOM渲染共用一个线程</li><li>当组件足够复杂，组件更新时计算和渲染都压力大</li><li>同时再有DOM操作需求（动画，鼠标拖拽等），将卡顿</li></ul><p>性能优化解决方案：react-fiber</p><ul><li>将reconciliation阶段进行任务拆分成子任务</li><li>子任务的执行在DOM需要渲染时暂停，空闲时恢复</li><li>window.requestIdleCallback</li></ul><h3 id="面试真题演练-1" tabindex="-1"><a class="header-anchor" href="#面试真题演练-1"><span>面试真题演练</span></a></h3><h4 id="组件之间如何通讯" tabindex="-1"><a class="header-anchor" href="#组件之间如何通讯"><span>组件之间如何通讯</span></a></h4><ul><li>父子组件props</li><li>自定义事件</li><li>Redux</li><li>Context</li></ul><h4 id="jsx本质是什么" tabindex="-1"><a class="header-anchor" href="#jsx本质是什么"><span>JSX本质是什么</span></a></h4><ul><li>createElement</li><li>执行返回vnode</li></ul><h4 id="react发起ajax应该在哪个生命周期" tabindex="-1"><a class="header-anchor" href="#react发起ajax应该在哪个生命周期"><span>React发起ajax应该在哪个生命周期</span></a></h4><ul><li>同Vue</li><li>componentDidMount</li></ul><h4 id="渲染列表为何使用key" tabindex="-1"><a class="header-anchor" href="#渲染列表为何使用key"><span>渲染列表为何使用key</span></a></h4><ul><li>同Vue。必须用key，且不能是index和random</li><li>diff算法中通过tag和key来判断是否是sameNode</li><li>减少渲染次数，提升渲染性能</li></ul><h4 id="多个组件有公共逻辑-如何抽离" tabindex="-1"><a class="header-anchor" href="#多个组件有公共逻辑-如何抽离"><span>多个组件有公共逻辑，如何抽离</span></a></h4><ul><li>高阶组件</li><li>Render Props</li><li>mixin 已被React废弃</li></ul><h4 id="react性能优化" tabindex="-1"><a class="header-anchor" href="#react性能优化"><span>⭐React性能优化</span></a></h4><ul><li>渲染列表时加key</li><li>自定义事件、DOM事件及时销毁</li><li>合理使用异步组件</li><li>减少函数 bind this 的次数</li><li>合理使用SCU PureComponent 和memo</li><li>合理使用Immutable.js</li><li>webpack层面的优化</li><li>前端通用的性能优化，如图片懒加载</li><li>使用SSR</li></ul><h4 id="react和vue的区别" tabindex="-1"><a class="header-anchor" href="#react和vue的区别"><span>⭐React和Vue的区别</span></a></h4><ul><li><p>都支持组件化</p></li><li><p>都是数据驱动视图</p></li><li><p>都使用vdom操作DOM</p></li><li><p>React使用JSX拥抱JS，Vue使用模板拥抱html</p></li><li><p>React函数式编程，Vue声明式编程</p></li><li><p>React需要更多的自力更生，Vue把想要的都给你</p></li></ul><h2 id="react-hooks" tabindex="-1"><a class="header-anchor" href="#react-hooks"><span>React Hooks</span></a></h2><h3 id="state-hook" tabindex="-1"><a class="header-anchor" href="#state-hook"><span>State Hook</span></a></h3><h4 id="作用-让函数组件实现-state-和-setstate" tabindex="-1"><a class="header-anchor" href="#作用-让函数组件实现-state-和-setstate"><span>作用：让函数组件实现 state 和 setState</span></a></h4><ul><li>默认函数组件没有state</li><li>函数组件是一个纯函数，执行完即销毁，无法存储state</li><li>需要State Hook，即把state功能“钩”到纯函数中</li></ul><h4 id="usestate使用总结" tabindex="-1"><a class="header-anchor" href="#usestate使用总结"><span>useState使用总结</span></a></h4><ul><li><code>useState(0)</code>传入初始值，返回数组[state, setState]</li><li>通过state获取值</li><li>通过<code>setState(1)</code>修改值</li></ul><h4 id="hooks命名规范" tabindex="-1"><a class="header-anchor" href="#hooks命名规范"><span>Hooks命名规范</span></a></h4><ul><li>规定所有的Hooks都用use开头，如useXxx</li><li>自定义Hook也要以use开头</li><li>非Hooks的地方，尽量不要使用useXxx写法</li></ul><h4 id="代码演示" tabindex="-1"><a class="header-anchor" href="#代码演示"><span>代码演示</span></a></h4><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">useState</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> ClickCounter</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 数组的解构</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // useState 就是一个 Hook “钩”，最基本的一个 Hook</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">count</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setCount</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">// 传入一个初始值</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    function</span><span style="color:#DCDCAA;"> clickHandler</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        setCount</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> + </span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">你点击了 </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">count</span><span style="color:#569CD6;">}</span><span style="color:#D4D4D4;"> 次</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">button</span><span style="color:#9CDCFE;"> onClick</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">clickHandler</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">点击</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> ClickCounter</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="effect-hook" tabindex="-1"><a class="header-anchor" href="#effect-hook"><span>Effect Hook</span></a></h3><h4 id="作用-让组件模拟生命周期" tabindex="-1"><a class="header-anchor" href="#作用-让组件模拟生命周期"><span>作用：让组件模拟生命周期</span></a></h4><ul><li>默认函数组件没有生命周期</li><li>函数组件是一个纯函数，执行完即销毁，自己无法实现生命周期</li><li>使用Effect Hook 把生命周期“钩”到纯函数中</li></ul><h4 id="useeffect使用总结" tabindex="-1"><a class="header-anchor" href="#useeffect使用总结"><span>useEffect使用总结</span></a></h4><ul><li><p>模拟 componentDidMount - useEffect 依赖 []</p></li><li><p>模拟 componentDidUpdate - useEffect 无依赖， 或者依赖 [a, b]</p></li><li><p>模拟 componentWillUnMount - useEffect 中返回一个函数fn</p><ul><li>useEffect依赖[]，组件销毁时执行fn，等于WillUnMounted</li><li>useEffect无依赖或依赖[a, b]，组件更新时执行fn</li><li>即，下一次执行useEffect之前，就会执行fn，无论更新或卸载</li></ul></li></ul><h4 id="代码演示-1" tabindex="-1"><a class="header-anchor" href="#代码演示-1"><span>代码演示</span></a></h4><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">useState</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">useEffect</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> LifeCycles</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">count</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setCount</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 模拟 class 组件的 DidMount 和 DidUpdate</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    useEffect</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;在此发送一个 ajax 请求&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    })</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 模拟 class 组件的 DidMount</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    useEffect</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;加载完了&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }, []) </span><span style="color:#6A9955;">// 第二个参数是 [] （不依赖于任何 state）</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 模拟 class 组件的 DidUpdate</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    useEffect</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;更新了&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }, [</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;">]) </span><span style="color:#6A9955;">// 第二个参数就是依赖的 state</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 模拟 class 组件的 DidMount</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    useEffect</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        let</span><span style="color:#9CDCFE;"> timerId</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">window</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setInterval</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">Date</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">now</span><span style="color:#D4D4D4;">())</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }, </span><span style="color:#B5CEA8;">1000</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 返回一个函数</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 模拟 WillUnMount</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#D4D4D4;"> () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            window</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">clearInterval</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">timerId</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }, [])</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    function</span><span style="color:#DCDCAA;"> clickHandler</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        setCount</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> + </span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">你点击了 </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">count</span><span style="color:#569CD6;">}</span><span style="color:#D4D4D4;"> 次</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">button</span><span style="color:#9CDCFE;"> onClick</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">clickHandler</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">点击</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> LifeCycles</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="模拟willunmount-但不完全相等" tabindex="-1"><a class="header-anchor" href="#模拟willunmount-但不完全相等"><span>模拟WillUnMount，但不完全相等</span></a></h4><ul><li>useEffect依赖[]，组件销毁时执行fn，等于WillUnMounted</li><li>useEffect无依赖或依赖[a, b]，组件更新时执行fn</li><li>即，下一次执行useEffect之前，就会执行fn，无论更新或卸载</li></ul><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">useState</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">useEffect</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> FriendStatus</span><span style="color:#D4D4D4;">({ </span><span style="color:#9CDCFE;">friendId</span><span style="color:#D4D4D4;"> }) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">status</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setStatus</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">false</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // DidMount 和 DidUpdate</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    useEffect</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">`开始监听 </span><span style="color:#569CD6;">${</span><span style="color:#9CDCFE;">friendId</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;"> 在线状态`</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 【特别注意】</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 此处并不完全等同于 WillUnMount</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // props 发生变化，即更新，也会执行结束监听</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 准确的说：返回的函数，会在下一次 effect 执行之前，被执行</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#D4D4D4;"> () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">`结束监听 </span><span style="color:#569CD6;">${</span><span style="color:#9CDCFE;">friendId</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;"> 在线状态`</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    })</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        好友 </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">friendId</span><span style="color:#569CD6;">}</span><span style="color:#D4D4D4;"> 在线状态：</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">status</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">toString</span><span style="color:#D4D4D4;">()</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> FriendStatus</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="其他-hook" tabindex="-1"><a class="header-anchor" href="#其他-hook"><span>其他 Hook</span></a></h3><h4 id="useref" tabindex="-1"><a class="header-anchor" href="#useref"><span>useRef</span></a></h4><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">useRef</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">useEffect</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> UseRef</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> btnRef</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useRef</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">null</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">// 初始值</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // const numRef = useRef(0)</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // numRef.current</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    useEffect</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">btnRef</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">current</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">// DOM 节点</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }, [])</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">button</span><span style="color:#9CDCFE;"> ref</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">btnRef</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">click</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> UseRef</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="usecontext" tabindex="-1"><a class="header-anchor" href="#usecontext"><span>useContext</span></a></h4><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">useContext</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 主题颜色</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> themes</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    light:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        foreground:</span><span style="color:#CE9178;"> &#39;#000&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        background:</span><span style="color:#CE9178;"> &#39;#eee&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    dark:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        foreground:</span><span style="color:#CE9178;"> &#39;#fff&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        background:</span><span style="color:#CE9178;"> &#39;#222&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 创建 Context</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> ThemeContext</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">React</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">createContext</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">themes</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">light</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">// 初始值</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> ThemeButton</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> theme</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useContext</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">ThemeContext</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">button</span><span style="color:#9CDCFE;"> style</span><span style="color:#F44747;">={{ background: theme.background, color: theme.foreground }}&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        hello</span><span style="color:#9CDCFE;"> world</span></span></span>
<span class="line"><span class="line"><span style="color:#F44747;">    &lt;/button&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#F44747;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">function</span><span style="color:#F44747;"> Toolbar()</span><span style="color:#569CD6;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#4EC9B0;">ThemeButton</span><span style="color:#808080;">&gt;&lt;/</span><span style="color:#4EC9B0;">ThemeButton</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">function</span><span style="color:#F44747;"> App()</span><span style="color:#569CD6;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#4EC9B0;">ThemeContext.Provider</span><span style="color:#9CDCFE;"> value</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">themes</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">dark</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#4EC9B0;">Toolbar</span><span style="color:#808080;">&gt;&lt;/</span><span style="color:#4EC9B0;">Toolbar</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#4EC9B0;">ThemeContext.Provider</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">export</span><span style="color:#9CDCFE;"> default</span><span style="color:#9CDCFE;"> App</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="usereducer" tabindex="-1"><a class="header-anchor" href="#usereducer"><span>useReducer</span></a></h4><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">useReducer</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> initialState</span><span style="color:#D4D4D4;"> = { </span><span style="color:#9CDCFE;">count:</span><span style="color:#B5CEA8;"> 0</span><span style="color:#D4D4D4;"> }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#DCDCAA;"> reducer</span><span style="color:#D4D4D4;"> = (</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">action</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    switch</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">action</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">type</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        case</span><span style="color:#CE9178;"> &#39;increment&#39;</span><span style="color:#D4D4D4;">:</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">            return</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">count:</span><span style="color:#9CDCFE;"> state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> + </span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;"> }</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        case</span><span style="color:#CE9178;"> &#39;decrement&#39;</span><span style="color:#D4D4D4;">:</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">            return</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">count:</span><span style="color:#9CDCFE;"> state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> - </span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;"> }</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        default</span><span style="color:#D4D4D4;">:</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">            return</span><span style="color:#9CDCFE;"> state</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> App</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 很像 const [count, setCount] = useState(0)</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">state</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">dispatch</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useReducer</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">reducer</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">initialState</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        count: </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">count</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">button</span><span style="color:#9CDCFE;"> onClick</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#D4D4D4;">() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#DCDCAA;"> dispatch</span><span style="color:#D4D4D4;">({ </span><span style="color:#9CDCFE;">type:</span><span style="color:#CE9178;"> &#39;increment&#39;</span><span style="color:#D4D4D4;"> })</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">increment</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">button</span><span style="color:#9CDCFE;"> onClick</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#D4D4D4;">() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#DCDCAA;"> dispatch</span><span style="color:#D4D4D4;">({ </span><span style="color:#9CDCFE;">type:</span><span style="color:#CE9178;"> &#39;decrement&#39;</span><span style="color:#D4D4D4;"> })</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">decrement</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> App</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="usereducer-和-redux-的区别" tabindex="-1"><a class="header-anchor" href="#usereducer-和-redux-的区别"><span>useReducer 和 redux 的区别</span></a></h5><ul><li>useReducer是useState的代替方案，用于state复杂变化</li><li>useReducer是单个组件状态管理，组件通讯还需要props</li><li>redux是全局的状态管理，多组件共享数据</li></ul><h4 id="usememo" tabindex="-1"><a class="header-anchor" href="#usememo"><span>useMemo</span></a></h4><h5 id="usememo使用总结" tabindex="-1"><a class="header-anchor" href="#usememo使用总结"><span>useMemo使用总结</span></a></h5><ul><li>React默认会更新所有子组件</li><li>class组件使用SCU和PureComponent做优化</li><li>Hooks中使用useMemo，但优化的原理是相同的</li><li>memo封装子组件，useMemo封装数据</li></ul><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">useState</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">memo</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">useMemo</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 子组件</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 类似 class PureComponent ，对 props 进行浅层比较</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> Child</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">memo</span><span style="color:#D4D4D4;">(({ </span><span style="color:#9CDCFE;">userInfo</span><span style="color:#D4D4D4;"> }) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;Child render...&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">userInfo</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">This is Child </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">userInfo</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">name</span><span style="color:#569CD6;">}</span><span style="color:#569CD6;"> {</span><span style="color:#9CDCFE;">userInfo</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">age</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">})</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 父组件</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> App</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;Parent render...&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">count</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setCount</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">name</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setName</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;双越老师&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // const userInfo = { name, age: 20 }</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 用 useMemo 缓存数据，有依赖</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> userInfo</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useMemo</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">name</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">age:</span><span style="color:#B5CEA8;"> 21</span><span style="color:#D4D4D4;"> }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }, [</span><span style="color:#9CDCFE;">name</span><span style="color:#D4D4D4;">])</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            count is </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">count</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#569CD6;">button</span><span style="color:#9CDCFE;"> onClick</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#D4D4D4;">() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#DCDCAA;"> setCount</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> + </span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">)</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">click</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#4EC9B0;">Child</span><span style="color:#9CDCFE;"> userInfo</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">userInfo</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;&lt;/</span><span style="color:#4EC9B0;">Child</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> App</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="usecallback" tabindex="-1"><a class="header-anchor" href="#usecallback"><span>useCallback</span></a></h4><p><strong>useMemo缓存数据，useCallback缓存函数</strong></p><ul><li><p>都用于缓存数据，优化性能</p></li><li><p>两者接收的参数都是一样的，第一个参数表示一个回调函数，第二个表示依赖的数据</p></li><li><p>在依赖数据发生变化的时候，才会调用传进去的回调函数去重新计算结果，起到一个缓存的作用</p></li></ul><p>区别：</p><ul><li><p>useMemo 缓存的结果是回调函数中return回来的值，主要用于缓存计算结果的值，应用场景如需要计算的状态</p></li><li><p>useCallback 缓存的结果是函数，主要用于缓存函数，应用场景如需要缓存的函数，因为函数式组件每次任何一个state发生变化，会触发整个组件更新，一些函数是没有必要更新的，此时就应该缓存起来，提高性能，减少对资源的浪费</p><p>另外还需要注意的是，useCallback应该和React.memo配套使用，缺了一个都可能导致性能不升反而下降。</p></li></ul><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">useState</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">memo</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">useMemo</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">useCallback</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 子组件，memo 相当于 PureComponent</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> Child</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">memo</span><span style="color:#D4D4D4;">(({ </span><span style="color:#9CDCFE;">userInfo</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">onChange</span><span style="color:#D4D4D4;"> }) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;Child render...&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">userInfo</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">This is Child </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">userInfo</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">name</span><span style="color:#569CD6;">}</span><span style="color:#569CD6;"> {</span><span style="color:#9CDCFE;">userInfo</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">age</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">input</span><span style="color:#9CDCFE;"> onChange</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">onChange</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;&lt;/</span><span style="color:#569CD6;">input</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">})</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 父组件</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> App</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;Parent render...&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">count</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setCount</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">name</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setName</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;双越老师&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 用 useMemo 缓存数据</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> userInfo</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useMemo</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">name</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">age:</span><span style="color:#B5CEA8;"> 21</span><span style="color:#D4D4D4;"> }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }, [</span><span style="color:#9CDCFE;">name</span><span style="color:#D4D4D4;">])</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // function onChange(e) {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    //     console.log(e.target.value)</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // }</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 用 useCallback 缓存函数</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> onChange</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useCallback</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">e</span><span style="color:#569CD6;"> =&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">target</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }, [])</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            count is </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">count</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#569CD6;">button</span><span style="color:#9CDCFE;"> onClick</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#D4D4D4;">() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#DCDCAA;"> setCount</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> + </span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">)</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">click</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#4EC9B0;">Child</span><span style="color:#9CDCFE;"> userInfo</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">userInfo</span><span style="color:#569CD6;">}</span><span style="color:#9CDCFE;"> onChange</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">onChange</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;&lt;/</span><span style="color:#4EC9B0;">Child</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> App</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="uselayouteffect" tabindex="-1"><a class="header-anchor" href="#uselayouteffect"><span>useLayoutEffect</span></a></h4><p>用法与useEffect相似</p><p>区别</p><ul><li><code>useEffect</code> 是异步执行的，而<code>useLayoutEffect</code>是同步执行的。</li><li><code>useEffect</code> 的执行时机是浏览器完成渲染之后，而 <code>useLayoutEffect</code> 的执行时机是浏览器把内容真正渲染到界面之前，和 <code>componentDidMount</code> 等价。</li></ul><p>总结</p><ol><li>优先使用 <code>useEffect</code>，因为它是异步执行的，不会阻塞渲染</li><li>会影响到渲染的操作尽量放到 <code>useLayoutEffect</code>中去，避免出现闪烁问题</li><li><code>useLayoutEffect</code>和<code>componentDidMount</code>是等价的，会同步调用，阻塞渲染</li><li>在服务端渲染的时候使用会有一个 warning，因为它可能导致首屏实际内容和服务端渲染出来的内容不一致。</li></ol><h4 id="useupdateeffect" tabindex="-1"><a class="header-anchor" href="#useupdateeffect"><span>useUpdateEffect</span></a></h4><p>ahooks里的</p><p><code>useUpdateEffect</code> 用法等同于 <code>useEffect</code>，但是会<strong>忽略首次执行</strong>，只在依赖更新时执行。</p><h4 id="usememoizedfn" tabindex="-1"><a class="header-anchor" href="#usememoizedfn"><span>useMemoizedFn</span></a></h4><p>ahooks里的</p><p>我在实现多页签方案时有实际使用</p><ul><li><p>一般情况下，可以使用 useMemoizedFn 完全代替 useCallback</p></li><li><p>在某些场景中，我们需要使用 useCallback 来记住一个函数，但是在第二个参数 deps 变化时，会重新生成函数，导致函数地址变化。</p></li><li><p>使用 useMemoizedFn，可以省略第二个参数 deps，同时保证函数地址永远不会变化。</p></li></ul><h3 id="自定义-hook" tabindex="-1"><a class="header-anchor" href="#自定义-hook"><span>自定义 Hook</span></a></h3><h4 id="自定义useaxios" tabindex="-1"><a class="header-anchor" href="#自定义useaxios"><span>自定义useAxios</span></a></h4><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">useState</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">useEffect</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> axios</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;axios&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 封装 axios 发送网络请求的自定义 Hook</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> useAxios</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">url</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">loading</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setLoading</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">false</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">data</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setData</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">()</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">error</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setError</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">()</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    useEffect</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 利用 axios 发送网络请求</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        setLoading</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">true</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        axios</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">get</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">url</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">// 发送一个 get 请求</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            .</span><span style="color:#DCDCAA;">then</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">res</span><span style="color:#569CD6;"> =&gt;</span><span style="color:#DCDCAA;"> setData</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">res</span><span style="color:#D4D4D4;">))</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            .</span><span style="color:#DCDCAA;">catch</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">err</span><span style="color:#569CD6;"> =&gt;</span><span style="color:#DCDCAA;"> setError</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">err</span><span style="color:#D4D4D4;">))</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            .</span><span style="color:#DCDCAA;">finally</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#DCDCAA;"> setLoading</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">false</span><span style="color:#D4D4D4;">))</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }, [</span><span style="color:#9CDCFE;">url</span><span style="color:#D4D4D4;">])</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">loading</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">data</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">error</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> useAxios</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 第三方 Hook</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// https://nikgraf.github.io/react-hooks/</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// https://github.com/umijs/hooks</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> useAxios</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;../customHooks/useAxios&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> App</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> url</span><span style="color:#D4D4D4;"> = </span><span style="color:#CE9178;">&#39;http://localhost:3000/&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 数组解构</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">loading</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">data</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">error</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useAxios</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">url</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">loading</span><span style="color:#D4D4D4;">) </span><span style="color:#C586C0;">return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">loading...</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#9CDCFE;"> error</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        ? </span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span><span style="color:#569CD6;">{</span><span style="color:#4FC1FF;">JSON</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">stringify</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">error</span><span style="color:#D4D4D4;">)</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        : </span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span><span style="color:#569CD6;">{</span><span style="color:#4FC1FF;">JSON</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">stringify</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">data</span><span style="color:#D4D4D4;">)</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> App</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="自定义usemouseposition" tabindex="-1"><a class="header-anchor" href="#自定义usemouseposition"><span>自定义useMousePosition</span></a></h4><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">useState</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">useEffect</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> useMousePosition</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">x</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setX</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">y</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setY</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    useEffect</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        function</span><span style="color:#DCDCAA;"> mouseMoveHandler</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">            setX</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">clientX</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">            setY</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">clientY</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 绑定事件</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        document</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">body</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">addEventListener</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;mousemove&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">mouseMoveHandler</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 解绑事件</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#D4D4D4;"> () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#9CDCFE;"> document</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">body</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">removeEventListener</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;mousemove&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">mouseMoveHandler</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }, [])</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">x</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">y</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> useMousePosition</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> useMousePosition</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;../customHooks/useMousePosition&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> App</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">x</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">y</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useMousePosition</span><span style="color:#D4D4D4;">()</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#9CDCFE;"> style</span><span style="color:#F44747;">={{ height: &#39;500px&#39;, backgroundColor: &#39;#ccc&#39; }}&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#F44747;">        &lt;p&gt;鼠标位置</span><span style="color:#569CD6;"> {</span><span style="color:#9CDCFE;">x</span><span style="color:#569CD6;">}</span><span style="color:#569CD6;"> {</span><span style="color:#9CDCFE;">y</span><span style="color:#569CD6;">}</span><span style="color:#F44747;">&lt;/p&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#F44747;">    &lt;/div&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#F44747;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">export</span><span style="color:#9CDCFE;"> default</span><span style="color:#9CDCFE;"> App</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="倒计时useinterval" tabindex="-1"><a class="header-anchor" href="#倒计时useinterval"><span>倒计时useInterval</span></a></h4><p>ahooks中有这个功能</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">useEffect</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">useRef</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">/**</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;"> * </span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;"> * </span><span style="color:#569CD6;">@param</span><span style="color:#4EC9B0;"> {*}</span><span style="color:#9CDCFE;"> fn</span><span style="color:#6A9955;"> 回调函数</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;"> * </span><span style="color:#569CD6;">@param</span><span style="color:#4EC9B0;"> {*}</span><span style="color:#9CDCFE;"> delay</span><span style="color:#6A9955;"> 延迟时间</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;"> * </span><span style="color:#569CD6;">@param</span><span style="color:#4EC9B0;"> {*}</span><span style="color:#9CDCFE;"> options</span><span style="color:#6A9955;"> {immediate} 是否立即执行</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;"> */</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> useInterval</span><span style="color:#D4D4D4;">(</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    fn</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    delay</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    options</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> immediate</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">options</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">immediate</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> fnRef</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useRef</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    fnRef</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">current</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">fn</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    useEffect</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        if</span><span style="color:#D4D4D4;"> (</span><span style="color:#569CD6;">typeof</span><span style="color:#9CDCFE;"> delay</span><span style="color:#D4D4D4;"> !== </span><span style="color:#CE9178;">&#39;number&#39;</span><span style="color:#D4D4D4;"> || </span><span style="color:#9CDCFE;">delay</span><span style="color:#D4D4D4;"> &lt; </span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">) </span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">immediate</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            fnRef</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">current</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> timer</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">setInterval</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            fnRef</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">current</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }, </span><span style="color:#9CDCFE;">delay</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#D4D4D4;"> () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">            clearInterval</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">timer</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        };</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }, [</span><span style="color:#9CDCFE;">delay</span><span style="color:#D4D4D4;">]);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> useInterval</span><span style="color:#D4D4D4;">;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">interval</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setInterval</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">undefined</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">count</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setCount</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">5</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#DCDCAA;"> handleGo</span><span style="color:#D4D4D4;"> = () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">history</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">push</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;/&#39;</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">};</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">useInterval</span><span style="color:#D4D4D4;">(</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">      if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> &gt; </span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        setCount</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> - </span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      }</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">      if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> === </span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        setInterval</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">undefined</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        handleGo</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    interval</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      immediate:</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  );</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="hooks-使用规范" tabindex="-1"><a class="header-anchor" href="#hooks-使用规范"><span>Hooks 使用规范</span></a></h3><ul><li>只能用于React函数组件和自定义Hook中，其他地方不可以</li><li>只能用于顶层代码，不能在循环、判断中使用Hooks（Hooks严重依赖于调用顺序，如果Hooks出现在循环、判断里，则无法保证顺序一致）</li><li>eslint插件eslint-plugin-resct-hooks可以帮到你</li></ul><h3 id="规范和注意事项" tabindex="-1"><a class="header-anchor" href="#规范和注意事项"><span>规范和注意事项</span></a></h3><ul><li><p>useState初始化值，只有第一次有效</p><ul><li>render: 初始化 state</li><li>re-render: 只恢复初始化的 state 值，不会再重新设置新的值。只能用 setName 修改</li></ul><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">useState</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 子组件</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> Child</span><span style="color:#D4D4D4;">({ </span><span style="color:#9CDCFE;">userInfo</span><span style="color:#D4D4D4;"> }) {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // render: 初始化 state</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // re-render: 只恢复初始化的 state 值，不会再重新设置新的值</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    //            只能用 setName 修改</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [ </span><span style="color:#4FC1FF;">name</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setName</span><span style="color:#D4D4D4;"> ] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">userInfo</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">name</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">Child, props name: </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">userInfo</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">name</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">	/* 点击后会改变 */</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">Child, state name: </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">name</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">p</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">			/* 点击后不会改变 */</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> App</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">name</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setName</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;双越&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> userInfo</span><span style="color:#D4D4D4;"> = { </span><span style="color:#9CDCFE;">name</span><span style="color:#D4D4D4;"> }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            Parent </span><span style="color:#569CD6;">&amp;nbsp;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#569CD6;">button</span><span style="color:#9CDCFE;"> onClick</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#D4D4D4;">() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#DCDCAA;"> setName</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;慕课网&#39;</span><span style="color:#D4D4D4;">)</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">setName</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#4EC9B0;">Child</span><span style="color:#9CDCFE;"> userInfo</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">userInfo</span><span style="color:#569CD6;">}</span><span style="color:#808080;">/&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> App</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>useEffect内部不能修改state</p><ul><li>依赖为 [] 时： re-render 不会重新执行 effect 函数</li><li>没有依赖：re-render 会重新执行 effect 函数</li></ul></li><li><p>useEffect可能出现死循环</p><ul><li>当依赖中有引用对象时，会出现死循环</li><li>使用useRef来解决</li></ul></li></ul><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> React</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">useState</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">useRef</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">useEffect</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> UseEffectChangeState</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">count</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setCount</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 模拟 DidMount</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> countRef</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useRef</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    useEffect</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;useEffect...&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 定时任务</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> timer</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">setInterval</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;setInterval...&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">countRef</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">current</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">            // setCount(count + 1)</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">            setCount</span><span style="color:#D4D4D4;">(++</span><span style="color:#9CDCFE;">countRef</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">current</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }, </span><span style="color:#B5CEA8;">1000</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 清除定时任务</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#D4D4D4;"> () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#DCDCAA;"> clearTimeout</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">timer</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }, []) </span><span style="color:#6A9955;">// 依赖为 []</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 依赖为 [] 时： re-render 不会重新执行 effect 函数</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 没有依赖：re-render 会重新执行 effect 函数</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#808080;"> &lt;</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">count: </span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">count</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> UseEffectChangeState</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="几个面试题" tabindex="-1"><a class="header-anchor" href="#几个面试题"><span>几个面试题</span></a></h3><h4 id="为什么会有react-hooks-它解决了哪些问题" tabindex="-1"><a class="header-anchor" href="#为什么会有react-hooks-它解决了哪些问题"><span>为什么会有React Hooks，它解决了哪些问题</span></a></h4><ul><li>完善函数组件的能力，函数组件更适合React组件</li><li>组件逻辑复用，Hooks表现更好，使用Hooks，相同逻辑可分割到一个一个的useEffect中，而不是像class组件一样，分布在各个生命周期中</li><li>class复杂组件正在变得费解，不易拆解，不易测试，逻辑混乱</li></ul><p><strong>class组件的问题</strong></p><ul><li>大型组件很难拆分和重构，很难测试（即class不易拆分）</li><li>相同业务逻辑，分散到各个方法中，逻辑混乱</li><li>复用逻辑变得复杂，如Mixins，HOC，Render Prop</li></ul><p>所以函数组件更适合React组件，但需要Hooks增强功能</p><h4 id="react-hooks-如何模拟组件生命周期" tabindex="-1"><a class="header-anchor" href="#react-hooks-如何模拟组件生命周期"><span>React Hooks 如何模拟组件生命周期</span></a></h4><ul><li><p>模拟 componentDidMount - useEffect 依赖 []</p></li><li><p>模拟 componentDidUpdate - useEffect 无依赖， 或者依赖 [a, b]</p></li><li><p>模拟 componentWillUnMount - useEffect 中返回一个函数</p><ul><li><p>useEffect依赖[]，组件销毁时执行fn，等于WillUnMounted</p></li><li><p>useEffect无依赖或依赖[a, b]，组件更新时执行fn</p></li><li><p>即，下一次执行useEffect之前，就会执行fn，无论更新或卸载</p></li></ul></li></ul><h4 id="如何自定义-hook" tabindex="-1"><a class="header-anchor" href="#如何自定义-hook"><span>如何自定义 Hook</span></a></h4><h4 id="react-hooks-性能优化" tabindex="-1"><a class="header-anchor" href="#react-hooks-性能优化"><span>React Hooks 性能优化</span></a></h4><ul><li><p>useMemo缓存数据，useCallback缓存函数</p></li><li><p>相当于class组件的SCU和PureComponent</p></li></ul><h4 id="使用-react-hooks-遇到哪些坑" tabindex="-1"><a class="header-anchor" href="#使用-react-hooks-遇到哪些坑"><span>使用 React Hooks 遇到哪些坑</span></a></h4><ul><li><p>useState初始化值，只有第一次有效</p></li><li><p>useEffect内部不能修改state</p></li><li><p>useEffect可能出现死循环</p></li></ul><h4 id="hooks-相比-hoc-和-render-prop-有哪些优点" tabindex="-1"><a class="header-anchor" href="#hooks-相比-hoc-和-render-prop-有哪些优点"><span>Hooks 相比 HOC 和 Render Prop 有哪些优点</span></a></h4><ul><li>完全符合Hooks原有规则，没有其他要求，易理解记忆</li><li>变量作用域明确</li><li>不会产生组件嵌套</li></ul><h2 id="webpack-和-babel" tabindex="-1"><a class="header-anchor" href="#webpack-和-babel"><span>webpack 和 babel</span></a></h2><p><a href="https://blog.csdn.net/Roselane_Begger/article/details/98635216?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522162244124816780274149586%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=162244124816780274149586&amp;biz_id=0&amp;spm=1018.2226.3001.4450" target="_blank" rel="noopener noreferrer">webpack概念与基本配置</a></p><h3 id="基本配置" tabindex="-1"><a class="header-anchor" href="#基本配置"><span>基本配置</span></a></h3><ul><li><p>拆分配置和merge</p></li><li><p>启动本地服务</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C8C8C8;">    devServer</span><span style="color:#D4D4D4;">: {</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        port</span><span style="color:#D4D4D4;">: </span><span style="color:#B5CEA8;">8080</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        progress</span><span style="color:#D4D4D4;">: </span><span style="color:#569CD6;">true</span><span style="color:#D4D4D4;">,  </span><span style="color:#6A9955;">// 显示打包的进度条</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        contentBase</span><span style="color:#D4D4D4;">: </span><span style="color:#9CDCFE;">distPath</span><span style="color:#D4D4D4;">,  </span><span style="color:#6A9955;">// 根目录</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        open</span><span style="color:#D4D4D4;">: </span><span style="color:#569CD6;">true</span><span style="color:#D4D4D4;">,  </span><span style="color:#6A9955;">// 自动打开浏览器</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        compress</span><span style="color:#D4D4D4;">: </span><span style="color:#569CD6;">true</span><span style="color:#D4D4D4;">,  </span><span style="color:#6A9955;">// 启动 gzip 压缩</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 设置代理</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        proxy</span><span style="color:#D4D4D4;">: {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">            // 将本地 /api/xxx 代理到 localhost:3000/api/xxx</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">            &#39;/api&#39;</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;http://localhost:3000&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">            // 将本地 /api2/xxx 代理到 localhost:3000/xxx</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">            &#39;/api2&#39;</span><span style="color:#D4D4D4;">: {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                target:</span><span style="color:#CE9178;"> &#39;http://localhost:3000&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                pathRewrite:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">                    &#39;/api2&#39;</span><span style="color:#9CDCFE;">:</span><span style="color:#CE9178;"> &#39;&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">                }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>处理ES6</p></li><li><p>处理样式</p><ul><li>loader执行顺序：从后往前</li><li>postcss-loader：浏览器兼容css</li></ul></li><li><p>处理图片</p><ul><li><p>生产模式</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C8C8C8;">module</span><span style="color:#D4D4D4;">: {</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    rules</span><span style="color:#D4D4D4;">: [</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 图片 - 考虑 base64 编码的情况</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            test:</span><span style="color:#D16969;"> /</span><span style="color:#D7BA7D;">\.</span><span style="color:#CE9178;">(</span><span style="color:#D16969;">png</span><span style="color:#DCDCAA;">|</span><span style="color:#D16969;">jpg</span><span style="color:#DCDCAA;">|</span><span style="color:#D16969;">jpeg</span><span style="color:#DCDCAA;">|</span><span style="color:#D16969;">gif</span><span style="color:#CE9178;">)</span><span style="color:#DCDCAA;">$</span><span style="color:#D16969;">/</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            use:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                loader:</span><span style="color:#CE9178;"> &#39;url-loader&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                options:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                    name:</span><span style="color:#CE9178;">&#39;[name]_[hash].[ext]&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">                    // 小于 5kb 的图片用 base64 格式产出</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">                    // 否则，依然延用 file-loader 的形式，产出 url 格式</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                    limit:</span><span style="color:#B5CEA8;"> 5</span><span style="color:#D4D4D4;"> * </span><span style="color:#B5CEA8;">1024</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                    outputPath:</span><span style="color:#CE9178;">&#39;image/&#39;</span><span style="color:#6A9955;">		//打包图片的位置</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">                    </span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">                    // 设置图片的 cdn 地址（也可以统一在外面的 output 中设置，那将作用于所有静态资源）</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">                    // publicPath: &#39;http://cdn.abc.com&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">                }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">},</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>开发模式</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C8C8C8;">module</span><span style="color:#D4D4D4;">: {</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    rules</span><span style="color:#D4D4D4;">: [</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 直接引入图片 url</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            test:</span><span style="color:#D16969;"> /</span><span style="color:#D7BA7D;">\.</span><span style="color:#CE9178;">(</span><span style="color:#D16969;">png</span><span style="color:#DCDCAA;">|</span><span style="color:#D16969;">jpg</span><span style="color:#DCDCAA;">|</span><span style="color:#D16969;">jpeg</span><span style="color:#DCDCAA;">|</span><span style="color:#D16969;">gif</span><span style="color:#CE9178;">)</span><span style="color:#DCDCAA;">$</span><span style="color:#D16969;">/</span><span style="color:#D4D4D4;">,	</span><span style="color:#6A9955;">//打包以png|jpg|jpeg|gif结尾的所有图片文件</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            use:</span><span style="color:#D4D4D4;">{</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                loader:</span><span style="color:#CE9178;">&#39;file-loader&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                options:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                    name:</span><span style="color:#CE9178;">&#39;[name]_[hash].[ext]&#39;</span><span style="color:#D4D4D4;">,</span><span style="color:#6A9955;">//保持原图片的名字+hash值和后缀,主要单引号</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                    outputPath:</span><span style="color:#CE9178;">&#39;image/&#39;</span><span style="color:#6A9955;">//打包图片的位置</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">                }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">},</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li><p>（模块化）</p></li></ul><h3 id="高级配置" tabindex="-1"><a class="header-anchor" href="#高级配置"><span>高级配置</span></a></h3><h4 id="多入口" tabindex="-1"><a class="header-anchor" href="#多入口"><span>多入口</span></a></h4><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C8C8C8;">    entry</span><span style="color:#D4D4D4;">: {</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        index</span><span style="color:#D4D4D4;">: </span><span style="color:#9CDCFE;">path</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">join</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">srcPath</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;index.js&#39;</span><span style="color:#D4D4D4;">),</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        other</span><span style="color:#D4D4D4;">: </span><span style="color:#9CDCFE;">path</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">join</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">srcPath</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;other.js&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">	output</span><span style="color:#D4D4D4;">: {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // filename: &#39;bundle.[contentHash:8].js&#39;,  // 打包代码时，加上 hash 戳</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        filename</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;[name].[contentHash:8].js&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// name 即多入口时 entry 的 key</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        path</span><span style="color:#D4D4D4;">: </span><span style="color:#9CDCFE;">distPath</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // publicPath: &#39;http://cdn.abc.com&#39;  // 修改所有静态文件 url 的前缀（如 cdn 域名），这里暂时用不到</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">	    plugins</span><span style="color:#D4D4D4;">: [</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // new HtmlWebpackPlugin({</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        //     template: path.join(srcPath, &#39;index.html&#39;),</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        //     filename: &#39;index.html&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // })</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 多入口 - 生成 index.html</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        new</span><span style="color:#DCDCAA;"> HtmlWebpackPlugin</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            template:</span><span style="color:#9CDCFE;"> path</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">join</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">srcPath</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;index.html&#39;</span><span style="color:#D4D4D4;">),</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            filename:</span><span style="color:#CE9178;"> &#39;index.html&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">            // chunks 表示该页面要引用哪些 chunk （即上面的 index 和 other），默认全部引用</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            chunks:</span><span style="color:#D4D4D4;"> [</span><span style="color:#CE9178;">&#39;index&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;vendor&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;common&#39;</span><span style="color:#D4D4D4;">]  </span><span style="color:#6A9955;">// 要考虑代码分割</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }),</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 多入口 - 生成 other.html</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        new</span><span style="color:#DCDCAA;"> HtmlWebpackPlugin</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            template:</span><span style="color:#9CDCFE;"> path</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">join</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">srcPath</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;other.html&#39;</span><span style="color:#D4D4D4;">),</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            filename:</span><span style="color:#CE9178;"> &#39;other.html&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            chunks:</span><span style="color:#D4D4D4;"> [</span><span style="color:#CE9178;">&#39;other&#39;</span><span style="color:#D4D4D4;">]  </span><span style="color:#6A9955;">// 只引用 other.js</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        })</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ]</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="抽离压缩css文件" tabindex="-1"><a class="header-anchor" href="#抽离压缩css文件"><span>抽离压缩CSS文件</span></a></h4><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C8C8C8;">    module</span><span style="color:#D4D4D4;">: {</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        rules</span><span style="color:#D4D4D4;">: [</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">            // 抽离 css</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                test:</span><span style="color:#D16969;"> /</span><span style="color:#D7BA7D;">\.</span><span style="color:#D16969;">css</span><span style="color:#DCDCAA;">$</span><span style="color:#D16969;">/</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                loader:</span><span style="color:#D4D4D4;"> [</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                    MiniCssExtractPlugin</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">loader</span><span style="color:#D4D4D4;">,  </span><span style="color:#6A9955;">// 注意，这里不再用 style-loader</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">                    &#39;css-loader&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">                    &#39;postcss-loader&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">                ]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            },</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">            // 抽离 less --&gt; css</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                test:</span><span style="color:#D16969;"> /</span><span style="color:#D7BA7D;">\.</span><span style="color:#D16969;">less</span><span style="color:#DCDCAA;">$</span><span style="color:#D16969;">/</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                loader:</span><span style="color:#D4D4D4;"> [</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                    MiniCssExtractPlugin</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">loader</span><span style="color:#D4D4D4;">,  </span><span style="color:#6A9955;">// 注意，这里不再用 style-loader</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">                    &#39;css-loader&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">                    &#39;less-loader&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">                    &#39;postcss-loader&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">                ]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        ]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    plugins</span><span style="color:#D4D4D4;">: [</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        new</span><span style="color:#DCDCAA;"> CleanWebpackPlugin</span><span style="color:#D4D4D4;">(), </span><span style="color:#6A9955;">// 会默认清空 output.path 文件夹</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        new</span><span style="color:#9CDCFE;"> webpack</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">DefinePlugin</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">            // window.ENV = &#39;production&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            ENV:</span><span style="color:#4FC1FF;"> JSON</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">stringify</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;production&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }),</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 抽离 css 文件</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        new</span><span style="color:#DCDCAA;"> MiniCssExtractPlugin</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            filename:</span><span style="color:#CE9178;"> &#39;css/main.[contentHash:8].css&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        })</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ],</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    optimization</span><span style="color:#D4D4D4;">: {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 压缩 css</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        minimizer</span><span style="color:#D4D4D4;">: [</span><span style="color:#569CD6;">new</span><span style="color:#DCDCAA;"> TerserJSPlugin</span><span style="color:#D4D4D4;">({}), </span><span style="color:#569CD6;">new</span><span style="color:#DCDCAA;"> OptimizeCSSAssetsPlugin</span><span style="color:#D4D4D4;">({})],</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="抽离公共代码" tabindex="-1"><a class="header-anchor" href="#抽离公共代码"><span>抽离公共代码</span></a></h4><p>内置的代码切分的规则：</p><ul><li>新 bundle 被两个及以上模块引用，或者来自 node_modules</li><li>新 bundle 大于 30kb （压缩之前）</li><li>异步加载并发加载的 bundle 数不能大于 5 个</li><li>初始加载的 bundle 数不能大于 3 个</li></ul><p>简单的说，Webpack 会把代码中的公共模块自动抽出来，变成一个包，前提是这个包大于 30kb，不然 Webpack 是不会抽出公共代码的，因为增加一次请求的成本是不能忽视的。</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C8C8C8;">    optimization</span><span style="color:#D4D4D4;">: {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 分割代码块</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        splitChunks</span><span style="color:#D4D4D4;">: {</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">            chunks</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;all&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">            /**</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">             * initial 入口 chunk，对于异步导入的文件不处理</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">                async 异步 chunk，只对异步导入的文件处理</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">                all 全部 chunk</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">             */</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">            // 缓存分组</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">            cacheGroups</span><span style="color:#D4D4D4;">: {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">                // 第三方模块</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">                vendor</span><span style="color:#D4D4D4;">: {</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">                    name</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;vendor&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// chunk 名称</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">                    priority</span><span style="color:#D4D4D4;">: </span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// 权限更高，优先抽离，重要！！！</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">                    test</span><span style="color:#D4D4D4;">:</span><span style="color:#D16969;"> /node_modules/</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">                    minSize</span><span style="color:#D4D4D4;">: </span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">,  </span><span style="color:#6A9955;">// 大小限制</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">                    minChunks</span><span style="color:#D4D4D4;">: </span><span style="color:#B5CEA8;">1</span><span style="color:#6A9955;">  // 最少复用过几次</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">                },</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">                // 公共的模块</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">                common</span><span style="color:#D4D4D4;">: {</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">                    name</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;common&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// chunk 名称</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">                    priority</span><span style="color:#D4D4D4;">: </span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// 优先级</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">                    minSize</span><span style="color:#D4D4D4;">: </span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">,  </span><span style="color:#6A9955;">// 公共模块的大小限制</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">                    minChunks</span><span style="color:#D4D4D4;">: </span><span style="color:#B5CEA8;">2</span><span style="color:#6A9955;">  // 公共模块最少复用过几次</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">                }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="懒加载" tabindex="-1"><a class="header-anchor" href="#懒加载"><span>懒加载</span></a></h4><p>在一个js中异步加载的js，构建打包后生成另外的js</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 引用动态数据 - 懒加载</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">setTimeout</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 回顾vue react异步组件</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 定义一个chunk</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    import</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;./dynamic-data.js&#39;</span><span style="color:#D4D4D4;">).</span><span style="color:#DCDCAA;">then</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">res</span><span style="color:#569CD6;"> =&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">res</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">default</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">message</span><span style="color:#D4D4D4;">);   </span><span style="color:#6A9955;">// 注意这里的default</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    })</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}, </span><span style="color:#B5CEA8;">1500</span><span style="color:#D4D4D4;">)</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="处理jsx" tabindex="-1"><a class="header-anchor" href="#处理jsx"><span>处理JSX</span></a></h4><p>配置.babellrc，babel解析</p><div class="language-text line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-text;"><code><span class="line"><span class="line"><span>{</span></span></span>
<span class="line"><span class="line"><span>    &quot;presets&quot;: [&quot;@babel/preset-react&quot;],</span></span></span>
<span class="line"><span class="line"><span>    &quot;plugins&quot;: []</span></span></span>
<span class="line"><span class="line"><span>}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="处理vue" tabindex="-1"><a class="header-anchor" href="#处理vue"><span>处理Vue</span></a></h4><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C8C8C8;">rules</span><span style="color:#D4D4D4;">: [</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        test:</span><span style="color:#D16969;"> /</span><span style="color:#D7BA7D;">\.</span><span style="color:#D16969;">vue</span><span style="color:#DCDCAA;">$</span><span style="color:#D16969;">/</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        loader:</span><span style="color:#D4D4D4;"> [</span><span style="color:#CE9178;">&#39;vue-loader&#39;</span><span style="color:#D4D4D4;">],</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        include:</span><span style="color:#9CDCFE;"> srcPath</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">]</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="sourcemap" tabindex="-1"><a class="header-anchor" href="#sourcemap"><span>sourceMap</span></a></h4><p><a href="https://juejin.cn/post/6943468761575849992" target="_blank" rel="noopener noreferrer">当面试官问Webpack的时候他想知道什么</a></p><p><code>sourceMap</code>是一项将编译、打包、压缩后的代码映射回源代码的技术，由于打包压缩后的代码并没有阅读性可言，一旦在开发中报错或者遇到问题，直接在混淆代码中<code>debug</code>问题会带来非常糟糕的体验，<code>sourceMap</code>可以帮助我们快速定位到源代码的位置，提高我们的开发效率。<code>sourceMap</code>其实并不是<code>Webpack</code>特有的功能，而是<code>Webpack</code>支持<code>sourceMap</code>，像<code>JQuery</code>也支持<code>souceMap</code>。</p><p>既然是一种源码的映射，那必然就需要有一份映射的文件，来标记混淆代码里对应的源码的位置，通常这份映射文件以<code>.map</code>结尾，里边的数据结构大概长这样：</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#D4D4D4;">{</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">  &quot;version&quot;</span><span style="color:#D4D4D4;"> : </span><span style="color:#B5CEA8;">3</span><span style="color:#D4D4D4;">,                          </span><span style="color:#6A9955;">// Source Map版本</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">  &quot;file&quot;</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&quot;out.js&quot;</span><span style="color:#D4D4D4;">,                       </span><span style="color:#6A9955;">// 输出文件（可选）</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">  &quot;sourceRoot&quot;</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&quot;&quot;</span><span style="color:#D4D4D4;">,                       </span><span style="color:#6A9955;">// 源文件根目录（可选）</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">  &quot;sources&quot;</span><span style="color:#D4D4D4;">: [</span><span style="color:#CE9178;">&quot;foo.js&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&quot;bar.js&quot;</span><span style="color:#D4D4D4;">],        </span><span style="color:#6A9955;">// 源文件列表</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">  &quot;sourcesContent&quot;</span><span style="color:#D4D4D4;">: [</span><span style="color:#569CD6;">null</span><span style="color:#D4D4D4;">, </span><span style="color:#569CD6;">null</span><span style="color:#D4D4D4;">],         </span><span style="color:#6A9955;">// 源内容列表（可选，和源文件列表顺序一致）</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">  &quot;names&quot;</span><span style="color:#D4D4D4;">: [</span><span style="color:#CE9178;">&quot;src&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&quot;maps&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&quot;are&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&quot;fun&quot;</span><span style="color:#D4D4D4;">], </span><span style="color:#6A9955;">// mappings使用的符号名称列表</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">  &quot;mappings&quot;</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&quot;A,AAAB;;ABCDE;&quot;</span><span style="color:#6A9955;">            // 带有编码映射数据的字符串</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其中<code>mappings</code>数据有如下规则：</p><ul><li>生成文件中的一行的每个组用“;”分隔；</li><li>每一段用“,”分隔；</li><li>每个段由1、4或5个可变长度字段组成；</li></ul><p>有了这份映射文件，我们只需要在我们的压缩代码的最末端加上这句注释，即可让sourceMap生效：</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">//# sourceURL=/path/to/file.js.map</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>有了这段注释后，浏览器就会通过<code>sourceURL</code>去获取这份映射文件，通过解释器解析后，实现源码和混淆代码之间的映射。因此sourceMap其实也是一项需要浏览器支持的技术。</p><p>如果我们仔细查看webpack打包出来的bundle文件，就可以发现在默认的<code>development</code>开发模式下，每个<code>_webpack_modules__</code>文件模块的代码最末端，都会加上<code>//# sourceURL=webpack://file-path?</code>，从而实现对sourceMap的支持。</p><h4 id="module-chunk-bundle的区别" tabindex="-1"><a class="header-anchor" href="#module-chunk-bundle的区别"><span>module chunk bundle的区别</span></a></h4><ul><li>module：各个源码文件，webpack中一切皆模块</li><li>chunk：多模块合并成的，如entry import() splitChunk</li><li>bundle：最终的输出文件</li></ul><h3 id="性能优化-1" tabindex="-1"><a class="header-anchor" href="#性能优化-1"><span>性能优化</span></a></h3><h4 id="构建速度" tabindex="-1"><a class="header-anchor" href="#构建速度"><span>构建速度</span></a></h4><ul><li><p>优化babel-loader</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#D4D4D4;">{</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    test</span><span style="color:#D4D4D4;">:</span><span style="color:#D16969;"> /</span><span style="color:#D7BA7D;">\.</span><span style="color:#D16969;">js</span><span style="color:#DCDCAA;">$</span><span style="color:#D16969;">/</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">  	loader</span><span style="color:#D4D4D4;">: [</span><span style="color:#CE9178;">&#39;babel-loader?cacheDirectory&#39;</span><span style="color:#D4D4D4;">],	</span><span style="color:#6A9955;">// 开启缓存</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    include</span><span style="color:#D4D4D4;">: </span><span style="color:#9CDCFE;">path</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">resolve</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">__dirname</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;src&#39;</span><span style="color:#D4D4D4;">),	</span><span style="color:#6A9955;">// 明确范围</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 排除范围，include和exclude两者选一个即可</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // exclude: path.resolve(__dirname, &#39;node_modules&#39;)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>IgnorePlugin 避免引用无用模块（直接不引入，代码中没有）</p><p>以moment.js为例，忽略语言包</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 忽略 moment 下的 /locale 目录</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">new</span><span style="color:#9CDCFE;"> webpack</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">IgnorePlugin</span><span style="color:#D4D4D4;">(</span><span style="color:#D16969;">/</span><span style="color:#D7BA7D;">\.\/</span><span style="color:#D16969;">locale/</span><span style="color:#D4D4D4;">,</span><span style="color:#D16969;"> /moment/</span><span style="color:#D4D4D4;">),</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>noParse避免重复打包（引入，但不打包）</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#4EC9B0;">module</span><span style="color:#D4D4D4;">.</span><span style="color:#4EC9B0;">exports</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    module:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 独完整的 react.min.js 文件就没有采用模块化</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 忽略对 react.min.js 文件的递归解析处理</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        noParse:</span><span style="color:#D4D4D4;"> [</span><span style="color:#D16969;">/react</span><span style="color:#D7BA7D;">\.</span><span style="color:#D16969;">min</span><span style="color:#D7BA7D;">\.</span><span style="color:#D16969;">js</span><span style="color:#DCDCAA;">$</span><span style="color:#D16969;">/</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>happyPack 多进程打包（提高构建速度，特别是多核CPU）</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C8C8C8;">    module</span><span style="color:#D4D4D4;">: {</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        rules</span><span style="color:#D4D4D4;">: [</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">            // js</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                test:</span><span style="color:#D16969;"> /</span><span style="color:#D7BA7D;">\.</span><span style="color:#D16969;">js</span><span style="color:#DCDCAA;">$</span><span style="color:#D16969;">/</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">                // 把对 .js 文件的处理转交给 id 为 babel 的 HappyPack 实例</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                use:</span><span style="color:#D4D4D4;"> [</span><span style="color:#CE9178;">&#39;happypack/loader?id=babel&#39;</span><span style="color:#D4D4D4;">],</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                include:</span><span style="color:#9CDCFE;"> srcPath</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">                // exclude: /node_modules/</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        ]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    plugins</span><span style="color:#D4D4D4;">: [</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // happyPack 开启多进程打包</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        new</span><span style="color:#DCDCAA;"> HappyPack</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">            // 用唯一的标识符 id 来代表当前的 HappyPack 是用来处理一类特定的文件</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            id:</span><span style="color:#CE9178;"> &#39;babel&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">            // 如何处理 .js 文件，用法和 Loader 配置中一样</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            loaders:</span><span style="color:#D4D4D4;"> [</span><span style="color:#CE9178;">&#39;babel-loader?cacheDirectory&#39;</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }),</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ]</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ParallelUglifyPlugin 多进程压缩js</p><ul><li>项目较大，打包较慢，开启多进程能提高速度</li><li>项目较小，打包很快，开启多进程会减低速度（进程开销）</li><li>按需使用</li></ul><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C8C8C8;">plugins</span><span style="color:#D4D4D4;">: [</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 使用 ParallelUglifyPlugin 并行压缩输出的 JS 代码</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    new</span><span style="color:#DCDCAA;"> ParallelUglifyPlugin</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 传递给 UglifyJS 的参数</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // （还是使用 UglifyJS 压缩，只不过帮助开启了多进程）</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        uglifyJS:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            output:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                beautify:</span><span style="color:#569CD6;"> false</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// 最紧凑的输出</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                comments:</span><span style="color:#569CD6;"> false</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// 删除所有的注释</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            },</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            compress:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">                // 删除所有的 `console` 语句，可以兼容ie浏览器</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                drop_console:</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">                // 内嵌定义了但是只用到一次的变量</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                collapse_vars:</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">                // 提取出出现多次但是没有定义成变量去引用的静态值</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                reduce_vars:</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    })</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">]</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>自动刷新</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C8C8C8;">    watch</span><span style="color:#D4D4D4;">: </span><span style="color:#569CD6;">true</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// 开启监听，默认为 false</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    watchOptions</span><span style="color:#D4D4D4;">: {</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        ignored</span><span style="color:#D4D4D4;">:</span><span style="color:#D16969;"> /node_modules/</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// 忽略哪些</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 监听到变化发生后会等300ms再去执行动作，防止文件更新太快导致重新编译频率太高</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 默认为 300ms</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        aggregateTimeout</span><span style="color:#D4D4D4;">: </span><span style="color:#B5CEA8;">300</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 判断文件是否发生变化是通过不停的去询问系统指定文件有没有变化实现的</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 默认每隔1000毫秒询问一次</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        poll</span><span style="color:#D4D4D4;">: </span><span style="color:#B5CEA8;">1000</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>热更新</p><ul><li>自动刷新：整个网页全部刷新，速度较慢，状态会丢失</li><li>热更新：新代码生效，网页不刷新，状态不丢失，但是成本更高</li></ul><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> HotModuleReplacementPlugin</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">require</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;webpack/lib/HotModuleReplacementPlugin&#39;</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    entry</span><span style="color:#D4D4D4;">: {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // index: path.join(srcPath, &#39;index.js&#39;),</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        index</span><span style="color:#D4D4D4;">: [</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">            &#39;webpack-dev-server/client?http://localhost:8080/&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">            &#39;webpack/hot/dev-server&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            path</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">join</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">srcPath</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;index.js&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        ],</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        other</span><span style="color:#D4D4D4;">: </span><span style="color:#9CDCFE;">path</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">join</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">srcPath</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;other.js&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    plugins</span><span style="color:#D4D4D4;">: [</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        new</span><span style="color:#9CDCFE;"> webpack</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">DefinePlugin</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">            // window.ENV = &#39;production&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            ENV:</span><span style="color:#4FC1FF;"> JSON</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">stringify</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;development&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }),</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        new</span><span style="color:#DCDCAA;"> HotModuleReplacementPlugin</span><span style="color:#D4D4D4;">()</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ],</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">	devserver</span><span style="color:#D4D4D4;">: {</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        hot</span><span style="color:#D4D4D4;">: </span><span style="color:#569CD6;">true</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// index.js</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 增加，开启热更新之后的代码逻辑</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">if</span><span style="color:#D4D4D4;"> (</span><span style="color:#4EC9B0;">module</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">hot</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#4EC9B0;">    module</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">hot</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">accept</span><span style="color:#D4D4D4;">([</span><span style="color:#CE9178;">&#39;./math&#39;</span><span style="color:#D4D4D4;">], () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> sumRes</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">sum</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">10</span><span style="color:#D4D4D4;">, </span><span style="color:#B5CEA8;">20</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;sumRes in hot&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">sumRes</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    })</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>DLLPlugin 动态链接库插件</p><p>将依赖单独打包，这样以后每次只构建业务代码</p><p>DllPlugin 配置流程大致分为三步：</p><p>1）创建 dll.config.js 配置文件</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">DllPlugin</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &quot;webpack&quot;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 需要抽离的依赖</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    entry:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        vendor:</span><span style="color:#D4D4D4;"> [</span><span style="color:#CE9178;">&quot;vue&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&quot;vue-router&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&quot;axios&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&quot;echarts&quot;</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    mode:</span><span style="color:#CE9178;"> &quot;production&quot;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    optimization:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        splitChunks:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            cacheGroups:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                vendor:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                    chunks:</span><span style="color:#CE9178;"> &quot;all&quot;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                    name:</span><span style="color:#CE9178;"> &quot;vendor&quot;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">                    test:</span><span style="color:#D16969;"> /node_modules/</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">                }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    output:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        filename:</span><span style="color:#CE9178;"> &quot;[name].dll.js&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// 输出路径和文件名称</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        library:</span><span style="color:#CE9178;"> &quot;[name]&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// 全局变量名称：其他模块会从此变量上获取里面模块</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        path:</span><span style="color:#DCDCAA;"> AbsPath</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;dist/static&quot;</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">// 输出目录路径</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    plugins:</span><span style="color:#D4D4D4;"> [</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        new</span><span style="color:#DCDCAA;"> DllPlugin</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            name:</span><span style="color:#CE9178;"> &quot;[name]&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// 全局变量名称：减小搜索范围，与output.library结合使用</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            path:</span><span style="color:#DCDCAA;"> AbsPath</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;dist/static/[name]-manifest.json&quot;</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">// 输出目录路径</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        })</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">};</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2）package.json 配置脚本</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#CE9178;">&quot;build:dll&quot;</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&quot;webpack --config ./dll.config.js&quot;</span><span style="color:#D4D4D4;">,</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>3）使用 <code>DllReferencePlugin</code> 将打包生成的dll文件，引用到需要的预编译的依赖上来，并通过 <code>html-webpack-tags-plugin</code> 在打包时自动插入dll文件</p><p>vue.config.js 配置如下:</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">DllReferencePlugin</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &quot;webpack&quot;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> HtmlTagsPlugin</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &quot;html-webpack-tags-plugin&quot;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  configureWebpack:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    plugins:</span><span style="color:#D4D4D4;"> [</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">      new</span><span style="color:#DCDCAA;"> DllReferencePlugin</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        manifest:</span><span style="color:#DCDCAA;"> AbsPath</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;dist/static/vendor-manifest.json&quot;</span><span style="color:#D4D4D4;">) </span><span style="color:#6A9955;">// manifest文件路径</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      }),</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">      new</span><span style="color:#DCDCAA;"> HtmlTagsPlugin</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        append:</span><span style="color:#569CD6;"> false</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// 在生成资源后插入</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        publicPath:</span><span style="color:#CE9178;"> &quot;/&quot;</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// 使用公共路径</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        tags:</span><span style="color:#D4D4D4;"> [</span><span style="color:#CE9178;">&quot;static/vendor.dll.js&quot;</span><span style="color:#D4D4D4;">] </span><span style="color:#6A9955;">// 资源路径</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      })</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">};</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p>总结</p><p>用于生产环境</p><ul><li>优化babel-loader</li><li>IgnorePlugin</li><li>noParse</li><li>happyPack</li><li>ParallelUglifyPlugin</li></ul><p>不用于生产环境</p><ul><li>自动刷新</li><li>热更新</li><li>DLLPlugin</li></ul><h4 id="产出代码" tabindex="-1"><a class="header-anchor" href="#产出代码"><span>产出代码</span></a></h4><ul><li><p>小图片base64编码</p></li><li><p>bundle加hash</p></li><li><p>懒加载</p></li><li><p>提取公共代码</p></li><li><p>IgnorePlugin</p></li><li><p>使用CDN加速</p><p>1、publicPath配置cdn网址 <code>publicPath: &#39;http://cdn.abc.com&#39; // 修改所有静态文件 url 的前缀（如 cdn 域名）</code></p><p>2、将打包资源CSS、JS等上传到cdn</p></li><li><p>使用production环境</p><ul><li>自动开启代码压缩</li><li>Vue React等会自动删掉调试代码（如开发环境的warning）</li><li><strong>tree-shaking（清除无用未使用代码）</strong></li></ul></li><li><p>scope hosting 作用域提升</p><ul><li>代码体积更小</li><li>创建函数作用域更少</li><li>代码可读性更好</li></ul></li></ul><p><strong>ES6 Module和Common.js 的区别</strong></p><ul><li>ES6 Module静态引入，编译时引入</li><li>commonjs动态引入，执行时引入</li><li>只有在ES6 Module才能静态分析，实现tree-shaking</li></ul><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// ES6 Module.js</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> apiList</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;../config/api.js&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">isDev</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 编译时报错，只能静态引入</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    import</span><span style="color:#9CDCFE;"> apiList</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;../config/api_dev.js&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// common.js</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">let</span><span style="color:#9CDCFE;"> apiList</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">require</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;../config/api.js&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">isDev</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 可以动态引入，执行时引入</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    apiList</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">require</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;../config/api_dev.js&#39;</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="babel" tabindex="-1"><a class="header-anchor" href="#babel"><span>babel</span></a></h3><h4 id="环境搭建-基本配置" tabindex="-1"><a class="header-anchor" href="#环境搭建-基本配置"><span>环境搭建&amp;基本配置</span></a></h4><h4 id="babel-polyfill" tabindex="-1"><a class="header-anchor" href="#babel-polyfill"><span>babel-polyfill</span></a></h4><ul><li>什么是polyfill ：补丁 兼容语法</li><li>corejs和regenerator</li><li>babel-polyfill是两者的集合</li><li>babel7.4之后弃用babel-polyfill</li><li>推荐直接使用corejs和regenerator</li><li>问题：会污染全局环境</li></ul><h5 id="babel-polyfill-配置按需引入" tabindex="-1"><a class="header-anchor" href="#babel-polyfill-配置按需引入"><span>babel-polyfill 配置按需引入</span></a></h5><div class="language-text line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-text;"><code><span class="line"><span class="line"><span>// .babelrc</span></span></span>
<span class="line"><span class="line"><span>&quot;presets&quot;: [</span></span></span>
<span class="line"><span class="line"><span>        [</span></span></span>
<span class="line"><span class="line"><span>            &quot;@babel/preset-env&quot;,</span></span></span>
<span class="line"><span class="line"><span>            {</span></span></span>
<span class="line"><span class="line"><span>                &quot;useBuiltIns&quot;: &quot;usage&quot;,</span></span></span>
<span class="line"><span class="line"><span>                &quot;corejs&quot;: 3</span></span></span>
<span class="line"><span class="line"><span>            }</span></span></span>
<span class="line"><span class="line"><span>        ]</span></span></span>
<span class="line"><span class="line"><span>    ]</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="babel-runtime" tabindex="-1"><a class="header-anchor" href="#babel-runtime"><span>babel-runtime</span></a></h4><ul><li><p>不会污染全局环境（会重新取变量名）</p></li><li><p>适用于开发第三方库</p></li></ul><h3 id="webpack构建流程概述" tabindex="-1"><a class="header-anchor" href="#webpack构建流程概述"><span>⭐Webpack构建流程概述</span></a></h3><p>1、读取<code>webpack</code>的配置参数；</p><p>2、启动<code>webpack</code>，创建<code>Compiler</code>对象并开始解析项目；</p><p>3、从入口文件（<code>entry</code>）开始解析，并且找到其导入的依赖模块（<code>module</code>），递归遍历分析，形成依赖关系树；</p><p>4、对不同文件类型的依赖模块文件使用对应的<code>Loader</code>进行编译，最终转为<code>Javascript</code>文件；</p><p>5、整个过程中<code>webpack</code>会通过发布订阅模式，向外抛出一些<code>hooks</code>，而<code>webpack</code>的插件（<code>plugin</code>）即可通过监听这些关键的事件节点，执行插件任务进而达到干预输出结果的目的。</p><h3 id="webpack和vite的区别" tabindex="-1"><a class="header-anchor" href="#webpack和vite的区别"><span>webpack和vite的区别</span></a></h3><p><a href="https://zhuanlan.zhihu.com/p/679561937" target="_blank" rel="noopener noreferrer">搞懂vite为什么比webpack快！运行原理、构建方式等有什么不同！</a></p><h3 id="面试真题演练-2" tabindex="-1"><a class="header-anchor" href="#面试真题演练-2"><span>面试真题演练</span></a></h3><h4 id="前端为什么要进行打包构建" tabindex="-1"><a class="header-anchor" href="#前端为什么要进行打包构建"><span>前端为什么要进行打包构建</span></a></h4><ul><li>体积更小（tree-shaking、压缩、合并），加载更快</li><li>编译高级语言或语法（TS、ES5+、模块化、scss）</li><li>兼容性和错误提示（polyfill、postcss、eslint）</li><li>统一高效的开发环境</li><li>统一的构建流程和产出标准</li><li>集成公司构建规范（提测、上线等）</li></ul><h4 id="loader和plugin的区别" tabindex="-1"><a class="header-anchor" href="#loader和plugin的区别"><span>loader和plugin的区别</span></a></h4><ul><li><p>loader模块转换器，如less =&gt; css</p></li><li><p>plugin扩展插件，如HtmlWebpackPlugin</p></li></ul><h4 id="babel和webpack的区别" tabindex="-1"><a class="header-anchor" href="#babel和webpack的区别"><span>babel和webpack的区别</span></a></h4><ul><li>babel：js语法编译工具，不关心模块化</li><li>webpack：打包构建工具，十多个loader plugin的集合</li></ul><h4 id="如何产出一个lib-第三方工具" tabindex="-1"><a class="header-anchor" href="#如何产出一个lib-第三方工具"><span>如何产出一个lib（第三方工具）</span></a></h4><p>参考webpack.dll.js</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C8C8C8;">output</span><span style="color:#D4D4D4;">: {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // lib的文件名</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    filename</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;lodash.js&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 输出lib到dist目录下</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    path</span><span style="color:#D4D4D4;">: </span><span style="color:#9CDCFE;">distPath</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // lib的全局变量名</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    library</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;lodash&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="项目设计" tabindex="-1"><a class="header-anchor" href="#项目设计"><span>项目设计</span></a></h2><h3 id="状态设计" tabindex="-1"><a class="header-anchor" href="#状态设计"><span>状态设计</span></a></h3><ul><li>用数据描述所有的内容</li><li>数据要结构化，易于程序操作（遍历、查找）</li><li>数据要可扩展，以便增加新的功能</li></ul><h3 id="组件设计" tabindex="-1"><a class="header-anchor" href="#组件设计"><span>组件设计</span></a></h3><ul><li>从功能上拆分层次</li><li>尽量让组件原子化</li><li>容器组件（只管理数据）&amp;UI组件（只显示视图）</li></ul><h2 id="项目流程" tabindex="-1"><a class="header-anchor" href="#项目流程"><span>项目流程</span></a></h2><ul><li>PM想在项目开发过程中增加需求，该怎么办 <ul><li>不能拒绝，走需求变更流程即可</li><li>如果公司有规定就按规定走，否则，发起项目组和leader的评审，重新评估排期</li></ul></li><li>项目即将延期了，该怎么办</li><li>你将如何保证项目质量</li></ul><h3 id="项目角色" tabindex="-1"><a class="header-anchor" href="#项目角色"><span>项目角色</span></a></h3><ul><li>PM产品经理</li><li>UE视觉设计师</li><li>FE前端开发</li><li>RD后端开发</li><li>CRD移动端开发</li><li>QA测试人员</li></ul><h3 id="完整项目流程" tabindex="-1"><a class="header-anchor" href="#完整项目流程"><span>完整项目流程</span></a></h3><ul><li>需求分析（各个角色）</li><li>技术方案设计（FE RD CRD）</li><li>开发（FE）</li><li>联调（FE RD CRD）</li><li>测试（FE QA）</li><li>上线（FE）</li></ul></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="vp-meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 980715844@qq.com">csmSimona</span><!----><!--]--><!--]--></span></div></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/csmSimona.github.io/assets/app-C5r9pUv_.js" defer></script>
  </body>
</html>
