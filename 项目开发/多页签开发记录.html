<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.20" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const useChoice = localStorage.getItem('vuepress-color-scheme')
      const systemStatus =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (useChoice === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (useChoice === 'dark' || systemStatus) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <title>多页签开发记录 | myDocs</title><meta name="description" content="我的学习笔记文档">
    <link rel="preload" href="/assets/style-C8RWo3GA.css" as="style"><link rel="stylesheet" href="/assets/style-C8RWo3GA.css">
    <link rel="modulepreload" href="/assets/app-BDe6ZwsC.js"><link rel="modulepreload" href="/assets/多页签开发记录.html-KTfrYYfU.js">
    <link rel="prefetch" href="/assets/index.html-BxZJRLDM.js" as="script"><link rel="prefetch" href="/assets/JavaScript的优缺点.html-DCNGCw_b.js" as="script"><link rel="prefetch" href="/assets/js异步及处理异步的几种方法.html-ut4Ax0Kk.js" as="script"><link rel="prefetch" href="/assets/antv G6的基础入门及树图的实际应用.html-C2cYOZ0w.js" as="script"><link rel="prefetch" href="/assets/使用font-spider压缩字体文件.html-D-VfataG.js" as="script"><link rel="prefetch" href="/assets/Git小记.html-CPEsyZXj.js" as="script"><link rel="prefetch" href="/assets/Linux基本命令.html-CG0m1s3z.js" as="script"><link rel="prefetch" href="/assets/NodeJs小记.html-BT-Viwbz.js" as="script"><link rel="prefetch" href="/assets/PixiJS实现一镜到底.html-BrvWm0QS.js" as="script"><link rel="prefetch" href="/assets/PixiJS的基本使用.html-DIa5qJOd.js" as="script"><link rel="prefetch" href="/assets/TypeScript小记.html-DUWj1U2w.js" as="script"><link rel="prefetch" href="/assets/Vue.js源码全方位深入解析.html-C8kgQ0ej.js" as="script"><link rel="prefetch" href="/assets/正则表达式入门.html-CEtauJbj.js" as="script"><link rel="prefetch" href="/assets/CSS小记.html-CBFleeng.js" as="script"><link rel="prefetch" href="/assets/HTML小记.html-80SaSZAm.js" as="script"><link rel="prefetch" href="/assets/JavaScript小记.html-C6gUB0Wd.js" as="script"><link rel="prefetch" href="/assets/React小记.html-mjiw1VPo.js" as="script"><link rel="prefetch" href="/assets/Typescript面试题.html-BosLte0k.js" as="script"><link rel="prefetch" href="/assets/Vue小记.html-BGQq5u7i.js" as="script"><link rel="prefetch" href="/assets/前端工程化.html-FYwcVLXn.js" as="script"><link rel="prefetch" href="/assets/前端常见面试题.html-DZISE1FM.js" as="script"><link rel="prefetch" href="/assets/前端性能优化.html-BqOVl6IQ.js" as="script"><link rel="prefetch" href="/assets/手写js.html-DWaJ_HKj.js" as="script"><link rel="prefetch" href="/assets/计算机网络.html-Bes9ZfTj.js" as="script"><link rel="prefetch" href="/assets/Canvas入门.html-C4216A5J.js" as="script"><link rel="prefetch" href="/assets/Echarts基本使用.html-BHeVJeNu.js" as="script"><link rel="prefetch" href="/assets/SVG入门.html-DgPzbxTR.js" as="script"><link rel="prefetch" href="/assets/排序.html-BmyQldQX.js" as="script"><link rel="prefetch" href="/assets/算法题.html-C6anr9FX.js" as="script"><link rel="prefetch" href="/assets/Python编程：从入门到实践.html-DM_6yYhI.js" as="script"><link rel="prefetch" href="/assets/中后台管理系统模板记录.html-1tmKfj3q.js" as="script"><link rel="prefetch" href="/assets/低代码数据可视化平台开发记录.html-BV_K7HbA.js" as="script"><link rel="prefetch" href="/assets/Three.js基础课程.html-C2Rs3JsK.js" as="script"><link rel="prefetch" href="/assets/CSS揭秘.html-Cdkb-9CA.js" as="script"><link rel="prefetch" href="/assets/浙政钉、浙里办、浙江政务服务网应用上架指南.html-DyC0RInh.js" as="script"><link rel="prefetch" href="/assets/404.html-0kQpsI1o.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><!----><span class="vp-site-name" aria-hidden="true">myDocs</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="首页"><!--[--><!--[--><!--]--><!--]-->首页<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="前端基础汇总"><span class="title">前端基础汇总</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="前端基础汇总"><span class="title">前端基础汇总</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/JavaScript%E5%B0%8F%E8%AE%B0.html" aria-label="JavaScript小记"><!--[--><!--[--><!--]--><!--]-->JavaScript小记<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/HTML%E5%B0%8F%E8%AE%B0.html" aria-label="HTML小记"><!--[--><!--[--><!--]--><!--]-->HTML小记<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/CSS%E5%B0%8F%E8%AE%B0.html" aria-label="CSS小记"><!--[--><!--[--><!--]--><!--]-->CSS小记<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.html" aria-label="计算机网络"><!--[--><!--[--><!--]--><!--]-->计算机网络<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/React%E5%B0%8F%E8%AE%B0.html" aria-label="React小记"><!--[--><!--[--><!--]--><!--]-->React小记<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/Vue%E5%B0%8F%E8%AE%B0.html" aria-label="Vue小记"><!--[--><!--[--><!--]--><!--]-->Vue小记<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/%E6%89%8B%E5%86%99js.html" aria-label="手写js"><!--[--><!--[--><!--]--><!--]-->手写js<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96.html" aria-label="前端工程化"><!--[--><!--[--><!--]--><!--]-->前端工程化<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html" aria-label="前端性能优化"><!--[--><!--[--><!--]--><!--]-->前端性能优化<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/%E5%89%8D%E7%AB%AF%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98.html" aria-label="前端常见面试题"><!--[--><!--[--><!--]--><!--]-->前端常见面试题<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/Typescript%E9%9D%A2%E8%AF%95%E9%A2%98.html" aria-label="Typescript面试题"><!--[--><!--[--><!--]--><!--]-->Typescript面试题<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="算法"><span class="title">算法</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="算法"><span class="title">算法</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E7%AE%97%E6%B3%95/%E6%8E%92%E5%BA%8F.html" aria-label="排序"><!--[--><!--[--><!--]--><!--]-->排序<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95%E9%A2%98.html" aria-label="算法题"><!--[--><!--[--><!--]--><!--]-->算法题<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="其他"><span class="title">其他</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="其他"><span class="title">其他</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%85%B6%E4%BB%96/Git%E5%B0%8F%E8%AE%B0.html" aria-label="Git小记"><!--[--><!--[--><!--]--><!--]-->Git小记<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%85%B6%E4%BB%96/NodeJs%E5%B0%8F%E8%AE%B0.html" aria-label="NodeJs小记"><!--[--><!--[--><!--]--><!--]-->NodeJs小记<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%85%B6%E4%BB%96/TypeScript%E5%B0%8F%E8%AE%B0.html" aria-label="TypeScript小记"><!--[--><!--[--><!--]--><!--]-->TypeScript小记<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%85%B6%E4%BB%96/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%85%A5%E9%97%A8.html" aria-label="正则表达式入门"><!--[--><!--[--><!--]--><!--]-->正则表达式入门<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%85%B6%E4%BB%96/Linux%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4.html" aria-label="Linux基本命令"><!--[--><!--[--><!--]--><!--]-->Linux基本命令<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%85%B6%E4%BB%96/Vue.js%E6%BA%90%E7%A0%81%E5%85%A8%E6%96%B9%E4%BD%8D%E6%B7%B1%E5%85%A5%E8%A7%A3%E6%9E%90.html" aria-label="Vue.js源码全方位深入解析"><!--[--><!--[--><!--]--><!--]-->Vue.js源码全方位深入解析<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%85%B6%E4%BB%96/PixiJS%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8.html" aria-label="PixiJS的基本使用"><!--[--><!--[--><!--]--><!--]-->PixiJS的基本使用<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%85%B6%E4%BB%96/PixiJS%E5%AE%9E%E7%8E%B0%E4%B8%80%E9%95%9C%E5%88%B0%E5%BA%95.html" aria-label="PixiJS实现一镜到底"><!--[--><!--[--><!--]--><!--]-->PixiJS实现一镜到底<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="数据可视化"><span class="title">数据可视化</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="数据可视化"><span class="title">数据可视化</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/Canvas%E5%85%A5%E9%97%A8.html" aria-label="Canvas入门"><!--[--><!--[--><!--]--><!--]-->Canvas入门<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/SVG%E5%85%A5%E9%97%A8.html" aria-label="SVG入门"><!--[--><!--[--><!--]--><!--]-->SVG入门<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/Echarts%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8.html" aria-label="Echarts基本使用"><!--[--><!--[--><!--]--><!--]-->Echarts基本使用<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/antvG6/antv%20G6%E7%9A%84%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8%E5%8F%8A%E6%A0%91%E5%9B%BE%E7%9A%84%E5%AE%9E%E9%99%85%E5%BA%94%E7%94%A8.html" aria-label="antv G6的基础入门及树图的实际应用"><!--[--><!--[--><!--]--><!--]-->antv G6的基础入门及树图的实际应用<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/Three.js/Three.js%E5%9F%BA%E7%A1%80%E8%AF%BE%E7%A8%8B.html" aria-label="Three.js"><!--[--><!--[--><!--]--><!--]-->Three.js<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="读书笔记"><span class="title">读书笔记</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="读书笔记"><span class="title">读书笔记</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/CSS%E6%8F%AD%E7%A7%98/CSS%E6%8F%AD%E7%A7%98.html" aria-label="《CSS揭秘》"><!--[--><!--[--><!--]--><!--]-->《CSS揭秘》<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/Python%E7%BC%96%E7%A8%8B%EF%BC%9A%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%AE%9E%E8%B7%B5.html" aria-label="《Python编程：从入门到实践》"><!--[--><!--[--><!--]--><!--]-->《Python编程：从入门到实践》<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="项目开发"><span class="title">项目开发</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="项目开发"><span class="title">项目开发</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91/%E4%BD%8E%E4%BB%A3%E7%A0%81%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E5%B9%B3%E5%8F%B0%E5%BC%80%E5%8F%91%E8%AE%B0%E5%BD%95.html" aria-label="低代码数据可视化平台开发记录"><!--[--><!--[--><!--]--><!--]-->低代码数据可视化平台开发记录<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91/%E4%B8%AD%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E6%A8%A1%E6%9D%BF%E8%AE%B0%E5%BD%95.html" aria-label="中后台管理系统模板记录"><!--[--><!--[--><!--]--><!--]-->中后台管理系统模板记录<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91/%E5%A4%9A%E9%A1%B5%E7%AD%BE%E5%BC%80%E5%8F%91%E8%AE%B0%E5%BD%95.html" aria-label="多页签开发记录"><!--[--><!--[--><!--]--><!--]-->多页签开发记录<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/项目开发/浙政钉、浙里办、浙江政务服务网应用上架指南.html" aria-label="浙政钉、浙里办、浙江政务服务网应用上架指南"><!--[--><!--[--><!--]--><!--]-->浙政钉、浙里办、浙江政务服务网应用上架指南<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/csmSimona" aria-label="Github" rel="noopener noreferrer" target="_blank"><!--[--><!--[--><!--]--><!--]-->Github<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="Search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="首页"><!--[--><!--[--><!--]--><!--]-->首页<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="前端基础汇总"><span class="title">前端基础汇总</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="前端基础汇总"><span class="title">前端基础汇总</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/JavaScript%E5%B0%8F%E8%AE%B0.html" aria-label="JavaScript小记"><!--[--><!--[--><!--]--><!--]-->JavaScript小记<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/HTML%E5%B0%8F%E8%AE%B0.html" aria-label="HTML小记"><!--[--><!--[--><!--]--><!--]-->HTML小记<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/CSS%E5%B0%8F%E8%AE%B0.html" aria-label="CSS小记"><!--[--><!--[--><!--]--><!--]-->CSS小记<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.html" aria-label="计算机网络"><!--[--><!--[--><!--]--><!--]-->计算机网络<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/React%E5%B0%8F%E8%AE%B0.html" aria-label="React小记"><!--[--><!--[--><!--]--><!--]-->React小记<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/Vue%E5%B0%8F%E8%AE%B0.html" aria-label="Vue小记"><!--[--><!--[--><!--]--><!--]-->Vue小记<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/%E6%89%8B%E5%86%99js.html" aria-label="手写js"><!--[--><!--[--><!--]--><!--]-->手写js<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96.html" aria-label="前端工程化"><!--[--><!--[--><!--]--><!--]-->前端工程化<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html" aria-label="前端性能优化"><!--[--><!--[--><!--]--><!--]-->前端性能优化<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/%E5%89%8D%E7%AB%AF%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98.html" aria-label="前端常见面试题"><!--[--><!--[--><!--]--><!--]-->前端常见面试题<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/Typescript%E9%9D%A2%E8%AF%95%E9%A2%98.html" aria-label="Typescript面试题"><!--[--><!--[--><!--]--><!--]-->Typescript面试题<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="算法"><span class="title">算法</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="算法"><span class="title">算法</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E7%AE%97%E6%B3%95/%E6%8E%92%E5%BA%8F.html" aria-label="排序"><!--[--><!--[--><!--]--><!--]-->排序<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95%E9%A2%98.html" aria-label="算法题"><!--[--><!--[--><!--]--><!--]-->算法题<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="其他"><span class="title">其他</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="其他"><span class="title">其他</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%85%B6%E4%BB%96/Git%E5%B0%8F%E8%AE%B0.html" aria-label="Git小记"><!--[--><!--[--><!--]--><!--]-->Git小记<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%85%B6%E4%BB%96/NodeJs%E5%B0%8F%E8%AE%B0.html" aria-label="NodeJs小记"><!--[--><!--[--><!--]--><!--]-->NodeJs小记<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%85%B6%E4%BB%96/TypeScript%E5%B0%8F%E8%AE%B0.html" aria-label="TypeScript小记"><!--[--><!--[--><!--]--><!--]-->TypeScript小记<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%85%B6%E4%BB%96/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%85%A5%E9%97%A8.html" aria-label="正则表达式入门"><!--[--><!--[--><!--]--><!--]-->正则表达式入门<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%85%B6%E4%BB%96/Linux%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4.html" aria-label="Linux基本命令"><!--[--><!--[--><!--]--><!--]-->Linux基本命令<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%85%B6%E4%BB%96/Vue.js%E6%BA%90%E7%A0%81%E5%85%A8%E6%96%B9%E4%BD%8D%E6%B7%B1%E5%85%A5%E8%A7%A3%E6%9E%90.html" aria-label="Vue.js源码全方位深入解析"><!--[--><!--[--><!--]--><!--]-->Vue.js源码全方位深入解析<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%85%B6%E4%BB%96/PixiJS%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8.html" aria-label="PixiJS的基本使用"><!--[--><!--[--><!--]--><!--]-->PixiJS的基本使用<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E5%85%B6%E4%BB%96/PixiJS%E5%AE%9E%E7%8E%B0%E4%B8%80%E9%95%9C%E5%88%B0%E5%BA%95.html" aria-label="PixiJS实现一镜到底"><!--[--><!--[--><!--]--><!--]-->PixiJS实现一镜到底<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="数据可视化"><span class="title">数据可视化</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="数据可视化"><span class="title">数据可视化</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/Canvas%E5%85%A5%E9%97%A8.html" aria-label="Canvas入门"><!--[--><!--[--><!--]--><!--]-->Canvas入门<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/SVG%E5%85%A5%E9%97%A8.html" aria-label="SVG入门"><!--[--><!--[--><!--]--><!--]-->SVG入门<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/Echarts%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8.html" aria-label="Echarts基本使用"><!--[--><!--[--><!--]--><!--]-->Echarts基本使用<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/antvG6/antv%20G6%E7%9A%84%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8%E5%8F%8A%E6%A0%91%E5%9B%BE%E7%9A%84%E5%AE%9E%E9%99%85%E5%BA%94%E7%94%A8.html" aria-label="antv G6的基础入门及树图的实际应用"><!--[--><!--[--><!--]--><!--]-->antv G6的基础入门及树图的实际应用<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/Three.js/Three.js%E5%9F%BA%E7%A1%80%E8%AF%BE%E7%A8%8B.html" aria-label="Three.js"><!--[--><!--[--><!--]--><!--]-->Three.js<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="读书笔记"><span class="title">读书笔记</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="读书笔记"><span class="title">读书笔记</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/CSS%E6%8F%AD%E7%A7%98/CSS%E6%8F%AD%E7%A7%98.html" aria-label="《CSS揭秘》"><!--[--><!--[--><!--]--><!--]-->《CSS揭秘》<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/Python%E7%BC%96%E7%A8%8B%EF%BC%9A%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%AE%9E%E8%B7%B5.html" aria-label="《Python编程：从入门到实践》"><!--[--><!--[--><!--]--><!--]-->《Python编程：从入门到实践》<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="项目开发"><span class="title">项目开发</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="项目开发"><span class="title">项目开发</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91/%E4%BD%8E%E4%BB%A3%E7%A0%81%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E5%B9%B3%E5%8F%B0%E5%BC%80%E5%8F%91%E8%AE%B0%E5%BD%95.html" aria-label="低代码数据可视化平台开发记录"><!--[--><!--[--><!--]--><!--]-->低代码数据可视化平台开发记录<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91/%E4%B8%AD%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E6%A8%A1%E6%9D%BF%E8%AE%B0%E5%BD%95.html" aria-label="中后台管理系统模板记录"><!--[--><!--[--><!--]--><!--]-->中后台管理系统模板记录<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91/%E5%A4%9A%E9%A1%B5%E7%AD%BE%E5%BC%80%E5%8F%91%E8%AE%B0%E5%BD%95.html" aria-label="多页签开发记录"><!--[--><!--[--><!--]--><!--]-->多页签开发记录<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/项目开发/浙政钉、浙里办、浙江政务服务网应用上架指南.html" aria-label="浙政钉、浙里办、浙江政务服务网应用上架指南"><!--[--><!--[--><!--]--><!--]-->浙政钉、浙里办、浙江政务服务网应用上架指南<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/csmSimona" aria-label="Github" rel="noopener noreferrer" target="_blank"><!--[--><!--[--><!--]--><!--]-->Github<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">多页签开发记录 <!----></p><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div vp-content><!--[--><!--]--><div><h1 id="多页签开发记录" tabindex="-1"><a class="header-anchor" href="#多页签开发记录"><span>多页签开发记录</span></a></h1><h3 id="功能效果" tabindex="-1"><a class="header-anchor" href="#功能效果"><span>功能效果</span></a></h3><p>1、基本的多页签展示及切换功能</p><p>2、页签切换保留滚动位置与数据</p><p>3、刷新浏览器，页签依旧保留</p><p>4、可配置项（关闭页签/刷新浏览器时的提示、是否可关闭页签、是否打开新页签）</p><p>5、右键菜单（关闭选中标签、关闭右侧标签页、关闭其他标签页）</p><h3 id="使用-开启多页签模式" tabindex="-1"><a class="header-anchor" href="#使用-开启多页签模式"><span>使用（开启多页签模式）</span></a></h3><p>defaultSettings.js 配置</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#D4D4D4;">{</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  ...,</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">  multipleTabs</span><span style="color:#D4D4D4;">: </span><span style="color:#569CD6;">true</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// 开启多页签模式</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>routes.js 配置</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#D4D4D4;">{</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  ...</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  {</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    path</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;/templates/step-form&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    name</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;分步表单&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // group: &#39;应用&#39;,</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    component</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;./Templates/StepForm&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    menuKey</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;step&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    access</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;normalRouteFilter&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 多页签相关配置</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    tabProps</span><span style="color:#D4D4D4;">: {</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">      closeTip</span><span style="color:#D4D4D4;">: </span><span style="color:#569CD6;">true</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// 关闭页签/刷新浏览器时的提示，默认为false</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  ...</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="tabprops-配置" tabindex="-1"><a class="header-anchor" href="#tabprops-配置"><span>tabProps 配置</span></a></h3><table><thead><tr><th>参数</th><th>说明</th><th>默认值</th></tr></thead><tbody><tr><td>closeTip</td><td>关闭页签/刷新浏览器时的提示</td><td>false</td></tr><tr><td>openNew</td><td>页面是否在新页签打开。例：首次登录时需要修改初始密码，则从首页跳转到修改初始密码，而不是打开新页签，需要配置 openNew 为 false。</td><td>true</td></tr><tr><td>closable</td><td>页签是否可关闭</td><td>true</td></tr><tr><td>skipNew</td><td>跳转其他页面时是否打开新页签。例：完成首次登录初始密码修改后，在当前页签跳转到首页，而不是打开新页签，配置 skipNew 为 false。</td><td>true</td></tr></tbody></table><h3 id="开发注意事项" tabindex="-1"><a class="header-anchor" href="#开发注意事项"><span>开发注意事项</span></a></h3><p>1、在同一个页签跳转详情页的路由配置</p><p>当业务需要页面都在同一个页签展示时，注意路由配置需要存在包含关系</p><p>正确示例：/system/role 和 /system/role/add（存在包含关系，页面跳转处于同一页签）</p><p>错误示例：/system/role/list 和 /system/role/add（不存在包含关系，跳转时打开新页签）</p><p>2、二级页返回上一页</p><p>例：从列表页打开详情页后，此时记录的上一页为列表页。此时多次切换页签再回到详情页时，记录的上一页则变成了最后一次切换到详情页前的页面路由，而非列表页，此时返回页面则会出现逻辑错误。</p><p>解决：当需要返回上一页时，将<code>history.go(-1)</code>修改成<code>goBack()</code></p><p>引入及使用：</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">useGoBack</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;@/utils/hooks&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> { </span><span style="color:#4FC1FF;">goBack</span><span style="color:#D4D4D4;"> } = </span><span style="color:#DCDCAA;">useGoBack</span><span style="color:#D4D4D4;">(); </span><span style="color:#6A9955;">// 引入自定义hooks中的返回上一页方法</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">goBack</span><span style="color:#D4D4D4;">(); </span><span style="color:#6A9955;">// 解决因多页签切换导致返回的上一页面不正确的问题</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3、给 PageContainer 中配置了 footer 的页面加配置 <code>footerToolBarProps={{ portalDom: false }} </code></p><p>用于解决打开有 footer 的页面后，切换到其他页签，footer 依然存在的问题</p><p>4、在当前页面自动关闭当前页签</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">useModel</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;@umijs/max&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> { </span><span style="color:#4FC1FF;">closeTab</span><span style="color:#D4D4D4;"> } = </span><span style="color:#DCDCAA;">useModel</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;tabs&#39;</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">closeTab</span><span style="color:#D4D4D4;">(); </span><span style="color:#6A9955;">// 关闭当前页签</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="调研" tabindex="-1"><a class="header-anchor" href="#调研"><span>调研</span></a></h3><p>antd pro v5对于多页签的支持：</p><p>antd pro v5中已内嵌多页签解决方式，但是github issue中官方人员却称官方没有多页签方案（应该是是内置了第三方插件<a href="https://alitajs.com/docs/guides/tabs" target="_blank" rel="noopener noreferrer">alitajs</a>，官方文档没写这个功能），且不推荐</p><p>PS：试了一下开启多页签的方式，一个项目直接卡住了，另一个项目正常，感觉不太稳定，且默认配置下的功能不太符合项目需求（每个页面都单独一个页签，如各种详情页）</p><p>config.js中配置</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// /./ 表示全匹配，也就是全部的路由都保持</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">keepalive</span><span style="color:#D4D4D4;">: [</span><span style="color:#D16969;">/./</span><span style="color:#D4D4D4;">],</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// hasDropdown 表示是否使用默认的右侧功能，关闭左侧，右侧其它等</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">tabsLayout</span><span style="color:#D4D4D4;">: {</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">	hasDropdown</span><span style="color:#D4D4D4;">: </span><span style="color:#569CD6;">true</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>但是我看很多开源的vue后台管理模板中都集成了多页签功能，有时间看看</p><h3 id="具体实现" tabindex="-1"><a class="header-anchor" href="#具体实现"><span>具体实现</span></a></h3><h4 id="核心思路" tabindex="-1"><a class="header-anchor" href="#核心思路"><span>核心思路</span></a></h4><ul><li>React Activation 实现 <code>&lt;KeepAlive /&gt;</code> 组件来包住 children</li><li>找到路由的上下文，构建对每个页面组件的引用</li><li>页签数据的任何变动，更新本地缓存</li></ul><h4 id="_1、在-app-jsx-中的-childrenrender-方法内重写原-children-输出的部分" tabindex="-1"><a class="header-anchor" href="#_1、在-app-jsx-中的-childrenrender-方法内重写原-children-输出的部分"><span>1、在 app.jsx 中的 childrenRender 方法内重写原 <code>{children}</code> 输出的部分</span></a></h4><ul><li><p>通过defaultSettings中的<code>multipleTabs</code>配置，判断是否开启多页签</p></li><li><p>在 layout 配置的 <code>childrenRender</code> 方法内重写原 <code>{children}</code> 输出的部分</p></li><li><p>通过<code>RouteContext.Consumer</code>获取路由的上下文</p></li><li><p>核心逻辑封装在<code>SwitchTabs</code>组件中</p></li></ul><p><strong>app.jsx</strong></p><div class="language-jsx line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="jsx"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-jsx;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> SwitchTabs</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;@/components/SwitchTabs&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#569CD6;"> const</span><span style="color:#DCDCAA;"> layout</span><span style="color:#D4D4D4;"> = ({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  initialState</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">  // setInitialState</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  ...</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  return</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ...</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    childrenRender</span><span style="color:#D4D4D4;">: (</span><span style="color:#9CDCFE;">children</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">      // if (initialState?.loading) return &lt;PageLoading /&gt;;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">      return</span><span style="color:#9CDCFE;"> initialState</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">settings</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">multipleTabs</span><span style="color:#D4D4D4;"> ? (</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#4EC9B0;">RouteContext.Consumer</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">          {</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">ctx</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#808080;"> &lt;</span><span style="color:#4EC9B0;">SwitchTabs</span><span style="color:#9CDCFE;"> menuData</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">ctx</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">menuData</span><span style="color:#569CD6;">}</span><span style="color:#808080;"> /&gt;</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#4EC9B0;">RouteContext.Consumer</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      ) : (</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#4EC9B0;">ConfigProvider</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">          input</span><span style="color:#F44747;">={{ autoComplete: &#39;off&#39;, placeholder: &#39;请输入&#39; }}</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">          select</span><span style="color:#F44747;">={{ allowclear: true, placeholder: &#39;请选择&#39; }}</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">          locale</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">zhCN</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">          {</span><span style="color:#D4D4D4;">...</span><span style="color:#9CDCFE;">props</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">          &lt;</span><span style="color:#4EC9B0;">ErrorBoundary</span><span style="color:#808080;">&gt;</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">children</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#4EC9B0;">ErrorBoundary</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#4EC9B0;">ConfigProvider</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      );</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ...,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  };</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">};</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2、核心-switchtabs组件" tabindex="-1"><a class="header-anchor" href="#_2、核心-switchtabs组件"><span>2、核心：SwitchTabs组件</span></a></h4><h5 id="_1-通过路由上下文内容进行数据处理" tabindex="-1"><a class="header-anchor" href="#_1-通过路由上下文内容进行数据处理"><span>1.通过路由上下文内容进行数据处理</span></a></h5><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> tabTitles</span><span style="color:#D4D4D4;"> = {};   </span><span style="color:#6A9955;">// 各路由对应页签名称map</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> tabContents</span><span style="color:#D4D4D4;"> = {}; </span><span style="color:#6A9955;">// 各路由对应页面内容map</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> allMenuObj</span><span style="color:#D4D4D4;"> = {};  </span><span style="color:#6A9955;">// 所有路由相关信息</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> getTabObj</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useMemoizedFn</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">arr</span><span style="color:#D4D4D4;"> = [], </span><span style="color:#9CDCFE;">parent</span><span style="color:#D4D4D4;"> = {}) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  arr</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">forEach</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    tabContents</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;">] = </span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">element</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    if</span><span style="color:#D4D4D4;"> (!</span><span style="color:#9CDCFE;">tabTitles</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;">]) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      tabTitles</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;">] = </span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">name</span><span style="color:#D4D4D4;"> || </span><span style="color:#9CDCFE;">parent</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">name</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">path</span><span style="color:#D4D4D4;"> &amp;&amp; !</span><span style="color:#9CDCFE;">allMenuObj</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">path</span><span style="color:#D4D4D4;">]) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      allMenuObj</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">path</span><span style="color:#D4D4D4;">] = </span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    if</span><span style="color:#D4D4D4;"> (!</span><span style="color:#DCDCAA;">isEmptyArray</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">children</span><span style="color:#D4D4D4;">)) {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">      getTabObj</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">children</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  });</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">});</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">getTabObj</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">menuData</span><span style="color:#D4D4D4;">);</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_2-使用antd中的tabs组件实现多页签样式" tabindex="-1"><a class="header-anchor" href="#_2-使用antd中的tabs组件实现多页签样式"><span>2.使用antd中的<code>Tabs</code>组件实现多页签样式</span></a></h5><ul><li><p>使用上一步处理产生的<code>tabContents</code>来展示页面内容</p></li><li><p>使用keepalive组件包裹内容进行页面内容缓存（具体在下面第5点说明）</p></li><li><p>onEdit中配置关闭页签前的提示（tabProps配置-closeTip）</p></li></ul><div class="language-jsx line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="jsx"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-jsx;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#4EC9B0;">Tabs</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  type</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;editable-card&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  hideAdd</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  onChange</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">switchTab</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  activeKey</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">activeTab</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  onEdit</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">tabKey</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> currTab</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">getCurrTab</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">tabKey</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">currTab</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">tabProps</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">closeTip</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      Modal</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">confirm</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        title:</span><span style="color:#CE9178;"> &#39;请注意，关闭页签将丢失您当前输入的内容，是否继续？&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        okText:</span><span style="color:#CE9178;"> &#39;确定&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        cancelText:</span><span style="color:#CE9178;"> &#39;取消&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        icon:</span><span style="color:#808080;"> &lt;</span><span style="color:#4EC9B0;">InfoCircleFilled</span><span style="color:#808080;"> /&gt;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        onOk</span><span style="color:#9CDCFE;">:</span><span style="color:#D4D4D4;"> () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">          removeTab</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">tabKey</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      });</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    } </span><span style="color:#C586C0;">else</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">      removeTab</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">tabKey</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  }</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  items</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">tabItems</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ?.</span><span style="color:#DCDCAA;">filter</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#9CDCFE;"> item</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;"> &amp;&amp; </span><span style="color:#9CDCFE;">tabContents</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;">])</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ?.</span><span style="color:#DCDCAA;">map</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> ({</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 自定义右键菜单（具体看第7小点）</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    label:</span><span style="color:#DCDCAA;"> setTab</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">title</span><span style="color:#D4D4D4;"> || </span><span style="color:#CE9178;">&#39;&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;">),</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    key:</span><span style="color:#9CDCFE;"> item</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    closable:</span><span style="color:#9CDCFE;"> tabItems</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">length</span><span style="color:#D4D4D4;"> &gt; </span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;"> &amp;&amp; </span><span style="color:#DCDCAA;">String</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">tabProps</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">closable</span><span style="color:#D4D4D4;">) !== </span><span style="color:#CE9178;">&#39;false&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    children</span><span style="color:#9CDCFE;">:</span><span style="color:#D4D4D4;"> (</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">      &lt;</span><span style="color:#4EC9B0;">ConfigProvider</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        input</span><span style="color:#F44747;">={{ autoComplete: &#39;off&#39;, placeholder: &#39;请输入&#39; }}</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        select</span><span style="color:#F44747;">={{ allowclear: true, placeholder: &#39;请选择&#39; }}</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        locale</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">zhCN</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#4EC9B0;">ErrorBoundary</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">          {</span><span style="color:#9CDCFE;">activeTab</span><span style="color:#D4D4D4;"> === </span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;"> ? (</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#4EC9B0;">KeepAlive</span><span style="color:#9CDCFE;"> name</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">id</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">tabContents</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;">]</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#4EC9B0;">KeepAlive</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">          ) : (</span></span></span>
<span class="line"><span class="line"><span style="color:#CE9178;">            &#39;&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">          )</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#4EC9B0;">ErrorBoundary</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">      &lt;/</span><span style="color:#4EC9B0;">ConfigProvider</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ), </span><span style="color:#6A9955;">// 替换原来直接输出的 children</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  }))</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  tabBarStyle</span><span style="color:#F44747;">={{</span>
<span class="line">    position: &#39;sticky&#39;,</span>
<span class="line">      top: 64,</span>
<span class="line">        zIndex: 99,</span>
<span class="line">          background: &#39;#f3f5fa&#39;,</span>
<span class="line">            padding: &#39;10px 0 0 10px&#39;,</span>
<span class="line">  }}</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  className</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;pageTabs&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">/&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_3-实现tabs的基本交互-切换、删除、激活" tabindex="-1"><a class="header-anchor" href="#_3-实现tabs的基本交互-切换、删除、激活"><span>3.实现tabs的基本交互：切换、删除、激活</span></a></h5><p>通过<code>sessionStorage</code>缓存页签列表信息</p><div class="language-jsx line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="jsx"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-jsx;"><code><span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">activeTab</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setActiveTab</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">();		</span><span style="color:#6A9955;">// 选中页签id</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> oldTab</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">usePrevious</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">activeTab</span><span style="color:#D4D4D4;">);	</span><span style="color:#6A9955;">// 上一个被选中的页签id</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">tabItems</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setTabItems</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">(</span></span></span>
<span class="line"><span class="line"><span style="color:#4FC1FF;">  JSON</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">parse</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">sessionStorage</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">getItem</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">`</span><span style="color:#569CD6;">${</span><span style="color:#4FC1FF;">PROJECT_KEY</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;">-tabPages`</span><span style="color:#D4D4D4;">) || </span><span style="color:#CE9178;">&#39;[]&#39;</span><span style="color:#D4D4D4;">),</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">);  </span><span style="color:#6A9955;">// 打开的页签列表信息</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> oldScrollTop</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useRef</span><span style="color:#D4D4D4;">(); </span><span style="color:#6A9955;">// 历史滚动高度</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 获取当前激活页签的信息</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#DCDCAA;"> getCurrTab</span><span style="color:#D4D4D4;"> = (</span><span style="color:#9CDCFE;">newActiveTab</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#9CDCFE;"> tabItems</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">find</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#9CDCFE;"> item</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;"> === </span><span style="color:#9CDCFE;">newActiveTab</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 切换 Tab</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> switchTab</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useMemoizedFn</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">newActiveTab</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#4FC1FF;"> currTab</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">getCurrTab</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">newActiveTab</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">currTab</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">   	// 切换前记录滚动高度</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    oldScrollTop</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">current</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">document</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">documentElement</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">scrollTop</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    history</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">push</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">currTab</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">pathname</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    setActiveTab</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">newActiveTab</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">});</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 移除 Tab</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> removeTab</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useMemoizedFn</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">tabKey</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  aliveController</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">drop</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">tabKey</span><span style="color:#D4D4D4;">); </span><span style="color:#6A9955;">// 删除对应缓存</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  let</span><span style="color:#9CDCFE;"> newActiveTab</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">activeTab</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  let</span><span style="color:#9CDCFE;"> lastIndex</span><span style="color:#D4D4D4;"> = -</span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  tabItems</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">forEach</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">i</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;"> === </span><span style="color:#9CDCFE;">tabKey</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      lastIndex</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">i</span><span style="color:#D4D4D4;"> - </span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  });</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#4FC1FF;"> newTabItems</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">tabItems</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">filter</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#9CDCFE;"> item</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;"> !== </span><span style="color:#9CDCFE;">tabKey</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  if</span><span style="color:#D4D4D4;"> (!</span><span style="color:#DCDCAA;">isEmptyArray</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">newTabItems</span><span style="color:#D4D4D4;">) &amp;&amp; </span><span style="color:#9CDCFE;">newActiveTab</span><span style="color:#D4D4D4;"> === </span><span style="color:#9CDCFE;">tabKey</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">lastIndex</span><span style="color:#D4D4D4;"> &gt;= </span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      newActiveTab</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">newTabItems</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">lastIndex</span><span style="color:#D4D4D4;">].</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    } </span><span style="color:#C586C0;">else</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      newActiveTab</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">newTabItems</span><span style="color:#D4D4D4;">[</span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">].</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  }</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">  setTabItems</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">newTabItems</span><span style="color:#D4D4D4;">); </span><span style="color:#6A9955;">// 更新页签列表</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">  switchTab</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">newActiveTab</span><span style="color:#D4D4D4;">);	</span><span style="color:#6A9955;">// 更新当前激活页签</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">});</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 激活 Tab</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> activateTab</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useMemoizedFn</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">  // 通过当前路由查询到对应的路由信息</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#4FC1FF;"> pathRouteProps</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">getPathRouteProps</span><span style="color:#D4D4D4;">(</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    location</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">pathname</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    Object</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">keys</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">allMenuObj</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ?.</span><span style="color:#DCDCAA;">map</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#9CDCFE;"> allMenuObj</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">])</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ?.</span><span style="color:#DCDCAA;">filter</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> !</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">path</span><span style="color:#D4D4D4;">?.</span><span style="color:#DCDCAA;">includes</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;*&#39;</span><span style="color:#D4D4D4;">)),</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  );</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#4FC1FF;"> currTab</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">tabItems</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">find</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#9CDCFE;"> item</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;"> === </span><span style="color:#9CDCFE;">pathRouteProps</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">currTab</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    setActiveTab</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">currTab</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">});</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_4-通过监听location-pathname-location-search变化-对页签进行变更操作" tabindex="-1"><a class="header-anchor" href="#_4-通过监听location-pathname-location-search变化-对页签进行变更操作"><span>4.通过监听<code>location.pathname</code>, <code>location.search</code>变化，对页签进行变更操作</span></a></h5><p>通过<code>sessionStorage</code>缓存页签列表信息</p><p>tabProps配置项实现：</p><p>1、skipNew：跳转其他页面时是否打开新页签。</p><p>2、openNew：页面是否在新页签打开。</p><div class="language-jsx line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="jsx"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-jsx;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 监听路由变化，更新页签列表信息，激活页签</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">useEffect</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">location</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">pathname</span><span style="color:#D4D4D4;"> &amp;&amp; </span><span style="color:#9CDCFE;">initialState</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">settings</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">multipleTabs</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> { </span><span style="color:#4FC1FF;">pathname</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">search</span><span style="color:#D4D4D4;"> } = </span><span style="color:#9CDCFE;">location</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">  	// 通过当前路由查询到对应的路由信息</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> pathRouteProps</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">getPathRouteProps</span><span style="color:#D4D4D4;">(</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      location</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">pathname</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      Object</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">keys</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">allMenuObj</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      ?.</span><span style="color:#DCDCAA;">map</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#9CDCFE;"> allMenuObj</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">])</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      ?.</span><span style="color:#DCDCAA;">filter</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> !</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">path</span><span style="color:#D4D4D4;">?.</span><span style="color:#DCDCAA;">includes</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;*&#39;</span><span style="color:#D4D4D4;">)),</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    );</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 刷新前提示（第6小点有细说）</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">pathRouteProps</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">tabProps</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">closeTip</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      window</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">onbeforeunload</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">beforeunload</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    } </span><span style="color:#C586C0;">else</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      window</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">onbeforeunload</span><span style="color:#D4D4D4;"> = </span><span style="color:#569CD6;">null</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // tabItems中的具体信息</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> currTabItem</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      id:</span><span style="color:#9CDCFE;"> pathRouteProps</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      title:</span><span style="color:#9CDCFE;"> tabTitles</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">pathRouteProps</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;">],</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      pathname:</span><span style="color:#9CDCFE;"> pathname</span><span style="color:#D4D4D4;"> + </span><span style="color:#9CDCFE;">search</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      tabProps:</span><span style="color:#9CDCFE;"> pathRouteProps</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">tabProps</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// 相关自定义页签配置</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      scrollTop:</span><span style="color:#B5CEA8;"> 0</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// 对应页签滚动高度</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    };</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> oldTabItems</span><span style="color:#D4D4D4;"> = </span><span style="color:#4FC1FF;">JSON</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">parse</span><span style="color:#D4D4D4;">(</span><span style="color:#4FC1FF;">JSON</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">stringify</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">tabItems</span><span style="color:#D4D4D4;">));</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 防止开启两个首页tab</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">pathname</span><span style="color:#D4D4D4;"> !== </span><span style="color:#CE9178;">&#39;/&#39;</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">      setTabItems</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">prev</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        let</span><span style="color:#9CDCFE;"> next</span><span style="color:#D4D4D4;"> = [...</span><span style="color:#9CDCFE;">prev</span><span style="color:#D4D4D4;">];</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 判断页签列表中是否存在新页签的父/子路由</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> preIndex</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">prev</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">findIndex</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">          const</span><span style="color:#4FC1FF;"> prePathname</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">pathname</span><span style="color:#D4D4D4;">?.</span><span style="color:#DCDCAA;">split</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;?&#39;</span><span style="color:#D4D4D4;">)?.[</span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">];</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">          return</span><span style="color:#D4D4D4;"> (</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            (</span><span style="color:#9CDCFE;">pathname</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">includes</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">prePathname</span><span style="color:#D4D4D4;">) || </span><span style="color:#9CDCFE;">prePathname</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">includes</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">pathname</span><span style="color:#D4D4D4;">)) &amp;&amp;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            prePathname</span><span style="color:#D4D4D4;"> !== </span><span style="color:#9CDCFE;">pathname</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">          );</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        });</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 判断页签列表中是否存在新页签</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> currIndex</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">prev</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">findIndex</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#9CDCFE;"> item</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;"> === </span><span style="color:#9CDCFE;">activeTab</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 获取页签列表中上一个激活的页签</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> lastIndex</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">prev</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">findIndex</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#9CDCFE;"> item</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;"> === </span><span style="color:#9CDCFE;">oldTab</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 若存在历史激活的页签，保存/更新其scrollTop</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">lastIndex</span><span style="color:#D4D4D4;"> !== -</span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">          next</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">lastIndex</span><span style="color:#D4D4D4;">].</span><span style="color:#9CDCFE;">scrollTop</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">oldScrollTop</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">current</span><span style="color:#D4D4D4;"> || </span><span style="color:#9CDCFE;">document</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">documentElement</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">scrollTop</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        // 若新页签已在页签列表，更新scrollTop</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">currIndex</span><span style="color:#D4D4D4;"> !== -</span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">          currTabItem</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">scrollTop</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">next</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">currIndex</span><span style="color:#D4D4D4;">]?.</span><span style="color:#9CDCFE;">scrollTop</span><span style="color:#D4D4D4;"> || </span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        /**</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">           * 更新已有页签信息：</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">           * 1、新页签的父/子路由已在页签列表中</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">           * 2、页签已在页签列表中，且当前页签配置项openNew（是否打开新页签）为false</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">           * 3、上一个激活的页签配置skipNew（跳转其他页面时打开新 tab）为false</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">           */</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        if</span><span style="color:#D4D4D4;"> (</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">          preIndex</span><span style="color:#D4D4D4;"> !== -</span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;"> ||</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">          (</span><span style="color:#9CDCFE;">currIndex</span><span style="color:#D4D4D4;"> !== -</span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;"> &amp;&amp; </span><span style="color:#DCDCAA;">String</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">currTabItem</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">tabProps</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">openNew</span><span style="color:#D4D4D4;">) === </span><span style="color:#CE9178;">&#39;false&#39;</span><span style="color:#D4D4D4;">) ||</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">          String</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">next</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">lastIndex</span><span style="color:#D4D4D4;">]?.</span><span style="color:#9CDCFE;">tabProps</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">skipNew</span><span style="color:#D4D4D4;">) === </span><span style="color:#CE9178;">&#39;false&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        ) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">          const</span><span style="color:#4FC1FF;"> index</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">preIndex</span><span style="color:#D4D4D4;"> !== -</span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;"> ? </span><span style="color:#9CDCFE;">preIndex</span><span style="color:#D4D4D4;"> : </span><span style="color:#9CDCFE;">currIndex</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">          next</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;">] = </span><span style="color:#9CDCFE;">currTabItem</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">          // 清除上个路由的页面缓存</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">          aliveController</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">drop</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">oldTab</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        } </span><span style="color:#C586C0;">else</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">          // 新页签加入页签列表</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">          next</span><span style="color:#D4D4D4;"> = [...</span><span style="color:#9CDCFE;">prev</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">currTabItem</span><span style="color:#D4D4D4;">];</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        return</span><span style="color:#DCDCAA;"> uniqueFunc</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">next</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;id&#39;</span><span style="color:#D4D4D4;">); </span><span style="color:#6A9955;">// 对象数组通过id属性进行去重</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      });</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    } </span><span style="color:#C586C0;">else</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      history</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">push</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;/templates/list&#39;</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> currTab</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">oldTabItems</span><span style="color:#D4D4D4;">?.</span><span style="color:#DCDCAA;">find</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#9CDCFE;"> item</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">pathname</span><span style="color:#D4D4D4;"> === </span><span style="color:#9CDCFE;">currTabItem</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">pathname</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 更新完页签列表信息后激活最新选中的页签</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    setTimeout</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      document</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">documentElement</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">scrollTop</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">currTab</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">scrollTop</span><span style="color:#D4D4D4;"> || </span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">      activateTab</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }, </span><span style="color:#B5CEA8;">200</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}, [</span><span style="color:#9CDCFE;">location</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">pathname</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">location</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">search</span><span style="color:#D4D4D4;">]);</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 任何 Tab 变动，激活正确的 Tab，并更新缓存</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">useEffect</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  if</span><span style="color:#D4D4D4;"> (!</span><span style="color:#DCDCAA;">isEmptyArray</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">tabItems</span><span style="color:#D4D4D4;">)) {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    activateTab</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    sessionStorage</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setItem</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">`</span><span style="color:#569CD6;">${</span><span style="color:#4FC1FF;">PROJECT_KEY</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;">-tabPages`</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">JSON</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">stringify</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">tabItems</span><span style="color:#D4D4D4;">));</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}, [</span><span style="color:#9CDCFE;">tabItems</span><span style="color:#D4D4D4;">]);</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 当前激活页签id更新后，同步数据到model中</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">useEffect</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">  setTabObj</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    removeTab</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    activeTab</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    removePageCache</span><span style="color:#9CDCFE;">:</span><span style="color:#D4D4D4;"> () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#9CDCFE;"> aliveController</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">drop</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">activeTab</span><span style="color:#D4D4D4;">),</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  });</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}, [</span><span style="color:#9CDCFE;">activeTab</span><span style="color:#D4D4D4;">]);</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_5-页签切换保留位置与数据" tabindex="-1"><a class="header-anchor" href="#_5-页签切换保留位置与数据"><span>5.页签切换保留位置与数据</span></a></h5><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> oldScrollTop</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useRef</span><span style="color:#D4D4D4;">(); </span><span style="color:#6A9955;">// 记录上一个页面的滚动高度</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 切换 Tab</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> switchTab</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useMemoizedFn</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">newActiveTab</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#4FC1FF;"> currTab</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">getCurrTab</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">newActiveTab</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">currTab</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 切换页签前记录上个tab页的滚动高度</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    oldScrollTop</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">current</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">document</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">documentElement</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">scrollTop</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    history</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">push</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">currTab</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">pathname</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    setActiveTab</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">newActiveTab</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">});</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 监听路由变化，更新页签列表信息，激活页签</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">useEffect</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">location</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">pathname</span><span style="color:#D4D4D4;"> &amp;&amp; </span><span style="color:#9CDCFE;">initialState</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">settings</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">multipleTabs</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ...</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // tabItems中的具体信息</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> currTabItem</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      id:</span><span style="color:#9CDCFE;"> pathRouteProps</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      title:</span><span style="color:#9CDCFE;"> tabTitles</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">pathRouteProps</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;">],</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      pathname:</span><span style="color:#9CDCFE;"> pathname</span><span style="color:#D4D4D4;"> + </span><span style="color:#9CDCFE;">search</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      tabProps:</span><span style="color:#9CDCFE;"> pathRouteProps</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">tabProps</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// 相关自定义页签配置</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      scrollTop:</span><span style="color:#B5CEA8;"> 0</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// 对应页签滚动高度</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    };</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    </span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ...</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    </span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 若存在历史激活的页签，保存/更新其scrollTop</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">lastIndex</span><span style="color:#D4D4D4;"> !== -</span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      next</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">lastIndex</span><span style="color:#D4D4D4;">].</span><span style="color:#9CDCFE;">scrollTop</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">oldScrollTop</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">current</span><span style="color:#D4D4D4;"> || </span><span style="color:#9CDCFE;">document</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">documentElement</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">scrollTop</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 若新页签已在页签列表，更新scrollTop</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">currIndex</span><span style="color:#D4D4D4;"> !== -</span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      currTabItem</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">scrollTop</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">next</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">currIndex</span><span style="color:#D4D4D4;">]?.</span><span style="color:#9CDCFE;">scrollTop</span><span style="color:#D4D4D4;"> || </span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    </span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    setTimeout</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">      // 激活新页签同时设置新页签的滚动高度</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      document</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">documentElement</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">scrollTop</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">currTab</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">scrollTop</span><span style="color:#D4D4D4;"> || </span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">      activateTab</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }, </span><span style="color:#B5CEA8;">200</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}, [</span><span style="color:#9CDCFE;">location</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">pathname</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">location</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">search</span><span style="color:#D4D4D4;">]);</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_6-配置刷新浏览器前的提示" tabindex="-1"><a class="header-anchor" href="#_6-配置刷新浏览器前的提示"><span>6.配置刷新浏览器前的提示</span></a></h5><p>浏览器窗口关闭或者刷新时触发：<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/beforeunload_event" target="_blank" rel="noopener noreferrer">onbeforeunload事件</a></p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 拦截判断是否离开当前页面</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#DCDCAA;"> beforeunload</span><span style="color:#D4D4D4;"> = (</span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  let</span><span style="color:#9CDCFE;"> confirmationMessage</span><span style="color:#D4D4D4;"> = </span><span style="color:#CE9178;">&#39;请注意，刷新页签将丢失您当前输入的内容，是否继续？&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  (</span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;"> || </span><span style="color:#9CDCFE;">window</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">).</span><span style="color:#9CDCFE;">returnValue</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">confirmationMessage</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  return</span><span style="color:#9CDCFE;"> confirmationMessage</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">};</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 监听路由变化时通过tabProps配置项closeTip判断对应页面是否需要绑定onbeforeunload事件</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">useEffect</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">location</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">pathname</span><span style="color:#D4D4D4;"> &amp;&amp; </span><span style="color:#9CDCFE;">initialState</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">settings</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">multipleTabs</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#D4D4D4;"> { </span><span style="color:#4FC1FF;">pathname</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">search</span><span style="color:#D4D4D4;"> } = </span><span style="color:#9CDCFE;">location</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> pathRouteProps</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">getPathRouteProps</span><span style="color:#D4D4D4;">(</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      location</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">pathname</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      Object</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">keys</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">allMenuObj</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      ?.</span><span style="color:#DCDCAA;">map</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#9CDCFE;"> allMenuObj</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">])</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      ?.</span><span style="color:#DCDCAA;">filter</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> !</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">path</span><span style="color:#D4D4D4;">?.</span><span style="color:#DCDCAA;">includes</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;*&#39;</span><span style="color:#D4D4D4;">)),</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    );</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 刷新前提示</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">pathRouteProps</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">tabProps</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">closeTip</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      window</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">onbeforeunload</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">beforeunload</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    } </span><span style="color:#C586C0;">else</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      window</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">onbeforeunload</span><span style="color:#D4D4D4;"> = </span><span style="color:#569CD6;">null</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}, [</span><span style="color:#9CDCFE;">location</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">pathname</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">location</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">search</span><span style="color:#D4D4D4;">]);</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 销毁时清空事件</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">useEffect</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  return</span><span style="color:#D4D4D4;"> () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    window</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">onbeforeunload</span><span style="color:#D4D4D4;"> = </span><span style="color:#569CD6;">null</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  };</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}, []);</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_7-实现右键菜单功能" tabindex="-1"><a class="header-anchor" href="#_7-实现右键菜单功能"><span>7.实现右键菜单功能</span></a></h5><p>右键菜单功能</p><ul><li>关闭选中标签</li><li>关闭右侧标签页</li><li>关闭其他标签页</li></ul><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 移除 Tab removeTab 在上面第3小点</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 关闭其他tab页</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> removeOtherTabs</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useMemoizedFn</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">tabKey</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#4FC1FF;"> newTabItems</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">tabItems</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">filter</span><span style="color:#D4D4D4;">(</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    (</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#9CDCFE;"> item</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;"> === </span><span style="color:#9CDCFE;">tabKey</span><span style="color:#D4D4D4;"> || </span><span style="color:#DCDCAA;">String</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">tabProps</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">closable</span><span style="color:#D4D4D4;">) === </span><span style="color:#CE9178;">&#39;false&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  );</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">  setTabItems</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">newTabItems</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">  switchTab</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">tabKey</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">});</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 关闭右侧tab页</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> removeRightTabs</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useMemoizedFn</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">tabKey</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#4FC1FF;"> prevTabs</span><span style="color:#D4D4D4;"> = [...</span><span style="color:#9CDCFE;">tabItems</span><span style="color:#D4D4D4;">];</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#4FC1FF;"> findIndex</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">tabItems</span><span style="color:#D4D4D4;">?.</span><span style="color:#DCDCAA;">findIndex</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#9CDCFE;"> item</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;"> === </span><span style="color:#9CDCFE;">tabKey</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#4FC1FF;"> newTabs</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">prevTabs</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">slice</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">findIndex</span><span style="color:#D4D4D4;"> + </span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">  setTabItems</span><span style="color:#D4D4D4;">(</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    newTabs</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">concat</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">prevTabs</span><span style="color:#D4D4D4;">?.</span><span style="color:#DCDCAA;">filter</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#DCDCAA;"> String</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">tabProps</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">closable</span><span style="color:#D4D4D4;">) === </span><span style="color:#CE9178;">&#39;false&#39;</span><span style="color:#D4D4D4;">)),</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  );</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">  switchTab</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">tabKey</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">});</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>自定义右键菜单具体实现</strong></p><p>1、禁用浏览器弹出默认菜单的行为，通过阻止<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Element/contextmenu_event" target="_blank" rel="noopener noreferrer">contextMenu</a>事件的默认行为，并同时触发自定义菜单的显示</p><p>2、通过Dropdown实现菜单样式，触发器<code>trigger</code>配置<code>contextMenu</code>，从而实现鼠标右键触发下拉菜单</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> RIGHT_MENU_CONFIG</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  CURRENT:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    code:</span><span style="color:#CE9178;"> &#39;CURRENT&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    desc:</span><span style="color:#CE9178;"> &#39;关闭标签页&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  },</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  OTHER:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    code:</span><span style="color:#CE9178;"> &#39;OTHER&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    desc:</span><span style="color:#CE9178;"> &#39;关闭其他标签页&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  },</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  RIGHT:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    code:</span><span style="color:#CE9178;"> &#39;RIGHT&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    desc:</span><span style="color:#CE9178;"> &#39;关闭右侧标签页&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">};</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> handleTabsMenuClick</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useMemoizedFn</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">tabKey</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#D4D4D4;"> { </span><span style="color:#4FC1FF;">key</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">domEvent</span><span style="color:#D4D4D4;"> } = </span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  domEvent</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">stopPropagation</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  switch</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    case</span><span style="color:#4FC1FF;"> RIGHT_MENU_CONFIG</span><span style="color:#D4D4D4;">.</span><span style="color:#4FC1FF;">CURRENT</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">code</span><span style="color:#D4D4D4;">:</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">      removeTab</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">tabKey</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">      break</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    case</span><span style="color:#4FC1FF;"> RIGHT_MENU_CONFIG</span><span style="color:#D4D4D4;">.</span><span style="color:#4FC1FF;">OTHER</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">code</span><span style="color:#D4D4D4;">:</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">      removeOtherTabs</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">tabKey</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">      break</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    case</span><span style="color:#4FC1FF;"> RIGHT_MENU_CONFIG</span><span style="color:#D4D4D4;">.</span><span style="color:#4FC1FF;">RIGHT</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">code</span><span style="color:#D4D4D4;">:</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">      removeRightTabs</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">tabKey</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">      break</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">});</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> setMenu</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useMemoizedFn</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">tabKey</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#4FC1FF;"> currTab</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">getCurrTab</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">tabKey</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  return</span><span style="color:#D4D4D4;"> (</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#4EC9B0;">Menu</span><span style="color:#9CDCFE;"> onClick</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#DCDCAA;">handleTabsMenuClick</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">tabKey</span><span style="color:#D4D4D4;">)</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">       &lt;</span><span style="color:#4EC9B0;">Menu.Item</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">          disabled</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">tabItems</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">length</span><span style="color:#D4D4D4;"> === </span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;"> || </span><span style="color:#DCDCAA;">String</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">currTab</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">tabProps</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">closable</span><span style="color:#D4D4D4;">) === </span><span style="color:#CE9178;">&#39;false&#39;</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">          key</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#4FC1FF;">RIGHT_MENU_CONFIG</span><span style="color:#D4D4D4;">.</span><span style="color:#4FC1FF;">CURRENT</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">code</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">				&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">          {</span><span style="color:#4FC1FF;">RIGHT_MENU_CONFIG</span><span style="color:#D4D4D4;">.</span><span style="color:#4FC1FF;">CURRENT</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">desc</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#4EC9B0;">Menu.Item</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#4EC9B0;">Menu.Item</span><span style="color:#9CDCFE;"> disabled</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">tabItems</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">length</span><span style="color:#D4D4D4;"> === </span><span style="color:#B5CEA8;">1</span><span style="color:#569CD6;">}</span><span style="color:#9CDCFE;"> key</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#4FC1FF;">RIGHT_MENU_CONFIG</span><span style="color:#D4D4D4;">.</span><span style="color:#4FC1FF;">OTHER</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">code</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">          {</span><span style="color:#4FC1FF;">RIGHT_MENU_CONFIG</span><span style="color:#D4D4D4;">.</span><span style="color:#4FC1FF;">OTHER</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">desc</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#4EC9B0;">Menu.Item</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#4EC9B0;">Menu.Item</span><span style="color:#9CDCFE;"> disabled</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">tabItems</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">length</span><span style="color:#D4D4D4;"> === </span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;"> + </span><span style="color:#B5CEA8;">1</span><span style="color:#569CD6;">}</span><span style="color:#9CDCFE;"> key</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#4FC1FF;">RIGHT_MENU_CONFIG</span><span style="color:#D4D4D4;">.</span><span style="color:#4FC1FF;">RIGHT</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">code</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">          {</span><span style="color:#4FC1FF;">RIGHT_MENU_CONFIG</span><span style="color:#D4D4D4;">.</span><span style="color:#4FC1FF;">RIGHT</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">desc</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#4EC9B0;">Menu.Item</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#4EC9B0;">Menu</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">	);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">});</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 定义右键菜单组件</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> setTab</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useMemoizedFn</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">tabTitle</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">tabKey</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> (</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">  &lt;</span><span style="color:#569CD6;">span</span><span style="color:#9CDCFE;"> onContextMenu</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#9CDCFE;"> event</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">preventDefault</span><span style="color:#D4D4D4;">()</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">      &lt;</span><span style="color:#4EC9B0;">Dropdown</span><span style="color:#9CDCFE;"> overlay</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#DCDCAA;">setMenu</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">tabKey</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;">)</span><span style="color:#569CD6;">}</span><span style="color:#9CDCFE;"> trigger</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#D4D4D4;">[</span><span style="color:#CE9178;">&#39;contextMenu&#39;</span><span style="color:#D4D4D4;">]</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">span</span><span style="color:#9CDCFE;"> className</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">styles</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">tabTitle</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">tabTitle</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">span</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">      &lt;/</span><span style="color:#4EC9B0;">Dropdown</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">	&lt;/</span><span style="color:#569CD6;">span</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">));</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3、自定义hookusegoback替换history-replace方法" tabindex="-1"><a class="header-anchor" href="#_3、自定义hookusegoback替换history-replace方法"><span>3、自定义hook<code>useGoBack</code>替换<code>history.replace</code>方法</span></a></h4><p><strong>src/utils/hooks.js</strong></p><ul><li><p>通过查询存储浏览器浏览记录，拿到当前页的上一个路由信息并进行存储</p></li><li><p>返回上一页时通过存储的上级路由信息进行返回</p></li><li><p>返回后删除对应记录</p></li></ul><p>解决了因多次切换页签再回到详情页时，返回页面会出现的逻辑错误问题</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">/**</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;"> * 返回上一页</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;"> */</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#569CD6;"> function</span><span style="color:#DCDCAA;"> useGoBack</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#D4D4D4;"> { </span><span style="color:#4FC1FF;">location</span><span style="color:#D4D4D4;"> } = </span><span style="color:#DCDCAA;">usePageProps</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">lastPathObj</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setLastPathObj</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">(</span></span></span>
<span class="line"><span class="line"><span style="color:#4FC1FF;">    JSON</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">parse</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">sessionStorage</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">getItem</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">`</span><span style="color:#569CD6;">${</span><span style="color:#4FC1FF;">PROJECT_KEY</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;">-lastPathMap`</span><span style="color:#D4D4D4;">)) || {},</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  );</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#4FC1FF;"> routeHistory</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">localStorage</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">getItem</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">`</span><span style="color:#569CD6;">${</span><span style="color:#9CDCFE;">window</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">projectKey</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;">-route-history`</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">  useMount</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> routePathArr</span><span style="color:#D4D4D4;"> =</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      routeHistory</span><span style="color:#D4D4D4;"> &amp;&amp; </span><span style="color:#4FC1FF;">JSON</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">parse</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">routeHistory</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">instanceof</span><span style="color:#4EC9B0;"> Array</span><span style="color:#D4D4D4;"> ? </span><span style="color:#4FC1FF;">JSON</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">parse</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">routeHistory</span><span style="color:#D4D4D4;">) : [];</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> newLastPathObj</span><span style="color:#D4D4D4;"> = { ...</span><span style="color:#9CDCFE;">lastPathObj</span><span style="color:#D4D4D4;"> };</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    if</span><span style="color:#D4D4D4;"> (!</span><span style="color:#9CDCFE;">newLastPathObj</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">location</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">pathname</span><span style="color:#D4D4D4;">] &amp;&amp; </span><span style="color:#9CDCFE;">routePathArr</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">length</span><span style="color:#D4D4D4;"> !== </span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      newLastPathObj</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">location</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">pathname</span><span style="color:#D4D4D4;">] = </span><span style="color:#9CDCFE;">routePathArr</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">routePathArr</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">length</span><span style="color:#D4D4D4;"> - </span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">];</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    setLastPathObj</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">newLastPathObj</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    sessionStorage</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setItem</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">`</span><span style="color:#569CD6;">${</span><span style="color:#4FC1FF;">PROJECT_KEY</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;">-lastPathMap`</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">JSON</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">stringify</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">newLastPathObj</span><span style="color:#D4D4D4;">));</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  });</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  return</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    goBack</span><span style="color:#9CDCFE;">:</span><span style="color:#D4D4D4;"> () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">      if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">lastPathObj</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">location</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">pathname</span><span style="color:#D4D4D4;">]) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        history</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">replace</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">lastPathObj</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">location</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">pathname</span><span style="color:#D4D4D4;">]);</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> newLastPathObj</span><span style="color:#D4D4D4;"> = { ...</span><span style="color:#9CDCFE;">lastPathObj</span><span style="color:#D4D4D4;"> };</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        delete</span><span style="color:#9CDCFE;"> newLastPathObj</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">location</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">pathname</span><span style="color:#D4D4D4;">];</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        sessionStorage</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">setItem</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">`</span><span style="color:#569CD6;">${</span><span style="color:#4FC1FF;">PROJECT_KEY</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;">-lastPathMap`</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">JSON</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">stringify</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">newLastPathObj</span><span style="color:#D4D4D4;">));</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      } </span><span style="color:#C586C0;">else</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        history</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">go</span><span style="color:#D4D4D4;">(-</span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  };</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4、src-models-tabs-js" tabindex="-1"><a class="header-anchor" href="#_4、src-models-tabs-js"><span>4、src/models/tabs.js</span></a></h4><p>暴露出SwitchTabs中的关闭页签和移除当前页签缓存的方法</p><p>用于在组件中关闭当前页签的操作</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">useState</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#D4D4D4;"> () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">tabObj</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">setTabObj</span><span style="color:#D4D4D4;">] = </span><span style="color:#DCDCAA;">useState</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#DCDCAA;"> closeTab</span><span style="color:#D4D4D4;"> = () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#9CDCFE;"> tabObj</span><span style="color:#D4D4D4;">?.</span><span style="color:#DCDCAA;">removeTab</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">tabObj</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">activeTab</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#DCDCAA;"> removePageCache</span><span style="color:#D4D4D4;"> = () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#9CDCFE;"> tabObj</span><span style="color:#D4D4D4;">?.</span><span style="color:#DCDCAA;">removePageCache</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  return</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    tabObj</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    setTabObj</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    closeTab</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    removePageCache</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  };</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">};</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5、使用keepalive插件实现页面缓存" tabindex="-1"><a class="header-anchor" href="#_5、使用keepalive插件实现页面缓存"><span>5、使用KeepAlive插件实现页面缓存</span></a></h4><p><a href="https://blog.csdn.net/weixin_62192841/article/details/130684240" target="_blank" rel="noopener noreferrer">umi4用KeepAlive插件实现页面缓存</a></p><p><strong>使用react-activation的keepalive包裹元素进行页面缓存，关闭页签或在同一页签路由跳转时清除对应的缓存</strong></p><p><strong>安装keepalive插件</strong></p><div class="language-bash line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-bash;"><code><span class="line"><span class="line"><span style="color:#DCDCAA;">npm</span><span style="color:#CE9178;"> i</span><span style="color:#CE9178;"> react-activation</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>config.js</strong></p><div class="language-bash line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-bash;"><code><span class="line"><span class="line"><span style="color:#DCDCAA;">npm</span><span style="color:#CE9178;"> i</span><span style="color:#CE9178;"> umi-plugin-keep-alive</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> defaultSettings</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;./defaultSettings&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">...</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#DCDCAA;"> defineConfig</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  ...</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">  // keep-alive插件</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  plugins</span><span style="color:#D4D4D4;">: [</span><span style="color:#CE9178;">&#39;umi-plugin-keep-alive&#39;</span><span style="color:#D4D4D4;">],</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">});</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>SwitchTabs</strong></p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> KeepAlive</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">useAliveController</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react-activation&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// KeepAlive包裹内容</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#4EC9B0;">KeepAlive</span><span style="color:#9CDCFE;"> name</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">id</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">tabContents</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;">]</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&lt;/</span><span style="color:#4EC9B0;">KeepAlive</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 更新或移除tab时删除对应缓存</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> aliveController</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useAliveController</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">aliveController</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">drop</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">tabKey</span><span style="color:#D4D4D4;">); </span><span style="color:#6A9955;">// 删除对应缓存</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6、登录、退出登录前清空页面缓存" tabindex="-1"><a class="header-anchor" href="#_6、登录、退出登录前清空页面缓存"><span>6、登录、退出登录前清空页面缓存</span></a></h4><p><strong>config/config.js</strong></p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">defineConfig</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;@umijs/max&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#DCDCAA;"> defineConfig</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  ...</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  define</span><span style="color:#D4D4D4;">: {</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ...</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 定义常量</span></span></span>
<span class="line"><span class="line"><span style="color:#4FC1FF;">    MULTIPLE_TABS</span><span style="color:#D4D4D4;">: </span><span style="color:#9CDCFE;">defaultSettings</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">multipleTabs</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">});</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>登录、退出登录</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">useAliveController</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;react-activation&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> aliveController</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useAliveController</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 登录前/退出登录前</span></span></span>
<span class="line"><span class="line"><span style="color:#4FC1FF;">MULTIPLE_TABS</span><span style="color:#D4D4D4;"> &amp;&amp; </span><span style="color:#9CDCFE;">aliveController</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">clear</span><span style="color:#D4D4D4;">(); </span><span style="color:#6A9955;">// 多页签模式-清空页面缓存</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="开发中遇到的问题记录" tabindex="-1"><a class="header-anchor" href="#开发中遇到的问题记录"><span>开发中遇到的问题记录</span></a></h3><p>1、单个菜单中 有多个可跳转页面时，会出现两个tab，如/news和/news/list</p><p>已解决：通过includes判断当前页和历史tab的关系，并进行替换</p><p>2、例：从列表页打开详情页后，此时记录的上一页为列表页。此时多次切换页签再回到详情页时，记录的上一页则变成了最后一次切换到详情页前的页面路由，而非列表页，此时返回页面则会出现逻辑错误。</p><p>已解决：</p><p>1.使用 localStorage.getItem(<code>${window.projectKey}-route-history</code>) 获取进入详情页时的上个页面路由并记录；</p><p>2.在sessionStorage中存储首次进入详情页时的上个页面，在需要返回上一页时使用该记录中的路由记录进行返回，返回后清除该记录（已封装hook：useGoBack）</p><p>3、打开有footer的页面时，切换其他页面，footer依然存在</p><p>已解决：给有footer配置的<code>pageContainer</code>里加配置 <code>footerToolBarProps={{ portalDom: false }}</code></p><p>4、列表页点击查看详情页时，会打开新tab页</p><p>已解决：routes.js需要修改配置：列表和详情页命名需要有包含关系</p><p>5、多页签在监听路由id变化时，会先用上一个页面的路由id进行请求，然后才会去请求当前页面的那个路由id，于是会出现接口请求报错的问题</p><p>解决方法1：在监听id变化时，同时判断当前路由</p><p>解决方法2：多页签修改逻辑</p><p><strong>使用react-activation的keepalive包裹元素进行页面缓存，关闭页签或在同一页签路由跳转时清除对应的缓存</strong></p><p>6、从二级页返回列表页时，列表页不会更新</p><p>SwitchTabs组件中逻辑优化：父子路由跳转前，清除当前页的缓存</p></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">最近更新：: </span><time class="meta-item-info" datetime="2024-09-18T17:31:11.000Z" data-allow-mismatch>2024/9/18 17:31</time></div><div class="vp-meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 980715844@qq.com">csmSimona</span><!----><!--]--><!--]--></span></div></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-BDe6ZwsC.js" defer></script>
  </body>
</html>
