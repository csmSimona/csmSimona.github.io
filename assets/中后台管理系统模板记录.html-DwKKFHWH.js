import{_ as n,c as a,a as l,o as e}from"./app-vspO_wyY.js";const p={};function i(c,s){return e(),a("div",null,s[0]||(s[0]=[l(`<h1 id="控制台模板" tabindex="-1"><a class="header-anchor" href="#控制台模板"><span>控制台模板</span></a></h1><h2 id="技术栈" tabindex="-1"><a class="header-anchor" href="#技术栈"><span>技术栈</span></a></h2><ul><li>react 17</li><li><a href="https://umijs.org/docs/tutorials/getting-started" target="_blank" rel="noopener noreferrer">umi4</a></li><li><a href="https://pro.ant.design" target="_blank" rel="noopener noreferrer">Ant Design Pro V5</a></li><li>antd 4.23.3</li><li>node 14 及以上</li></ul><h2 id="安装" tabindex="-1"><a class="header-anchor" href="#安装"><span>安装</span></a></h2><div class="language-bash line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-bash;"><code><span class="line"><span class="line"><span style="color:#DCDCAA;">npm</span><span style="color:#CE9178;"> install</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="运行" tabindex="-1"><a class="header-anchor" href="#运行"><span>运行</span></a></h2><div class="language-bash line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-bash;"><code><span class="line"><span class="line"><span style="color:#DCDCAA;">npm</span><span style="color:#CE9178;"> start</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="打包" tabindex="-1"><a class="header-anchor" href="#打包"><span>打包</span></a></h2><div class="language-bash line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-bash;"><code><span class="line"><span class="line"><span style="color:#DCDCAA;">npm</span><span style="color:#CE9178;"> run</span><span style="color:#CE9178;"> build</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="项目架构" tabindex="-1"><a class="header-anchor" href="#项目架构"><span>项目架构</span></a></h2><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#D4D4D4;">├── </span><span style="color:#9CDCFE;">config</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">配置文件</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">│   ├── </span><span style="color:#9CDCFE;">config</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">js</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">配置文件</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">│   ├── </span><span style="color:#9CDCFE;">defaultSettings</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">js</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">antd</span><span style="color:#9CDCFE;"> 全局配置</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">│   ├── </span><span style="color:#9CDCFE;">proxy</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">js</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">代理配置</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">│   ├── </span><span style="color:#9CDCFE;">routes</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">js</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">菜单路由</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">│   └── </span><span style="color:#9CDCFE;">routeHistory</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">js</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">路由监听方法</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">├── </span><span style="color:#9CDCFE;">mock</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">mock</span><span style="color:#9CDCFE;"> 数据</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">├── </span><span style="color:#9CDCFE;">public</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">公共资源</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">├── </span><span style="color:#9CDCFE;">src</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">主入口</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">│   ├── </span><span style="color:#9CDCFE;">assets</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">静态资源</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">│   ├── </span><span style="color:#9CDCFE;">common</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">公共配置</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">│   │   ├── </span><span style="color:#9CDCFE;">enum</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">js</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">枚举</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">│   │   ├── </span><span style="color:#9CDCFE;">pattern</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">js</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">正则</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">│   │   └── </span><span style="color:#9CDCFE;">project</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">js</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">业务方法</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">│   ├── </span><span style="color:#9CDCFE;">components</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">公共组件</span><span style="color:#D4D4D4;">]（</span><span style="color:#9CDCFE;">下方有详细说明</span><span style="color:#D4D4D4;">）</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">│   ├── </span><span style="color:#9CDCFE;">locales</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">语言设置</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">│   ├── </span><span style="color:#9CDCFE;">models</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">数据管理</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">│   ├── </span><span style="color:#9CDCFE;">pages</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">页面路由</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">│   ├── </span><span style="color:#9CDCFE;">services</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">api</span><span style="color:#9CDCFE;"> 服务</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">│   └── </span><span style="color:#9CDCFE;">utils</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">工具包</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">│       ├── </span><span style="color:#9CDCFE;">fileRequest</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">js</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">文件请求方法封装</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">│       ├── </span><span style="color:#9CDCFE;">form</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">js</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">表单处理</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">│       ├── </span><span style="color:#9CDCFE;">format</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">js</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">数据格式化</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">│       ├── </span><span style="color:#9CDCFE;">hooks</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">js</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">自定义</span><span style="color:#9CDCFE;"> hook</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">│       ├── </span><span style="color:#9CDCFE;">menu</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">js</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">菜单权限相关配置</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">│       ├── </span><span style="color:#9CDCFE;">mgop</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">js</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">irs请求方法封装</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">│       ├── </span><span style="color:#9CDCFE;">query</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">js</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">地址参数出处理</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">│       ├── </span><span style="color:#9CDCFE;">request</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">js</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">请求相关配置</span><span style="color:#D4D4D4;">（</span><span style="color:#9CDCFE;">浙里办</span><span style="color:#D4D4D4;">）]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">│       └── </span><span style="color:#9CDCFE;">utils</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">js</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">工具方法</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">├── </span><span style="color:#9CDCFE;">access</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">js</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">权限管理</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">├── </span><span style="color:#9CDCFE;">app</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">jsx</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">页面初始化</span><span style="color:#D4D4D4;">，</span><span style="color:#9CDCFE;">错误处理封装</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">├── </span><span style="color:#9CDCFE;">global</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">jsx</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">全局</span><span style="color:#9CDCFE;"> js</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">├── </span><span style="color:#9CDCFE;">global</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">less</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">全局样式</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">└── </span><span style="color:#9CDCFE;">requestErrorConfig</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">js</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">数据请求拦截配置</span><span style="color:#D4D4D4;">]</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="注意" tabindex="-1"><a class="header-anchor" href="#注意"><span>注意</span></a></h2><p>1、云端 mock 接口文档：https://16vg5t77t6.apifox.cn/api-187779436</p><p>2、获取用户信息等一些<a href="https://pro.ant.design/zh-CN/docs/initial-state" target="_blank" rel="noopener noreferrer">全局依赖的基础数据</a>放在<a href="https://pro.ant.design/zh-CN/docs/upgrade-v5#initialstate" target="_blank" rel="noopener noreferrer">initialState 全局初始化数据</a>中，初始化于<code>app.jsx</code>中的 <code>getInitialState</code></p><p>3、<a href="https://pro.ant.design/zh-CN/docs/layout#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B8%83%E5%B1%80" target="_blank" rel="noopener noreferrer">Layout</a></p><ul><li><p>配置位于<code>app.jsx</code></p></li><li><p>单个页面不需要 layout 时，可在<code>config.js</code>中配置<code>layout:false</code></p></li><li><p>也可以使用 v4 方法，在 layout 文件夹中自定义 layout</p></li></ul><p>4、引入第三方 script</p><p>由于新版本移除了 document.ejs, 因此当需要引入第三方 js 时，需要在<code>config.js</code>中进行配置<a href="https://umijs.org/docs/api/config#headscripts" target="_blank" rel="noopener noreferrer">headScripts</a>相关内容。</p><p>同理，配置 <code>&lt;body&gt;</code> 中额外的 script 标签，使用<a href="https://umijs.org/docs/api/config#scripts" target="_blank" rel="noopener noreferrer">script</a></p><p>5、umi4 中 props 默认为空对象，若要获取一下属性，可使用<code>usePageProps</code></p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// utils/hooks.js</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">/**</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;"> * 获得页面参数</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;"> * </span><span style="color:#569CD6;">@returns</span><span style="color:#4EC9B0;"> {Object}</span><span style="color:#6A9955;"> { location, access, params, route, queryParams, history }</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;"> */</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#569CD6;"> function</span><span style="color:#DCDCAA;"> usePageProps</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#4FC1FF;"> location</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useLocation</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#4FC1FF;"> access</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useAccess</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#4FC1FF;"> params</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useParams</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#D4D4D4;"> { </span><span style="color:#4FC1FF;">route</span><span style="color:#D4D4D4;"> } = </span><span style="color:#DCDCAA;">useRouteData</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#4FC1FF;"> queryParams</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">getPageQuery</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  return</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    location</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    access</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    params</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    route</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    queryParams</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    history</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  };</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="components-通用组件库" tabindex="-1"><a class="header-anchor" href="#components-通用组件库"><span>components 通用组件库</span></a></h2><table><thead><tr><th style="text-align:center;">目录</th><th style="text-align:center;">说明</th></tr></thead><tbody><tr><td style="text-align:center;">ApplyItem</td><td style="text-align:center;">用于渲染表单项</td></tr><tr><td style="text-align:center;">BaseBreadcrumb</td><td style="text-align:center;">面包屑</td></tr><tr><td style="text-align:center;">BaseCascader</td><td style="text-align:center;">级联选择器</td></tr><tr><td style="text-align:center;">BaseDatePicker</td><td style="text-align:center;">时间组件(区间已经格式化为时间戳)</td></tr><tr><td style="text-align:center;">BaseDebounceSelect</td><td style="text-align:center;">防抖选择器</td></tr><tr><td style="text-align:center;">BasePopconfirm</td><td style="text-align:center;">气泡确认框组件</td></tr><tr><td style="text-align:center;">BasePwd</td><td style="text-align:center;">修改密码表单</td></tr><tr><td style="text-align:center;">Captcha</td><td style="text-align:center;">验证码</td></tr><tr><td style="text-align:center;">EmailSearch</td><td style="text-align:center;">邮件输入提示框</td></tr><tr><td style="text-align:center;">FileUpload</td><td style="text-align:center;"><a href="https://stackblitz.com/edit/react-pyqqmq?file=README.md" target="_blank" rel="noopener noreferrer">自定义上传组件</a></td></tr><tr><td style="text-align:center;">FormItemGroup</td><td style="text-align:center;">带栅格的表单组，类似 ProForm.Group 功能</td></tr><tr><td style="text-align:center;">MenuTree</td><td style="text-align:center;">菜单权限配置组件</td></tr><tr><td style="text-align:center;">Notice</td><td style="text-align:center;">消息通知组件</td></tr><tr><td style="text-align:center;">QuillEditer</td><td style="text-align:center;">富文本编辑器</td></tr><tr><td style="text-align:center;">TreeMap</td><td style="text-align:center;">树级线性结构组件</td></tr><tr><td style="text-align:center;">BaseStepsForm</td><td style="text-align:center;">分布表单组件</td></tr><tr><td style="text-align:center;">BaseEditableTable</td><td style="text-align:center;">可编辑表格</td></tr><tr><td style="text-align:center;">MapModal</td><td style="text-align:center;">通过地址获取经纬度弹窗</td></tr><tr><td style="text-align:center;">BaseTextCollapse</td><td style="text-align:center;">n 行文本溢出展开收起组件</td></tr><tr><td style="text-align:center;">BaseCustomIcon</td><td style="text-align:center;">自定义 icon 展示，通过 background 修改颜色</td></tr></tbody></table><h2 id="一、权限管理" tabindex="-1"><a class="header-anchor" href="#一、权限管理"><span><a href="https://pro.ant.design/zh-CN/docs/authority-management" target="_blank" rel="noopener noreferrer">一、权限管理</a></span></a></h2><h3 id="_1-1-固定角色的不同菜单" tabindex="-1"><a class="header-anchor" href="#_1-1-固定角色的不同菜单"><span>1.1 固定角色的不同菜单</span></a></h3><p>在<code>src/access.js</code>和<code>config/route.js</code>中配置对应的角色菜单权限，如下所述</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// src/access.js</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#569CD6;"> function</span><span style="color:#DCDCAA;"> access</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">initialState</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#D4D4D4;"> { </span><span style="color:#4FC1FF;">currentUser</span><span style="color:#D4D4D4;"> } = </span><span style="color:#9CDCFE;">initialState</span><span style="color:#D4D4D4;"> || {};</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  return</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    canAdmin:</span><span style="color:#9CDCFE;"> currentUser</span><span style="color:#D4D4D4;"> &amp;&amp; </span><span style="color:#9CDCFE;">currentUser</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">role</span><span style="color:#D4D4D4;"> === </span><span style="color:#CE9178;">&#39;admin&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  };</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// config/route.js</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#D4D4D4;"> [</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    path:</span><span style="color:#CE9178;"> &#39;/welcome&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    component:</span><span style="color:#CE9178;"> &#39;./Welcome&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    name:</span><span style="color:#CE9178;"> &#39;welcome&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    access:</span><span style="color:#CE9178;"> &#39;canAdmin&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">];</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-2-动态菜单" tabindex="-1"><a class="header-anchor" href="#_1-2-动态菜单"><span>1.2 动态菜单</span></a></h3><p>更多配置可看：<a href="https://pro.ant.design/zh-CN/docs/advanced-menu" target="_blank" rel="noopener noreferrer">入口</a></p><p>关于菜单高亮，可以使用 parentKeys 属性，当前推荐还是有父子关系，包在 routes 里</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// config/route.js</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#D4D4D4;"> [</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    path:</span><span style="color:#CE9178;"> &#39;/product&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    hideInMenu:</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    name:</span><span style="color:#CE9178;"> &#39;产品管理&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    path:</span><span style="color:#CE9178;"> &#39;/list/:id&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    hideInMenu:</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    name:</span><span style="color:#CE9178;"> &#39;列表详情&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    parentKeys:</span><span style="color:#D4D4D4;"> [</span><span style="color:#CE9178;">&#39;/product&#39;</span><span style="color:#D4D4D4;">],</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">];</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>routes 可配置项</p></blockquote><div class="language-typescript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-typescript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#569CD6;"> interface</span><span style="color:#4EC9B0;"> Setting</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">  /**</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">   * </span><span style="color:#569CD6;">@name</span><span style="color:#4EC9B0;"> false</span><span style="color:#6A9955;"> 时不展示顶栏</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">   */</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  headerRender</span><span style="color:#D4D4D4;">?: </span><span style="color:#4EC9B0;">false</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">  /**</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">   * </span><span style="color:#569CD6;">@name</span><span style="color:#4EC9B0;"> false</span><span style="color:#6A9955;"> 时不展示页脚</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">   */</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  footerRender</span><span style="color:#D4D4D4;">?: </span><span style="color:#4EC9B0;">false</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">  /**</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">   * </span><span style="color:#569CD6;">@name</span><span style="color:#4EC9B0;"> false</span><span style="color:#6A9955;"> 时不展示菜单</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">   */</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  menuRender</span><span style="color:#D4D4D4;">?: </span><span style="color:#4EC9B0;">false</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">  /**</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">   * </span><span style="color:#569CD6;">@name</span><span style="color:#4EC9B0;"> false</span><span style="color:#6A9955;"> 时不展示菜单顶栏</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">   */</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  menuHeaderRender</span><span style="color:#D4D4D4;">?: </span><span style="color:#4EC9B0;">false</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">  /**</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">   * </span><span style="color:#569CD6;">@name</span><span style="color:#4EC9B0;"> 固定顶栏</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">   **/</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  fixedHeader</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">boolean</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">  /**</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">   * </span><span style="color:#569CD6;">@name</span><span style="color:#4EC9B0;"> 固定菜单</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">   */</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  fixSiderbar</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">boolean</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">  /**</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">   * </span><span style="color:#569CD6;">@name</span><span style="color:#4EC9B0;"> theme</span><span style="color:#6A9955;"> for nav menu</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">   * </span><span style="color:#569CD6;">@name</span><span style="color:#4EC9B0;"> 导航菜单的主题</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">   */</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  navTheme</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;dark&#39;</span><span style="color:#D4D4D4;"> | </span><span style="color:#CE9178;">&#39;light&#39;</span><span style="color:#D4D4D4;"> | </span><span style="color:#CE9178;">&#39;realDark&#39;</span><span style="color:#D4D4D4;"> | </span><span style="color:#4EC9B0;">undefined</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">  /**</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">   * </span><span style="color:#569CD6;">@name</span><span style="color:#4EC9B0;"> nav</span><span style="color:#6A9955;"> menu position: \`side\` or \`top\`</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">   * </span><span style="color:#569CD6;">@name</span><span style="color:#4EC9B0;"> 导航菜单的位置</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">   * </span><span style="color:#569CD6;">@description</span><span style="color:#6A9955;"> side 为正常模式，top菜单显示在顶部，mix 两种兼有, false 不展示</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">   */</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  layout</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;side&#39;</span><span style="color:#D4D4D4;"> | </span><span style="color:#CE9178;">&#39;top&#39;</span><span style="color:#D4D4D4;"> | </span><span style="color:#CE9178;">&#39;mix&#39;</span><span style="color:#D4D4D4;"> | </span><span style="color:#4EC9B0;">false</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">  /**</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">   * </span><span style="color:#569CD6;">@name</span><span style="color:#4EC9B0;"> 顶部导航的主题，mix</span><span style="color:#6A9955;"> 模式生效</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">   */</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  headerTheme</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;dark&#39;</span><span style="color:#D4D4D4;"> | </span><span style="color:#CE9178;">&#39;light&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_1-2-1-菜单权限配置" tabindex="-1"><a class="header-anchor" href="#_1-2-1-菜单权限配置"><span>1.2.1 菜单权限配置</span></a></h4><ul><li><p><code>utils/menu.js</code>中配置菜单树（包括页面中的各种操作权限）</p><p> 注意：</p><p>1、key 必须唯一</p><p>2、若节点非菜单页面，key 的格式为 对应页面的 key.操作类型（基本操作类型已在枚举中定义）</p><p>3、例：用户管理页面（account）的新增按钮的 key 为 <code>account.\${ACTION_TYPE.ADD.code}</code></p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#569CD6;"> const</span><span style="color:#4FC1FF;"> MENU_TREE</span><span style="color:#D4D4D4;"> = [</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    key:</span><span style="color:#CE9178;"> &#39;templates&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    title:</span><span style="color:#CE9178;"> &#39;应用模板&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    isShow</span><span style="color:#9CDCFE;">:</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// TODO 自定义判断方法</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    isDisabled</span><span style="color:#9CDCFE;">:</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#569CD6;"> false</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// TODO 自定义判断方法</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    children:</span><span style="color:#D4D4D4;"> [</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        key:</span><span style="color:#CE9178;"> &#39;list&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        title:</span><span style="color:#CE9178;"> &#39;列表应用&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        isShow</span><span style="color:#9CDCFE;">:</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        isDisabled</span><span style="color:#9CDCFE;">:</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#569CD6;"> false</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        key:</span><span style="color:#CE9178;"> &#39;form&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        title:</span><span style="color:#CE9178;"> &#39;表单应用&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        isShow</span><span style="color:#9CDCFE;">:</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        isDisabled</span><span style="color:#9CDCFE;">:</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#569CD6;"> false</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ],</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    key:</span><span style="color:#CE9178;"> &#39;account&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    title:</span><span style="color:#CE9178;"> &#39;用户管理&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    isShow</span><span style="color:#9CDCFE;">:</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    isDisabled</span><span style="color:#9CDCFE;">:</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#569CD6;"> false</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    children:</span><span style="color:#D4D4D4;"> [</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        key:</span><span style="color:#CE9178;"> \`account.</span><span style="color:#569CD6;">\${</span><span style="color:#4FC1FF;">ACTION_TYPE</span><span style="color:#D4D4D4;">.</span><span style="color:#4FC1FF;">ADD</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">code</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;">\`</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        title:</span><span style="color:#CE9178;"> &#39;新增&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        isShow</span><span style="color:#9CDCFE;">:</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        isDisabled</span><span style="color:#9CDCFE;">:</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#569CD6;"> false</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        key:</span><span style="color:#CE9178;"> \`account.</span><span style="color:#569CD6;">\${</span><span style="color:#4FC1FF;">ACTION_TYPE</span><span style="color:#D4D4D4;">.</span><span style="color:#4FC1FF;">UPDATE</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">code</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;">\`</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        title:</span><span style="color:#CE9178;"> &#39;修改&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        isShow</span><span style="color:#9CDCFE;">:</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        isDisabled</span><span style="color:#9CDCFE;">:</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#569CD6;"> false</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        key:</span><span style="color:#CE9178;"> \`account.</span><span style="color:#569CD6;">\${</span><span style="color:#4FC1FF;">ACTION_TYPE</span><span style="color:#D4D4D4;">.</span><span style="color:#4FC1FF;">DELETE</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">code</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;">\`</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        title:</span><span style="color:#CE9178;"> &#39;删除&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        isShow</span><span style="color:#9CDCFE;">:</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">        isDisabled</span><span style="color:#9CDCFE;">:</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#569CD6;"> false</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ],</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">];</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>使用菜单权限配置组件<code>@/components/MenuTree</code>给不同的用户配置菜单权限（具体使用可见<code>@/pages/Account</code>）</p></li></ul><h4 id="_1-2-2-路由和菜单的权限控制" tabindex="-1"><a class="header-anchor" href="#_1-2-2-路由和菜单的权限控制"><span>1.2.2 路由和菜单的权限控制</span></a></h4><ul><li><p><code>config/route.js</code>中配置与上方<code>utils/menu.js</code>中相对应的 menuKey 和用于权限控制的权限名称</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#D4D4D4;"> [</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  ...{</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    path:</span><span style="color:#CE9178;"> &#39;/account&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    name:</span><span style="color:#CE9178;"> &#39;用户管理&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    icon:</span><span style="color:#CE9178;"> &#39;crown&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    component:</span><span style="color:#CE9178;"> &#39;./Account&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    menuKey:</span><span style="color:#CE9178;"> &#39;account&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// 唯一menuKey配置</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    access:</span><span style="color:#CE9178;"> &#39;normalRouteFilter&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// 权限名称配置</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">];</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>在<code>access.js</code>文件中加对应的路由判断方法</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C8C8C8;">normalRouteFilter</span><span style="color:#D4D4D4;">: (</span><span style="color:#9CDCFE;">route</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">  // 用以判断用户是否拥有路由权限</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  return</span><span style="color:#9CDCFE;"> currentUser</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">hasRoutesKeys</span><span style="color:#D4D4D4;">?.</span><span style="color:#DCDCAA;">includes</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">route</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">menuKey</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">};</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>如果不需要动态菜单权限控制，可以在 routes 里配置 authority:[&#39;admin&#39;,&#39;user&#39;]这样的用户角色，然后 access 方法判断的是 route.authority.includes(user.role)</p></blockquote></li><li><p>获取动态菜单数据</p><p><code>app.jsx</code>文件<code>getInitialState</code>中调接口（一般是用户用户信息接口）获取动态菜单数据并处理</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">defaultKeys</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;@/utils/menu&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#569CD6;"> async</span><span style="color:#569CD6;"> function</span><span style="color:#DCDCAA;"> getInitialState</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#DCDCAA;"> fetchUserInfo</span><span style="color:#D4D4D4;"> = </span><span style="color:#569CD6;">async</span><span style="color:#D4D4D4;"> () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    try</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">      const</span><span style="color:#4FC1FF;"> msg</span><span style="color:#D4D4D4;"> = </span><span style="color:#C586C0;">await</span><span style="color:#DCDCAA;"> fetchProfile</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        skipErrorHandler:</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      });</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">      const</span><span style="color:#4FC1FF;"> info</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">msg</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">data</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">      // 获取动态菜单数据</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      info</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">hasRoutesKeys</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">info</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">menuData</span><span style="color:#D4D4D4;"> || </span><span style="color:#9CDCFE;">defaultKeys</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">      return</span><span style="color:#9CDCFE;"> info</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    } </span><span style="color:#C586C0;">catch</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">error</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      history</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">push</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">loginPath</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    }</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#569CD6;"> undefined</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  };</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  ...</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h4 id="_1-2-3-页面内的权限控制" tabindex="-1"><a class="header-anchor" href="#_1-2-3-页面内的权限控制"><span>1.2.3 页面内的权限控制</span></a></h4><ul><li><p>在<code>access.js</code>文件中加对应的权限判断方法</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C8C8C8;">canOperate</span><span style="color:#D4D4D4;">: (</span><span style="color:#9CDCFE;">routeKey</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">operateKey</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  return</span><span style="color:#9CDCFE;"> currentUser</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">hasRoutesKeys</span><span style="color:#D4D4D4;">?.</span><span style="color:#DCDCAA;">includes</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">\`</span><span style="color:#569CD6;">\${</span><span style="color:#9CDCFE;">routeKey</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;">.</span><span style="color:#569CD6;">\${</span><span style="color:#9CDCFE;">operateKey</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;">\`</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">};</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>通过 <code>useAccess</code> hook 来获取权限定义， <code>Access</code> 组件用于页面的元素显示和隐藏的控制</p><div class="language-jsx line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="jsx"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-jsx;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// import { useAccess, useRouteData } from &#39;@umijs/max&#39;;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">usePageProps</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;@/utils/hooks&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#569CD6;"> function</span><span style="color:#DCDCAA;"> Account</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">  // const access = useAccess();</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">  // const { route } = useRouteData();</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">  // 页面中常用的获取路由、权限等hook封装在了usePageProps中  可直接使用该hook</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#D4D4D4;"> { </span><span style="color:#4FC1FF;">route</span><span style="color:#D4D4D4;"> = {}, </span><span style="color:#4FC1FF;">access</span><span style="color:#D4D4D4;"> = {} } = </span><span style="color:#DCDCAA;">usePageProps</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  ...</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  return</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ...</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 方法一：直接控制显隐</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#4EC9B0;">Access</span><span style="color:#9CDCFE;"> accessible</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">access</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">canOperate</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">route</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">menuKey</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">ACTION_TYPE</span><span style="color:#D4D4D4;">.</span><span style="color:#4FC1FF;">ADD</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">code</span><span style="color:#D4D4D4;">)</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">      &lt;</span><span style="color:#4EC9B0;">Button</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        type</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;primary&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        onClick</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#D4D4D4;">() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {...}</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#4EC9B0;">PlusOutlined</span><span style="color:#808080;"> /&gt;</span><span style="color:#D4D4D4;"> 新增用户</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">      &lt;/</span><span style="color:#4EC9B0;">Button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#4EC9B0;">Access</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 方法二：事件触发后做提示</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#4EC9B0;">Button</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      type</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;primary&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      onClick</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#D4D4D4;">() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">access</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">canOperate</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">route</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">menuKey</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">ACTION_TYPE</span><span style="color:#D4D4D4;">.</span><span style="color:#4FC1FF;">ADD</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">code</span><span style="color:#D4D4D4;">)) {</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">          ...</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        } </span><span style="color:#C586C0;">else</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">          message</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">error</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">\`暂无</span><span style="color:#569CD6;">\${</span><span style="color:#4FC1FF;">ACTION_TYPE</span><span style="color:#D4D4D4;">.</span><span style="color:#4FC1FF;">ADD</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">desc</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;">权限\`</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      }</span><span style="color:#569CD6;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">      &gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">      &lt;</span><span style="color:#4EC9B0;">PlusOutlined</span><span style="color:#808080;"> /&gt;</span><span style="color:#D4D4D4;"> 新增用户</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#4EC9B0;">Button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ...</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="_1-3-分组菜单" tabindex="-1"><a class="header-anchor" href="#_1-3-分组菜单"><span>1.3 分组菜单</span></a></h3><ol><li>在 config/defaultSetting 下，menu 的 type 改为 group 分组类型</li><li>routes 配置，需要分组的在对应路由下加 group:&#39;groupName&#39;</li></ol><div class="language-text line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-text;"><code><span class="line"><span class="line"><span>  {</span></span></span>
<span class="line"><span class="line"><span>    path: &#39;/templates&#39;,</span></span></span>
<span class="line"><span class="line"><span>    name: &#39;应用模板&#39;,</span></span></span>
<span class="line"><span class="line"><span>    icon: &#39;StepForwardOutlined&#39;,</span></span></span>
<span class="line"><span class="line"><span>    key: &#39;templates&#39;,</span></span></span>
<span class="line"><span class="line"><span>    access: &#39;normalRouteFilter&#39;,</span></span></span>
<span class="line"><span class="line"><span>    group: &#39;应用类型&#39;,</span></span></span>
<span class="line"><span class="line"><span>    routes: [</span></span></span>
<span class="line"><span class="line"><span>      {</span></span></span>
<span class="line"><span class="line"><span>        path: &#39;/templates&#39;,</span></span></span>
<span class="line"><span class="line"><span>        redirect: &#39;/templates/list&#39;,</span></span></span>
<span class="line"><span class="line"><span>      },</span></span></span>
<span class="line"><span class="line"><span>      {</span></span></span>
<span class="line"><span class="line"><span>        path: &#39;/templates/list&#39;,</span></span></span>
<span class="line"><span class="line"><span>        name: &#39;列表应用&#39;,</span></span></span>
<span class="line"><span class="line"><span>        component: &#39;./Templates/List&#39;,</span></span></span>
<span class="line"><span class="line"><span>        key: &#39;list&#39;,</span></span></span>
<span class="line"><span class="line"><span>        access: &#39;normalRouteFilter&#39;,</span></span></span>
<span class="line"><span class="line"><span>      },</span></span></span>
<span class="line"><span class="line"><span>      {</span></span></span>
<span class="line"><span class="line"><span>        path: &#39;*&#39;,</span></span></span>
<span class="line"><span class="line"><span>        component: &#39;./404&#39;,</span></span></span>
<span class="line"><span class="line"><span>      },</span></span></span>
<span class="line"><span class="line"><span>    ],</span></span></span>
<span class="line"><span class="line"><span>  },</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-4-子菜单显示-icon" tabindex="-1"><a class="header-anchor" href="#_1-4-子菜单显示-icon"><span>1.4 子菜单显示 icon</span></a></h3><p>在 routes 里进行配置 icon，开启 showIcon: true。</p><blockquote><p>需注意，这里只支持 iconfont 和 antdv4 之后的 icon</p></blockquote><div class="language-text line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-text;"><code><span class="line"><span class="line"><span>  {</span></span></span>
<span class="line"><span class="line"><span>    path: &#39;/templates/list&#39;,</span></span></span>
<span class="line"><span class="line"><span>    name: &#39;列表应用&#39;,</span></span></span>
<span class="line"><span class="line"><span>    component: &#39;./Templates/List&#39;,</span></span></span>
<span class="line"><span class="line"><span>    icon: &#39;StepForwardOutlined&#39;, // iconfont: icon-xxx</span></span></span>
<span class="line"><span class="line"><span>    showIcon: true,</span></span></span>
<span class="line"><span class="line"><span>    key: &#39;list&#39;,</span></span></span>
<span class="line"><span class="line"><span>    access: &#39;normalRouteFilter&#39;,</span></span></span>
<span class="line"><span class="line"><span>  },</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-5-自定义菜单" tabindex="-1"><a class="header-anchor" href="#_1-5-自定义菜单"><span>1.5 自定义菜单</span></a></h3><p><strong>效果</strong></p><p>一级菜单置于顶部展示，鼠标悬浮在一级菜单上展示其子级所有菜单</p><p><strong>使用配置</strong></p><p>defaultSettings.js</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C8C8C8;"> menu</span><span style="color:#D4D4D4;">: {</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    type</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;group&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// sub 菜单 / group 分组菜单</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    custom</span><span style="color:#D4D4D4;">: </span><span style="color:#569CD6;">true</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// 自定义菜单</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  },</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>routes.js</p><p>给对应的菜单配置 group</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#D4D4D4;">		{</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        path</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;/templates/list&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        name</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;列表应用&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        group</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;应用&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        component</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;./Templates/List&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        menuKey</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;list&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">        access</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;normalRouteFilter&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ...</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>自定义效果开发</strong></p><p>可在 app.jsx 中对<code>MenuItem</code>的 dom 进行修改</p><h2 id="二、接口请求" tabindex="-1"><a class="header-anchor" href="#二、接口请求"><span>二、接口请求</span></a></h2><ul><li><p><code>src/services</code>文件夹中配置需要的接口方法有一些更改</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#569CD6;"> async</span><span style="color:#569CD6;"> function</span><span style="color:#DCDCAA;"> fetchOrgList</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">params</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">options</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  return</span><span style="color:#DCDCAA;"> request</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">\`</span><span style="color:#569CD6;">\${</span><span style="color:#4FC1FF;">HOST</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;">/v1/system/organization/list?</span><span style="color:#569CD6;">\${</span><span style="color:#DCDCAA;">stringify</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">params</span><span style="color:#D4D4D4;">)</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;">\`</span><span style="color:#D4D4D4;">, {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    method:</span><span style="color:#CE9178;"> &#39;GET&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ...(</span><span style="color:#9CDCFE;">options</span><span style="color:#D4D4D4;"> || {}),</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  });</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#569CD6;"> async</span><span style="color:#569CD6;"> function</span><span style="color:#DCDCAA;"> fetchOrgSave</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">params</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">options</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  return</span><span style="color:#DCDCAA;"> request</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">\`</span><span style="color:#569CD6;">\${</span><span style="color:#4FC1FF;">HOST</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;">/v1/system/organization/save\`</span><span style="color:#D4D4D4;">, {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    method:</span><span style="color:#CE9178;"> &#39;POST&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    data:</span><span style="color:#9CDCFE;"> params</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ...(</span><span style="color:#9CDCFE;">options</span><span style="color:#D4D4D4;"> || {}),</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  });</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>options 可传<code>skipErrorHandler: true</code>，用于跳过默认的错误处理</p></li><li><p>接口请求错误处理迁移到<code>src/requestErrorConfig.js</code>,这边非正常业务码都会用异常来捕获</p></li></ul><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;"> // 响应拦截器</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">  responseInterceptors</span><span style="color:#D4D4D4;">: [</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    (</span><span style="color:#9CDCFE;">response</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">      // 拦截响应数据，进行个性化处理</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">      const</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">data</span><span style="color:#D4D4D4;">: </span><span style="color:#4FC1FF;">res</span><span style="color:#D4D4D4;"> } = </span><span style="color:#9CDCFE;">response</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">      if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">res</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">code</span><span style="color:#D4D4D4;"> !== </span><span style="color:#4FC1FF;">SUCCESS_CODE</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">        throw</span><span style="color:#9CDCFE;"> res</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      }</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">      return</span><span style="color:#9CDCFE;"> response</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  ],</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>当数据仅在单页面使用时，可以直接使用 useRequest</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">useRequest</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;@umijs/max&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">changeUsername</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;@/services/api&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#D4D4D4;"> () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#D4D4D4;"> { </span><span style="color:#4FC1FF;">run</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">loading</span><span style="color:#D4D4D4;"> } = </span><span style="color:#DCDCAA;">useRequest</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">changeUsername</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">manual:</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;"> });</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  return</span><span style="color:#D4D4D4;"> (</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#4EC9B0;">Button</span><span style="color:#9CDCFE;"> onClick</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#D4D4D4;">() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#DCDCAA;"> run</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;new name&#39;</span><span style="color:#D4D4D4;">)</span><span style="color:#569CD6;">}</span><span style="color:#9CDCFE;"> loading</span><span style="color:#D4D4D4;">=</span><span style="color:#569CD6;">{</span><span style="color:#9CDCFE;">loading</span><span style="color:#569CD6;">}</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      Edit</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#4EC9B0;">Button</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  );</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">};</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="userequest-和-usemodel-结合的简易数据流" tabindex="-1"><a class="header-anchor" href="#userequest-和-usemodel-结合的简易数据流"><span><a href="https://umijs.org/docs/max/request#userequest" target="_blank" rel="noopener noreferrer">useRequest</a> 和 <a href="https://umijs.org/docs/max/data-flow" target="_blank" rel="noopener noreferrer">useModel</a> 结合的简易数据流</span></a></h3><p>当数据需要持久化时，可以使用该方法</p><p>1、<code>src/services</code>文件夹中配置需要的接口</p><p>2、model 中配置对应的 useRequest 接口请求，返回的数据 data，loading 及请求方法等放入 model 中（可参考<code>models/tableList</code>）</p><ul><li>若不需要处理数据，可直接使用 useRequest 解构出来的 data</li><li>若需要处理数据，可以在 onSuccess 进行数据存储，也可以直接通过 formatResult 进行数据处理,数据处理好后 data 就是处理后的数据</li></ul><p>需注意，onSuccess 成功回调拿到的直接是 data 里的数据，而 formatResult(成功时调用）拿到的是整个{code, data}的对象</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">message</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;antd&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">useRequest</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;@umijs/max&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">fetchRuleList</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;@/services/api&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#D4D4D4;"> () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    run</span><span style="color:#D4D4D4;">: </span><span style="color:#4FC1FF;">fetchTableList</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    data</span><span style="color:#D4D4D4;">: </span><span style="color:#4FC1FF;">tableList</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    loading</span><span style="color:#D4D4D4;">: </span><span style="color:#4FC1FF;">tableLoading</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  } = </span><span style="color:#DCDCAA;">useRequest</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">v</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#DCDCAA;"> fetchRuleList</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">v</span><span style="color:#D4D4D4;">), {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    manual:</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    onSuccess</span><span style="color:#9CDCFE;">:</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">res</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#9CDCFE;"> res</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    onError</span><span style="color:#9CDCFE;">:</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">res</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      message</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">error</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">res</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">message</span><span style="color:#D4D4D4;"> || </span><span style="color:#CE9178;">&#39;请求失败&#39;</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 数据处理</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    formatResult</span><span style="color:#9CDCFE;">:</span><span style="color:#D4D4D4;"> ({ </span><span style="color:#9CDCFE;">data</span><span style="color:#D4D4D4;">: </span><span style="color:#9CDCFE;">res</span><span style="color:#D4D4D4;"> }) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">      const</span><span style="color:#4FC1FF;"> arr</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">res</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">items</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">map</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> ({</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        ...</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        enabled:</span><span style="color:#9CDCFE;"> index</span><span style="color:#D4D4D4;"> % </span><span style="color:#B5CEA8;">2</span><span style="color:#D4D4D4;"> === </span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      }));</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">      return</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        ...</span><span style="color:#9CDCFE;">res</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        items:</span><span style="color:#9CDCFE;"> arr</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      };</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  });</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  return</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">fetchTableList</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">tableLoading</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">tableList</span><span style="color:#D4D4D4;"> };</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">};</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3、使用时用 useModel 来获取 （具体使用可参考<code>src/page/Application/Table</code>）</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> { </span><span style="color:#4FC1FF;">fetchTableList</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">tableLoading</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">tableList</span><span style="color:#D4D4D4;"> } = </span><span style="color:#DCDCAA;">useModel</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;tableList&#39;</span><span style="color:#D4D4D4;">);</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>4、useModel 提供给第二个参数来做缓存依赖，但是每个都写又会加剧代码工作量，所以在 utils/hooks 里封装了 useMemoModel</p><div class="language-text line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-text;"><code><span class="line"><span class="line"><span>/**</span></span></span>
<span class="line"><span class="line"><span> * useModel depths 缓存</span></span></span>
<span class="line"><span class="line"><span> * @param {*} model</span></span></span>
<span class="line"><span class="line"><span> * @param {*} depthsArr 需要返回的参数名，多层级用.分割，如[&#39;tableList&#39;, &#39;account.currentUser&#39;]</span></span></span>
<span class="line"><span class="line"><span> * @param {*} flattern 多层级是否扁平化</span></span></span>
<span class="line"><span class="line"><span> * @returns</span></span></span>
<span class="line"><span class="line"><span> * @example</span></span></span>
<span class="line"><span class="line"><span> * const {tableList, currentUser = {}} = useMemoModel(&#39;user&#39;,[&#39;tableList&#39;,&#39;account.currentUser&#39;])</span></span></span>
<span class="line"><span class="line"><span> */</span></span></span>
<span class="line"><span class="line"><span>export function useMemoModel(model, depthsArr = [], flattern = true) {</span></span></span>
<span class="line"><span class="line"><span>  const props = useModel(model, (m) =&gt; {</span></span></span>
<span class="line"><span class="line"><span>    const tmp = {};</span></span></span>
<span class="line"><span class="line"><span>    depthsArr.forEach((v) =&gt; {</span></span></span>
<span class="line"><span class="line"><span>      const [k0, ...keys] = v?.split(&#39;.&#39;);</span></span></span>
<span class="line"><span class="line"><span>      if (!keys.length) {</span></span></span>
<span class="line"><span class="line"><span>        tmp[k0] = m[k0];</span></span></span>
<span class="line"><span class="line"><span>      }</span></span></span>
<span class="line"><span class="line"><span>      keys.forEach((k) =&gt; {</span></span></span>
<span class="line"><span class="line"><span>        if (flattern) {</span></span></span>
<span class="line"><span class="line"><span>          tmp[k] = m[k0][k];</span></span></span>
<span class="line"><span class="line"><span>          return;</span></span></span>
<span class="line"><span class="line"><span>        }</span></span></span>
<span class="line"><span class="line"><span>        tmp[k0][k] = m[k0][k];</span></span></span>
<span class="line"><span class="line"><span>      });</span></span></span>
<span class="line"><span class="line"><span>    });</span></span></span>
<span class="line"><span class="line"><span>    return tmp;</span></span></span>
<span class="line"><span class="line"><span>  });</span></span></span>
<span class="line"><span class="line"><span>  return props;</span></span></span>
<span class="line"><span class="line"><span>}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="三、路由" tabindex="-1"><a class="header-anchor" href="#三、路由"><span>三、路由</span></a></h2><h3 id="_3-1-路由跳转" tabindex="-1"><a class="header-anchor" href="#_3-1-路由跳转"><span>3.1 路由跳转</span></a></h3><p>同 umi3 一样，支持 history 方法跳转。由于 umi4 不再支持 props 传递 route props，只提供 hook 来进行调用，所以在 utils/hooks 里封装了 usePageProps</p><div class="language-text line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-text;"><code><span class="line"><span class="line"><span>/**</span></span></span>
<span class="line"><span class="line"><span> * 获得页面参数</span></span></span>
<span class="line"><span class="line"><span> * @returns {Object}</span></span></span>
<span class="line"><span class="line"><span> * { location, access: 权限, params: path参数,queryParams: query参数, route: 当前页面路由, history: history跳转方法, navigate: 路由组件跳转 }</span></span></span>
<span class="line"><span class="line"><span> */</span></span></span>
<span class="line"><span class="line"><span>export function usePageProps() {</span></span></span>
<span class="line"><span class="line"><span>  const location = useLocation();</span></span></span>
<span class="line"><span class="line"><span>  const access = useAccess();</span></span></span>
<span class="line"><span class="line"><span>  const params = useParams();</span></span></span>
<span class="line"><span class="line"><span>  const { route } = useRouteData();</span></span></span>
<span class="line"><span class="line"><span>  const navigate = useNavigate();</span></span></span>
<span class="line"><span class="line"><span>  const queryParams = getPageQuery();</span></span></span>
<span class="line"><span class="line"><span>  return {</span></span></span>
<span class="line"><span class="line"><span>    location,</span></span></span>
<span class="line"><span class="line"><span>    access,</span></span></span>
<span class="line"><span class="line"><span>    params,</span></span></span>
<span class="line"><span class="line"><span>    route,</span></span></span>
<span class="line"><span class="line"><span>    queryParams,</span></span></span>
<span class="line"><span class="line"><span>    history,</span></span></span>
<span class="line"><span class="line"><span>    navigate</span></span></span>
<span class="line"><span class="line"><span>  };</span></span></span>
<span class="line"><span class="line"><span>}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>我们可以在页面里进行调用</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// /detail/2?type=1</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#DCDCAA;"> Detail</span><span style="color:#D4D4D4;"> = () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#4FC1FF;">    location</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// 不带publicPath的地址信息</span></span></span>
<span class="line"><span class="line"><span style="color:#4FC1FF;">    access</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// 权限</span></span></span>
<span class="line"><span class="line"><span style="color:#4FC1FF;">    params</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#4FC1FF;">    route</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#4FC1FF;">    queryParams</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#4FC1FF;">    history</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#4FC1FF;">    navigate</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  } = </span><span style="color:#DCDCAA;">usePageProps</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">params</span><span style="color:#D4D4D4;">); </span><span style="color:#6A9955;">// {id: 2}</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">queryParams</span><span style="color:#D4D4D4;">); </span><span style="color:#6A9955;">// {type: 1}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">  // 页面跳转支持两种</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">  // push</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  history</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">push</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;/check&#39;</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">  navigate</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;/check&#39;</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">  // replace</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  history</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">replace</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;/check&#39;</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">  navigate</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;/check&#39;</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">replace:</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;"> });</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">  // back</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  history</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">goBack</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">  navigate</span><span style="color:#D4D4D4;">(-</span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">};</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>这里推荐使用 navigate 进行跳转，但注意，navigate 只支持在组件内使用。</strong></p><p>navigate 特效：</p><ul><li>支持相对路径</li></ul><div class="language-text line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-text;"><code><span class="line"><span class="line"><span>// 当前路径 /admin/account/list</span></span></span>
<span class="line"><span class="line"><span>navigate(&#39;../detail&#39;) // 等同于 /admin/account/detail</span></span></span>
<span class="line"><span class="line"><span>navigate(&#39;../../detail&#39;) // 等同于 /admin/detail</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>支持将参数放在 state 里进行传递，且页面刷新并不会影响【<strong>路径复制新开窗口，相关 state 无法获得，重要参数请放路径</strong>】</li></ul><div class="language-text line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-text;"><code><span class="line"><span class="line"><span>navigate(&#39;/admin/account/detail&#39;, {</span></span></span>
<span class="line"><span class="line"><span>    state: {</span></span></span>
<span class="line"><span class="line"><span>        type: 2</span></span></span>
<span class="line"><span class="line"><span>    }</span></span></span>
<span class="line"><span class="line"><span>})</span></span></span>
<span class="line"><span class="line"><span></span></span></span>
<span class="line"><span class="line"><span>// Detail.jsx</span></span></span>
<span class="line"><span class="line"><span>const { location } = usePageProps();</span></span></span>
<span class="line"><span class="line"><span>console.log(location.state) // {type: 2}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-2-面包屑" tabindex="-1"><a class="header-anchor" href="#_3-2-面包屑"><span>3.2 面包屑</span></a></h3><p>在 components 里封装了 BaseBreadCrumb 面包屑组件，支持：当前窗口内，点击面包屑某一级菜单，会去匹配路由历史最近的一次地址。</p><p>如：从/list?pageSize=20 跳转进详情，点击面包屑返回出来依旧携带参数</p><div class="language-text line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-text;"><code><span class="line"><span class="line"><span>// 支持在ProLayout、PageContainer使用</span></span></span>
<span class="line"><span class="line"><span>&lt;PageContainer</span></span></span>
<span class="line"><span class="line"><span>    breadcrumbRender={({ breadcrumb: { routes } }) =&gt; {</span></span></span>
<span class="line"><span class="line"><span>        return &lt;BaseBreadcrumb breadcrumb={routes} /&gt;;</span></span></span>
<span class="line"><span class="line"><span>      }}</span></span></span>
<span class="line"><span class="line"><span>/&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="四、多页签" tabindex="-1"><a class="header-anchor" href="#四、多页签"><span>四、多页签</span></a></h2><h3 id="功能效果" tabindex="-1"><a class="header-anchor" href="#功能效果"><span>功能效果</span></a></h3><p>1、基本的多页签展示及切换功能</p><p>2、页签切换保留位置与数据</p><p>3、刷新浏览器，页签依旧保留</p><p>4、可配置项（关闭页签/刷新浏览器时的提示、是否可关闭页签、是否打开新页签）</p><p>5、右键菜单（关闭选中标签、关闭右侧标签页、关闭其他标签页）</p><h3 id="使用-开启多页签模式" tabindex="-1"><a class="header-anchor" href="#使用-开启多页签模式"><span>使用（开启多页签模式）</span></a></h3><p>defaultSettings.js 配置</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#D4D4D4;">{</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  ...,</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">  multipleTabs</span><span style="color:#D4D4D4;">: </span><span style="color:#569CD6;">true</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// 开启多页签模式</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>routes.js 配置</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#D4D4D4;">{</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  ...</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  {</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    path</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;/templates/step-form&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    name</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;分步表单&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // group: &#39;应用&#39;,</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    component</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;./Templates/StepForm&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    menuKey</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;step&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    access</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;normalRouteFilter&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 多页签相关配置</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">    tabProps</span><span style="color:#D4D4D4;">: {</span></span></span>
<span class="line"><span class="line"><span style="color:#C8C8C8;">      closeTip</span><span style="color:#D4D4D4;">: </span><span style="color:#569CD6;">true</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// 关闭页签/刷新浏览器时的提示，默认为false</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  ...</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="tabprops-配置" tabindex="-1"><a class="header-anchor" href="#tabprops-配置"><span>tabProps 配置</span></a></h3><table><thead><tr><th>参数</th><th>说明</th><th>默认值</th></tr></thead><tbody><tr><td>closeTip</td><td>关闭页签/刷新浏览器时的提示</td><td>false</td></tr><tr><td>openNew</td><td>页面是否在新页签打开。例：首次登录时需要修改初始密码，则从首页跳转到修改初始密码，而不是打开新页签，需要配置 openNew 为 false。</td><td>true</td></tr><tr><td>closable</td><td>页签是否可关闭</td><td>true</td></tr><tr><td>skipNew</td><td>跳转其他页面时是否打开新页签。例：完成首次登录初始密码修改后，在当前页签跳转到首页，而不是打开新页签，配置 skipNew 为 false。</td><td>true</td></tr></tbody></table><h3 id="开发注意事项" tabindex="-1"><a class="header-anchor" href="#开发注意事项"><span>开发注意事项</span></a></h3><p>1、在同一个页签跳转详情页的路由配置</p><p>当业务需要页面都在同一个页签展示时，注意路由配置需要存在包含关系</p><p>正确示例：/system/role 和 /system/role/add（存在包含关系，页面跳转处于同一页签）</p><p>错误示例：/system/role/list 和 /system/role/add（不存在包含关系，跳转时打开新页签）</p><p>2、二级页返回上一页</p><p>例：从列表页打开详情页后，此时记录的上一页为列表页。此时多次切换页签再回到详情页时，记录的上一页则变成了最后一次切换到详情页前的页面路由，而非列表页，此时返回页面则会出现逻辑错误。</p><p>解决：当需要返回上一页时，将<code>history.go(-1)</code>修改成<code>goBack()</code></p><p>引入及使用：</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">useGoBack</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;@/utils/hooks&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> { </span><span style="color:#4FC1FF;">goBack</span><span style="color:#D4D4D4;"> } = </span><span style="color:#DCDCAA;">useGoBack</span><span style="color:#D4D4D4;">(); </span><span style="color:#6A9955;">// 引入自定义hooks中的返回上一页方法</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">goBack</span><span style="color:#D4D4D4;">(); </span><span style="color:#6A9955;">// 解决因多页签切换导致返回的上一页面不正确的问题</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3、给 PageContainer 中配置了 footer 的页面加配置 <code>footerToolBarProps={{ portalDom: false }} </code></p><p>用于解决打开有 footer 的页面后，切换到其他页签，footer 依然存在的问题</p><p>4、在当前页面自动关闭当前页签</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">useModel</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;@umijs/max&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> { </span><span style="color:#4FC1FF;">closeTab</span><span style="color:#D4D4D4;"> } = </span><span style="color:#DCDCAA;">useModel</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;tabs&#39;</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">closeTab</span><span style="color:#D4D4D4;">(); </span><span style="color:#6A9955;">// 关闭当前页签</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="五、插件" tabindex="-1"><a class="header-anchor" href="#五、插件"><span>五、插件</span></a></h2><h3 id="_4-1-fast-code-create" tabindex="-1"><a class="header-anchor" href="#_4-1-fast-code-create"><span>4.1 fast-code-create</span></a></h3><blockquote><p>vscode 商店插件，用来快速将 swagger 接口生成对应请求代码</p></blockquote><ol><li><p>在 vscode 商店搜索 &#39;fast-code-create&#39; 插件进行安装 <img src="https://gitee.com/xiaomoziyi/blogImage/raw/master/img/20230213145344.png" alt=""></p></li><li><p>安装完毕之后在当前项目的根目录右键， 查看菜单中 点击 打开 CodeCreate 设计器。 <img src="https://gitee.com/xiaomoziyi/blogImage/raw/master/img/20230213145321.png" alt=""></p></li><li><p>打开后会在项目右侧打开一个新视图。 <img src="https://gitee.com/xiaomoziyi/blogImage/raw/master/img/20230213145356.png" alt=""></p></li><li><p>打开设计器后，需要上传 swagger-data 以及 options</p></li><li><p>swagger-data 的 json 为 swagger 后端的 api.json</p></li><li><p>options 可以点击下载默认 options 然后进行编辑修改</p></li><li><p>完成以后，可以选择勾选相应的 api，再点击批量生成 api，即可再 src/service/api.js 生成相应 api <img src="https://gitee.com/xiaomoziyi/blogImage/raw/master/img/20230213145253.png" alt=""></p></li><li><p>也可以选择单个页面生成，支持列表以及详情表单实例生成。其中 componentsPath 为生成的目录路径,默认生成在 src/pages 下，需要以/开头.jsx 结尾例如 /2.jsx 或者 /user/login.jsx。按钮 isCreate 表示是否生成文件，否则仅仅生成 api <img src="https://gitee.com/xiaomoziyi/blogImage/raw/master/img/20230213145333.png" alt=""></p></li></ol><h3 id="_4-2-apifox" tabindex="-1"><a class="header-anchor" href="#_4-2-apifox"><span>4.2 Apifox</span></a></h3><blockquote><p>mock 工具，提供本地、云端模式环境，支持接口调用、接口高级 mock 规则等功能</p></blockquote><p>使用文档：<a href="http://thoughts.hyperchain.cn:8099/workspaces/5d4b89ddbe825b1e266e05b8/files/63a2d8d8be825b00016e5646" target="_blank" rel="noopener noreferrer">入口</a></p>`,124)]))}const r=n(p,[["render",i],["__file","中后台管理系统模板记录.html.vue"]]),t=JSON.parse('{"path":"/%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91/%E4%B8%AD%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E6%A8%A1%E6%9D%BF%E8%AE%B0%E5%BD%95.html","title":"控制台模板","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"技术栈","slug":"技术栈","link":"#技术栈","children":[]},{"level":2,"title":"安装","slug":"安装","link":"#安装","children":[]},{"level":2,"title":"运行","slug":"运行","link":"#运行","children":[]},{"level":2,"title":"打包","slug":"打包","link":"#打包","children":[]},{"level":2,"title":"项目架构","slug":"项目架构","link":"#项目架构","children":[]},{"level":2,"title":"注意","slug":"注意","link":"#注意","children":[]},{"level":2,"title":"components 通用组件库","slug":"components-通用组件库","link":"#components-通用组件库","children":[]},{"level":2,"title":"一、权限管理","slug":"一、权限管理","link":"#一、权限管理","children":[{"level":3,"title":"1.1 固定角色的不同菜单","slug":"_1-1-固定角色的不同菜单","link":"#_1-1-固定角色的不同菜单","children":[]},{"level":3,"title":"1.2 动态菜单","slug":"_1-2-动态菜单","link":"#_1-2-动态菜单","children":[]},{"level":3,"title":"1.3 分组菜单","slug":"_1-3-分组菜单","link":"#_1-3-分组菜单","children":[]},{"level":3,"title":"1.4 子菜单显示 icon","slug":"_1-4-子菜单显示-icon","link":"#_1-4-子菜单显示-icon","children":[]},{"level":3,"title":"1.5 自定义菜单","slug":"_1-5-自定义菜单","link":"#_1-5-自定义菜单","children":[]}]},{"level":2,"title":"二、接口请求","slug":"二、接口请求","link":"#二、接口请求","children":[{"level":3,"title":"useRequest 和 useModel 结合的简易数据流","slug":"userequest-和-usemodel-结合的简易数据流","link":"#userequest-和-usemodel-结合的简易数据流","children":[]}]},{"level":2,"title":"三、路由","slug":"三、路由","link":"#三、路由","children":[{"level":3,"title":"3.1 路由跳转","slug":"_3-1-路由跳转","link":"#_3-1-路由跳转","children":[]},{"level":3,"title":"3.2 面包屑","slug":"_3-2-面包屑","link":"#_3-2-面包屑","children":[]}]},{"level":2,"title":"四、多页签","slug":"四、多页签","link":"#四、多页签","children":[{"level":3,"title":"功能效果","slug":"功能效果","link":"#功能效果","children":[]},{"level":3,"title":"使用（开启多页签模式）","slug":"使用-开启多页签模式","link":"#使用-开启多页签模式","children":[]},{"level":3,"title":"tabProps 配置","slug":"tabprops-配置","link":"#tabprops-配置","children":[]},{"level":3,"title":"开发注意事项","slug":"开发注意事项","link":"#开发注意事项","children":[]}]},{"level":2,"title":"五、插件","slug":"五、插件","link":"#五、插件","children":[{"level":3,"title":"4.1 fast-code-create","slug":"_4-1-fast-code-create","link":"#_4-1-fast-code-create","children":[]},{"level":3,"title":"4.2 Apifox","slug":"_4-2-apifox","link":"#_4-2-apifox","children":[]}]}],"git":{"updatedTime":1726680671000,"contributors":[{"name":"csmSimona","username":"csmSimona","email":"980715844@qq.com","commits":1,"url":"https://github.com/csmSimona"}],"changelog":[{"hash":"0980796ead3db1493c6b8c050e85e795ca427462","time":1726680671000,"email":"980715844@qq.com","author":"csmSimona","message":"update"}]},"filePathRelative":"项目开发/中后台管理系统模板记录.md","readingTime":{"minutes":12.76,"words":3829}}');export{r as comp,t as data};
