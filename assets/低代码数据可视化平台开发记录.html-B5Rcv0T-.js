import{_ as n,c as a,a as l,o as e}from"./app-Dbx6xvs6.js";const p={};function o(i,s){return e(),a("div",null,s[0]||(s[0]=[l(`<h1 id="vue-lowcode-cockpit-admin" tabindex="-1"><a class="header-anchor" href="#vue-lowcode-cockpit-admin"><span>vue-lowcode-cockpit-admin</span></a></h1><p>基于 Vue3, Vite5, TypeScript, Pinia, NaiveUI 和 tailwindcss 的低代码数据可视化开发平台</p><p>管理后台模板基于<a href="https://github.com/jekip/naive-ui-admin" target="_blank" rel="noopener noreferrer">naive-ui-admin</a></p><h3 id="功能梳理" tabindex="-1"><a class="header-anchor" href="#功能梳理"><span>功能梳理</span></a></h3><ul><li><p>大屏列表展示页</p></li><li><p>大屏编辑器</p><ul><li>顶部：保存、预览等</li><li>左侧：组件库、图层</li><li>中间：画布</li><li>右侧：背景和组件编辑器</li></ul><p>组件拖拽或双击注册到画布上</p></li><li><p>大屏预览页</p></li></ul><h3 id="组件库" tabindex="-1"><a class="header-anchor" href="#组件库"><span><strong>组件库</strong></span></a></h3><p>柱状图：基础柱状图、横向柱状图、象形堆叠柱状图</p><p>折线图：基础折线图、基础面积图、堆叠折线图、堆叠面积图、折柱混合图</p><p>饼图：基础饼图、环图、自动轮播环图</p><p>地图：基础地图、自动轮播地图、投影地图、伪3D地图、叠层地图、散点地图、飞线地图、3D柱状图、3D地图</p><p>滚动表格</p><p>滚动列表</p><p>按钮：配置跳转</p><p>边框</p><p>文本</p><p>滚动数字</p><h3 id="具体实现" tabindex="-1"><a class="header-anchor" href="#具体实现"><span>具体实现</span></a></h3><p>低代码原理：编辑器生成页面JSON数据，服务端负责存取JSON数据，渲染时从服务端取数据JSON交给前端模板处理。</p><p>实现核心：全局注册自定义组件，通过<a href="https://cn.vuejs.org/api/built-in-special-elements.html#component" target="_blank" rel="noopener noreferrer"><code>&lt;component&gt;</code></a>动态渲染自定义组件</p><h4 id="_1、大屏设计器布局" tabindex="-1"><a class="header-anchor" href="#_1、大屏设计器布局"><span>1、大屏设计器布局</span></a></h4><p>tailwindcss 语法查询：https://www.tailwindcss.cn/docs/aspect-ratio</p><p>上下结构：头部和内容区域</p><p>内容布局：左中右</p><h4 id="_2、画布标尺" tabindex="-1"><a class="header-anchor" href="#_2、画布标尺"><span>2、画布标尺</span></a></h4><h5 id="安装" tabindex="-1"><a class="header-anchor" href="#安装"><span>安装</span></a></h5><p>https://github.com/kakajun/vue3-sketch-ruler</p><div class="language-bash line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-bash;"><code><span class="line"><span class="line"><span style="color:#DCDCAA;">npm</span><span style="color:#CE9178;"> install</span><span style="color:#569CD6;"> --save</span><span style="color:#CE9178;"> vue3-sketch-ruler</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>版本 1.3.15</p><p>完成之后突然发现它最近更新版本了到2.x，还没仔细看两个版本的区别，先写死老版本</p><p>引用</p><div class="language-typescript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-typescript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">SketchRule</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;vue3-sketch-ruler&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#CE9178;"> &#39;vue3-sketch-ruler/lib/style.css&#39;</span><span style="color:#D4D4D4;">;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="标尺配置" tabindex="-1"><a class="header-anchor" href="#标尺配置"><span>标尺配置</span></a></h5><p><strong>editRule.vue</strong></p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> state</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">reactive</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  scale:</span><span style="color:#B5CEA8;"> 0.4</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  startX:</span><span style="color:#B5CEA8;"> 0</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  startY:</span><span style="color:#B5CEA8;"> 0</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">  // 参考线</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  lines:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    h:</span><span style="color:#D4D4D4;"> [],</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    v:</span><span style="color:#D4D4D4;"> [],</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // h: [0, 1920],</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // v: [0, 1080]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  },</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  palette:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    bgColor:</span><span style="color:#CE9178;"> &#39;#18181c&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    longfgColor:</span><span style="color:#CE9178;"> &#39;#4d4d4d&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    shortfgColor:</span><span style="color:#CE9178;"> &#39;#4d4d4d&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    fontColor:</span><span style="color:#CE9178;"> &#39;#4d4d4d&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    shadowColor:</span><span style="color:#CE9178;"> &#39;#18181c&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    borderColor:</span><span style="color:#CE9178;"> &#39;#18181c&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    cornerActiveColor:</span><span style="color:#CE9178;"> &#39;#18181c&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  },</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  thick:</span><span style="color:#B5CEA8;"> 20</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  isShowRuler:</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// 显示标尺</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  isShowReferLine:</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// 显示参考线</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">});</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="组件" tabindex="-1"><a class="header-anchor" href="#组件"><span>组件</span></a></h5><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">  &lt;</span><span style="color:#569CD6;">div</span><span style="color:#9CDCFE;"> class</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;wrapper&quot;</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    &lt;!-- 滑动选择控制缩放比例 --&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#569CD6;">div</span><span style="color:#9CDCFE;"> class</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;toolBox&quot;</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">      &lt;</span><span style="color:#569CD6;">div</span><span style="color:#9CDCFE;"> class</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;scale&quot;</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">缩放比例:{{ cpuScale }}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">      &lt;</span><span style="color:#569CD6;">NSlider</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        v-model</span><span style="color:#D4D4D4;">:</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">scale</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        :</span><span style="color:#9CDCFE;">step</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">step</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        :</span><span style="color:#9CDCFE;">min</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">minScale</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        :</span><span style="color:#9CDCFE;">max</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">maxScale</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        :</span><span style="color:#9CDCFE;">on-update-value</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">scaleChange</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">      /&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    &lt;!-- 标尺 --&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#569CD6;">SketchRule</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      ref</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;sketchRuleRef&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      :</span><span style="color:#9CDCFE;">thick</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">thick</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      :</span><span style="color:#9CDCFE;">scale</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">scale</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      :</span><span style="color:#9CDCFE;">palette</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">palette</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      :</span><span style="color:#9CDCFE;">width</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">width</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      :</span><span style="color:#9CDCFE;">height</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">height</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      :</span><span style="color:#9CDCFE;">start-x</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">startX</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      :</span><span style="color:#9CDCFE;">start-y</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">startY</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      :</span><span style="color:#9CDCFE;">shadow</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">shadow</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      :</span><span style="color:#9CDCFE;">is-show-refer-line</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">isShowReferLine</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      :</span><span style="color:#9CDCFE;">lines</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">lines</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    /&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#569CD6;">div</span><span style="color:#9CDCFE;"> id</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;screens&quot;</span><span style="color:#9CDCFE;"> ref</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;screensRef&quot;</span><span style="color:#D4D4D4;"> @</span><span style="color:#9CDCFE;">wheel</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">handleWheel</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#D4D4D4;"> @</span><span style="color:#9CDCFE;">scroll</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">handleScroll</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">      &lt;!-- 可滚动内容区 --&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">      &lt;</span><span style="color:#569CD6;">div</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        ref</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;containerRef&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        class</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;screen-container&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        :</span><span style="color:#9CDCFE;">style</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#D4D4D4;">{</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">          width:</span><span style="color:#CE9178;"> \`</span><span style="color:#569CD6;">\${</span><span style="color:#9CDCFE;">width</span><span style="color:#D4D4D4;"> * </span><span style="color:#9CDCFE;">maxScale</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;">px\`</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">          height:</span><span style="color:#CE9178;"> \`</span><span style="color:#569CD6;">\${</span><span style="color:#9CDCFE;">height</span><span style="color:#D4D4D4;"> * </span><span style="color:#9CDCFE;">maxScale</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;">px\`</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">      &gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        &lt;!-- 大屏画布：水平垂直居中、元素缩放到相应比例 --&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">div</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">          id</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;canvas&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">          :</span><span style="color:#9CDCFE;">style</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#D4D4D4;">{</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            width:</span><span style="color:#9CDCFE;"> width</span><span style="color:#D4D4D4;"> + </span><span style="color:#CE9178;">&#39;px&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            height:</span><span style="color:#9CDCFE;"> height</span><span style="color:#D4D4D4;"> + </span><span style="color:#CE9178;">&#39;px&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            transform:</span><span style="color:#CE9178;"> \`scale(</span><span style="color:#569CD6;">\${</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">scale</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;">)\`</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">          }</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">          &lt;</span><span style="color:#569CD6;">slot</span><span style="color:#F44747;"> /</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">      &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">  &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>实现点阵背景</p><div class="language-css line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="css" data-title="css"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-css;"><code><span class="line"><span class="line"><span style="color:#D7BA7D;">.screen-container</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  position</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">absolute</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  top</span><span style="color:#D4D4D4;">: </span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  left</span><span style="color:#D4D4D4;">: </span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">  /* 实现点阵背景 */</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  background</span><span style="color:#D4D4D4;">: </span><span style="color:#DCDCAA;">radial-gradient</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">circle</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">#5a5a5a</span><span style="color:#B5CEA8;"> 0.5px</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">#000</span><span style="color:#B5CEA8;"> 0.5px</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  background-size</span><span style="color:#D4D4D4;">: </span><span style="color:#B5CEA8;">15px</span><span style="color:#B5CEA8;"> 15px</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>滚动条居中</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 滚动条居中，使可滚动内容区展示最中心位置，即可显示大屏画布</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#DCDCAA;"> canvasPosCenter</span><span style="color:#D4D4D4;"> = () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#4FC1FF;"> screensRect</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">screensRef</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">getBoundingClientRect</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#4FC1FF;"> containerRect</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">containerRef</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">getBoundingClientRect</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  screensRef</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">scrollLeft</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">Math</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">abs</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">containerRect</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">width</span><span style="color:#D4D4D4;"> - </span><span style="color:#9CDCFE;">screensRect</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">width</span><span style="color:#D4D4D4;">) / </span><span style="color:#B5CEA8;">2</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  screensRef</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">scrollTop</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">Math</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">abs</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">containerRect</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">height</span><span style="color:#D4D4D4;"> - </span><span style="color:#9CDCFE;">screensRect</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">height</span><span style="color:#D4D4D4;">) / </span><span style="color:#B5CEA8;">2</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">};</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">onMounted</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">  canvasPosCenter</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">});</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>鼠标滚动监听</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 鼠标滚动监听</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#DCDCAA;"> handleScroll</span><span style="color:#D4D4D4;"> = () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#4FC1FF;"> screensRect</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">document</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">querySelector</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;#screens&#39;</span><span style="color:#D4D4D4;">).</span><span style="color:#DCDCAA;">getBoundingClientRect</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#4FC1FF;"> canvasRect</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">document</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">querySelector</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;#canvas&#39;</span><span style="color:#D4D4D4;">).</span><span style="color:#DCDCAA;">getBoundingClientRect</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">  // 标尺开始的刻度</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#4FC1FF;"> startX</span><span style="color:#D4D4D4;"> = (</span><span style="color:#9CDCFE;">screensRect</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">left</span><span style="color:#D4D4D4;"> + </span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">thick</span><span style="color:#D4D4D4;"> - </span><span style="color:#9CDCFE;">canvasRect</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">left</span><span style="color:#D4D4D4;">) / </span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">scale</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#4FC1FF;"> startY</span><span style="color:#D4D4D4;"> = (</span><span style="color:#9CDCFE;">screensRect</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">top</span><span style="color:#D4D4D4;"> + </span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">thick</span><span style="color:#D4D4D4;"> - </span><span style="color:#9CDCFE;">canvasRect</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">top</span><span style="color:#D4D4D4;">) / </span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">scale</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">startX</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">startX</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">startY</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">startY</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">};</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3、画布动态缩放" tabindex="-1"><a class="header-anchor" href="#_3、画布动态缩放"><span>3、画布动态缩放</span></a></h4><p>使用<code>transform: scale()</code>对元素进行缩放（可以看2中贴的代码）</p><p><strong>editRule.vue</strong></p><p>进度条调整缩放</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 进度条调整缩放</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#DCDCAA;"> scaleChange</span><span style="color:#D4D4D4;"> = (</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">scale</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">Number</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">  nextTick</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    handleScroll</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    canvasPosCenter</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  });</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">sketchRuleRef</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">panzoomInstance</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> panzoomInstance</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">sketchRuleRef</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">panzoomInstance</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    panzoomInstance</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">zoom</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">scale</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">};</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>监听设置的大屏宽高自动计算缩放比例</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 监听设置的大屏宽高自动计算缩放比例</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">watch</span><span style="color:#D4D4D4;">(</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">width</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">height</span><span style="color:#D4D4D4;">],</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    nextTick</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">      if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">screensRef</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> screensRect</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">screensRef</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">getBoundingClientRect</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> fitWidth</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">screensRect</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">width</span><span style="color:#D4D4D4;"> - </span><span style="color:#B5CEA8;">100</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> fitHeight</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">screensRect</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">height</span><span style="color:#D4D4D4;"> - </span><span style="color:#B5CEA8;">100</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> scaleWidth</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">width</span><span style="color:#D4D4D4;"> &gt; </span><span style="color:#9CDCFE;">fitWidth</span><span style="color:#D4D4D4;"> ? </span><span style="color:#9CDCFE;">fitWidth</span><span style="color:#D4D4D4;"> / </span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">width</span><span style="color:#D4D4D4;"> : </span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> scaleHeight</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">height</span><span style="color:#D4D4D4;"> &gt; </span><span style="color:#9CDCFE;">fitHeight</span><span style="color:#D4D4D4;"> ? </span><span style="color:#9CDCFE;">fitHeight</span><span style="color:#D4D4D4;"> / </span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">height</span><span style="color:#D4D4D4;"> : </span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">scale</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">Number</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">Math</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">min</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">scaleWidth</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">scaleHeight</span><span style="color:#D4D4D4;">).</span><span style="color:#DCDCAA;">toFixed</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">2</span><span style="color:#D4D4D4;">));</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">      handleScroll</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">      canvasPosCenter</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    });</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    immediate:</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">);</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ctrl+鼠标滚动控制缩放值</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// ctrl+鼠标滚动控制缩放值</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#DCDCAA;"> handleWheel</span><span style="color:#D4D4D4;"> = (</span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">ctrlKey</span><span style="color:#D4D4D4;"> || </span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">metaKey</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    e</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">preventDefault</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> nextScale</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">Number</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">parseFloat</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">Math</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">max</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">minScale</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">scale</span><span style="color:#D4D4D4;"> - </span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">deltaY</span><span style="color:#D4D4D4;"> / </span><span style="color:#B5CEA8;">500</span><span style="color:#D4D4D4;">).</span><span style="color:#DCDCAA;">toFixed</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">2</span><span style="color:#D4D4D4;">));</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    state</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">scale</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">nextScale</span><span style="color:#D4D4D4;"> &gt; </span><span style="color:#9CDCFE;">maxScale</span><span style="color:#D4D4D4;"> ? </span><span style="color:#9CDCFE;">maxScale</span><span style="color:#D4D4D4;"> : </span><span style="color:#9CDCFE;">nextScale</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  }</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">  nextTick</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    handleScroll</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  });</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">};</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4、图表组件自定义" tabindex="-1"><a class="header-anchor" href="#_4、图表组件自定义"><span>4、图表组件自定义</span></a></h4><h5 id="组件定义" tabindex="-1"><a class="header-anchor" href="#组件定义"><span>组件定义</span></a></h5><p>以折线图为例</p><div class="language-css line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="css" data-title="css"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-css;"><code><span class="line"><span class="line"><span style="color:#D4D4D4;">├── LineChart</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">│   ├── config</span><span style="color:#D7BA7D;">.ts</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">相关配置</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">│   ├── </span><span style="color:#D7BA7D;">data.json</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">示例数据</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">│   ├── index</span><span style="color:#D7BA7D;">.vue</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">图表组件</span><span style="color:#D4D4D4;">]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">│   └── </span><span style="color:#D7BA7D;">option.vue</span><span style="color:#D4D4D4;"> [</span><span style="color:#9CDCFE;">图表配置组件</span><span style="color:#D4D4D4;">]</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>config.ts</strong> 相关配置文件，渲染时通过该数据进行模板渲染</p><div class="language-typescript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-typescript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">commonOption</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;../common&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> chartData</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;./data.json&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> chartOption</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  tooltip:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    trigger:</span><span style="color:#CE9178;"> &#39;axis&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  },</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  grid:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    containLabel:</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    left:</span><span style="color:#B5CEA8;"> 10</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    top:</span><span style="color:#B5CEA8;"> 20</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    right:</span><span style="color:#B5CEA8;"> 10</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    bottom:</span><span style="color:#B5CEA8;"> 10</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  },</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  xAxis:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    show:</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    type:</span><span style="color:#CE9178;"> &#39;category&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 坐标轴刻度标签</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    axisLabel:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      show:</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      color:</span><span style="color:#CE9178;"> &#39;#fff&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 轴线</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    axisLine:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      show:</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      lineStyle:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        color:</span><span style="color:#CE9178;"> &#39;#eee&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 刻度线</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    axisTick:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      show:</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      lineStyle:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        color:</span><span style="color:#CE9178;"> &#39;#eee&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 网格线</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    splitLine:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      show:</span><span style="color:#569CD6;"> false</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      lineStyle:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        color:</span><span style="color:#CE9178;"> &#39;#eee&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  },</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  yAxis:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    show:</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    type:</span><span style="color:#CE9178;"> &#39;value&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 坐标轴刻度标签</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    axisLabel:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      show:</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      color:</span><span style="color:#CE9178;"> &#39;#fff&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 轴线</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    axisLine:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      show:</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      lineStyle:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        color:</span><span style="color:#CE9178;"> &#39;#eee&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 刻度线</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    axisTick:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      show:</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      lineStyle:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        color:</span><span style="color:#CE9178;"> &#39;#eee&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 网格线</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    splitLine:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      show:</span><span style="color:#569CD6;"> false</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      lineStyle:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        color:</span><span style="color:#CE9178;"> &#39;#eee&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  },</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  series:</span><span style="color:#569CD6;"> new</span><span style="color:#DCDCAA;"> Array</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">chartData</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">dimensions</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">length</span><span style="color:#D4D4D4;"> - </span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">).</span><span style="color:#DCDCAA;">fill</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">).</span><span style="color:#DCDCAA;">map</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">_</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> ({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    type:</span><span style="color:#CE9178;"> &#39;line&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    itemStyle:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      color:</span><span style="color:#569CD6;"> null</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  })),</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">};</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> chartConfig</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  chartKey:</span><span style="color:#CE9178;"> &#39;LineChart&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  chartName:</span><span style="color:#CE9178;"> &#39;折线图&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  width:</span><span style="color:#B5CEA8;"> 500</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  height:</span><span style="color:#B5CEA8;"> 300</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  chartOption</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  chartData</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">};</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#C586C0;"> default</span><span style="color:#9CDCFE;"> chartConfig</span><span style="color:#D4D4D4;">;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="全局注册图表及图表配置组件-已修改成使用动态注册组件" tabindex="-1"><a class="header-anchor" href="#全局注册图表及图表配置组件-已修改成使用动态注册组件"><span><s><strong>全局注册图表及图表配置组件（已修改成使用动态注册组件）</strong></s></span></a></h5><p>plugins/customComponents.ts</p><div class="language-python line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-python;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#4EC9B0;"> type</span><span style="color:#D4D4D4;"> { App } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;vue&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> BaseLineChart </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;@/components/Charts/BaseLineChart/index.vue&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> BaseBarChart </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;@/components/Charts/BaseBarChart/index.vue&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> BaseLineChartOption </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;@/components/Charts/BaseLineChart/option.vue&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> BaseBarChartOption </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;@/components/Charts/BaseBarChart/option.vue&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">/**</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;"> * 全局注册自定义组件</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;"> *</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;"> * @param app</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;"> */</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">export function setupCustomComponents(app: App) {</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  // 注册图表组件</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  app.component(</span><span style="color:#CE9178;">&#39;BaseLineChart&#39;</span><span style="color:#D4D4D4;">, BaseLineChart);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  app.component(</span><span style="color:#CE9178;">&#39;BaseBarChart&#39;</span><span style="color:#D4D4D4;">, BaseBarChart);</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  // 注册图表配置组件</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  app.component(</span><span style="color:#CE9178;">&#39;BaseLineChartOption&#39;</span><span style="color:#D4D4D4;">, BaseLineChartOption);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  app.component(</span><span style="color:#CE9178;">&#39;BaseBarChartOption&#39;</span><span style="color:#D4D4D4;">, BaseBarChartOption);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>main.ts</p><div class="language-typescript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-typescript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">setupCustomComponents</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;@/plugins&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">...</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> app</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">createApp</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">App</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 注册全局自定义组件</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">setupCustomComponents</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">app</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">...</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="动态注册图表及图表配置组件" tabindex="-1"><a class="header-anchor" href="#动态注册图表及图表配置组件"><span>动态注册图表及图表配置组件</span></a></h5><p><strong>@/components/Charts/utils.ts</strong></p><p>定义动态获取组件方法</p><blockquote><p><strong>import.meta.glob</strong>是Vite中的一个特殊功能，它允许开发者从文件系统中导入多个模块。</p></blockquote><div class="language-typescript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-typescript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 从文件系统导入多个模块</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> indexModules</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">Record</span><span style="color:#D4D4D4;">&lt;</span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">default</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;"> }&gt; = </span><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">meta</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">glob</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;./**/index.vue&#39;</span><span style="color:#D4D4D4;">, {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  eager:</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">, </span><span style="color:#6A9955;">// 直接引入所有的模块</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">});</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> optionModules</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">Record</span><span style="color:#D4D4D4;">&lt;</span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">, { </span><span style="color:#9CDCFE;">default</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;"> }&gt; = </span><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">meta</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">glob</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;./**/option.vue&#39;</span><span style="color:#D4D4D4;">, {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  eager:</span><span style="color:#569CD6;"> true</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">});</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 获取组件</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#569CD6;"> const</span><span style="color:#DCDCAA;"> fetchComponent</span><span style="color:#D4D4D4;"> = (</span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">type</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">type</span><span style="color:#D4D4D4;"> === </span><span style="color:#CE9178;">&#39;option&#39;</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    return</span><span style="color:#9CDCFE;"> optionModules</span><span style="color:#D4D4D4;">[</span><span style="color:#CE9178;">\`./</span><span style="color:#569CD6;">\${</span><span style="color:#9CDCFE;">key</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;">/option.vue\`</span><span style="color:#D4D4D4;">].</span><span style="color:#9CDCFE;">default</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  }</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  return</span><span style="color:#9CDCFE;"> indexModules</span><span style="color:#D4D4D4;">[</span><span style="color:#CE9178;">\`./</span><span style="color:#569CD6;">\${</span><span style="color:#9CDCFE;">key</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;">/index.vue\`</span><span style="color:#D4D4D4;">].</span><span style="color:#9CDCFE;">default</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">};</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 动态注册图表和图表配置组件</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#569CD6;"> const</span><span style="color:#DCDCAA;"> registerComponent</span><span style="color:#D4D4D4;"> = (</span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  if</span><span style="color:#D4D4D4;"> (!</span><span style="color:#9CDCFE;">window</span><span style="color:#D4D4D4;">[</span><span style="color:#CE9178;">&#39;$vue&#39;</span><span style="color:#D4D4D4;">].</span><span style="color:#DCDCAA;">component</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">)) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    window</span><span style="color:#D4D4D4;">[</span><span style="color:#CE9178;">&#39;$vue&#39;</span><span style="color:#D4D4D4;">].</span><span style="color:#DCDCAA;">component</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">, </span><span style="color:#DCDCAA;">fetchComponent</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;chart&#39;</span><span style="color:#D4D4D4;">));</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  }</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  if</span><span style="color:#D4D4D4;"> (!</span><span style="color:#9CDCFE;">window</span><span style="color:#D4D4D4;">[</span><span style="color:#CE9178;">&#39;$vue&#39;</span><span style="color:#D4D4D4;">].</span><span style="color:#DCDCAA;">component</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;"> + </span><span style="color:#CE9178;">&#39;Option&#39;</span><span style="color:#D4D4D4;">)) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    window</span><span style="color:#D4D4D4;">[</span><span style="color:#CE9178;">&#39;$vue&#39;</span><span style="color:#D4D4D4;">].</span><span style="color:#DCDCAA;">component</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;"> + </span><span style="color:#CE9178;">&#39;Option&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#DCDCAA;">fetchComponent</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;option&#39;</span><span style="color:#D4D4D4;">));</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">};</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>main.ts</strong></p><p>将app挂载到window上</p><div class="language-typescript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-typescript;"><code><span class="line"><span class="line"><span style="color:#D4D4D4;">...</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">async</span><span style="color:#569CD6;"> function</span><span style="color:#DCDCAA;"> bootstrap</span><span style="color:#D4D4D4;">() {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#4FC1FF;"> app</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">createApp</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">App</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  ...</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  app</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">mount</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;#app&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#569CD6;">true</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">  // 挂载到 window</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  (</span><span style="color:#9CDCFE;">window</span><span style="color:#C586C0;"> as</span><span style="color:#4EC9B0;"> any</span><span style="color:#D4D4D4;">).</span><span style="color:#9CDCFE;">$vue</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">app</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">void</span><span style="color:#DCDCAA;"> bootstrap</span><span style="color:#D4D4D4;">();</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>组件库拖拽或双击组件时动态注册组件</p><p>具体可以看第7点</p><div class="language-typescript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-typescript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">registerComponent</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;@/components/Charts/utils&#39;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 鼠标双击添加图表实例</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> dblclickHandle</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#4FC1FF;"> newItem</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ...</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    x:</span><span style="color:#B5CEA8;"> 0</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    y:</span><span style="color:#B5CEA8;"> 0</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    id:</span><span style="color:#9CDCFE;"> Math</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">random</span><span style="color:#D4D4D4;">().</span><span style="color:#DCDCAA;">toFixed</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">6</span><span style="color:#D4D4D4;">).</span><span style="color:#DCDCAA;">slice</span><span style="color:#D4D4D4;">(-</span><span style="color:#B5CEA8;">6</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  };</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">  registerComponent</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">newItem</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">chartKey</span><span style="color:#D4D4D4;">); </span><span style="color:#6A9955;">// 动态注册图表和图表配置组件</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  chartEditStore</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">addComponentList</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">newItem</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  selectComponent</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">newItem</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5、画布上组件渲染" tabindex="-1"><a class="header-anchor" href="#_5、画布上组件渲染"><span>5、画布上组件渲染</span></a></h4><h5 id="数据准备" tabindex="-1"><a class="header-anchor" href="#数据准备"><span>数据准备</span></a></h5><p>先把折线图组件中的config数据mock一份到designData.componentList中，为在画布上渲染组件做好数据准备</p><p><strong>store/modules/chartEdit.ts</strong></p><div class="language-typescript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-typescript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">defineStore</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;pinia&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">reactive</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;vue&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> bg</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;@/assets/bg.jpg&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#569CD6;"> const</span><span style="color:#4FC1FF;"> useChartEditStore</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">defineStore</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;chartEditStore&#39;</span><span style="color:#D4D4D4;">, () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">  // 大屏数据</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#4FC1FF;"> designData</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">reactive</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 画布属性</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    canvasConfig:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      id:</span><span style="color:#569CD6;"> undefined</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      name:</span><span style="color:#CE9178;"> &#39;首页&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      width:</span><span style="color:#B5CEA8;"> 1920</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      height:</span><span style="color:#B5CEA8;"> 1080</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      backgroundType:</span><span style="color:#CE9178;"> &#39;color&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      backgroundColor:</span><span style="color:#CE9178;"> &#39;#232324&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      backgroundImageUrl:</span><span style="color:#9CDCFE;"> bg</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">    // 图表数组</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    componentList:</span><span style="color:#D4D4D4;"> [ </span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">      // MOCK</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        id:</span><span style="color:#B5CEA8;"> 1</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        chartKey:</span><span style="color:#CE9178;"> &#39;LineChart&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        chartName:</span><span style="color:#CE9178;"> &#39;折线图&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        x:</span><span style="color:#B5CEA8;"> 300</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        y:</span><span style="color:#B5CEA8;"> 300</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        width:</span><span style="color:#B5CEA8;"> 500</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        height:</span><span style="color:#B5CEA8;"> 300</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        chartOption:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">          ...</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        },</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        chartData:</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">          ...</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  });</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  return</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    designData</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ...</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  };</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">});</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="自定义组件动态渲染" tabindex="-1"><a class="header-anchor" href="#自定义组件动态渲染"><span>自定义组件动态渲染</span></a></h5><p><strong>editContent.vue</strong></p><p>重点：通过<code>component</code>的<code>is</code>渲染对应名字的组件</p><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">script</span><span style="color:#9CDCFE;"> setup</span><span style="color:#9CDCFE;"> lang</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;jsx&quot;</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">useChartEditStore</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;@/store/modules/chartEdit&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> chartEditStore</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useChartEditStore</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> { </span><span style="color:#4FC1FF;">canvasConfig</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">componentList</span><span style="color:#D4D4D4;"> } = </span><span style="color:#9CDCFE;">chartEditStore</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">designData</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">...</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">script</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">...</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">      &lt;!-- 使用canvasConfig设置大屏基本配置 --&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">      &lt;</span><span style="color:#569CD6;">div</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">        class</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;web-container&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        :</span><span style="color:#9CDCFE;">style</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#D4D4D4;">{</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">          width:</span><span style="color:#9CDCFE;"> canvasConfig</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">width</span><span style="color:#D4D4D4;"> + </span><span style="color:#CE9178;">&#39;px&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">          height:</span><span style="color:#9CDCFE;"> canvasConfig</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">height</span><span style="color:#D4D4D4;"> + </span><span style="color:#CE9178;">&#39;px&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">          background:</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">            canvasConfig</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">backgroundType</span><span style="color:#D4D4D4;"> === </span><span style="color:#CE9178;">&#39;color&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">              ? </span><span style="color:#9CDCFE;">canvasConfig</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">backgroundColor</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">              : </span><span style="color:#CE9178;">\`url(</span><span style="color:#569CD6;">\${</span><span style="color:#9CDCFE;">canvasConfig</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">backgroundImageUrl</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;">) no-repeat 100% 100%\`</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">           ...</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">      &gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">        &lt;!-- 图表数组遍历 --&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">div</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">          v-for</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">in</span><span style="color:#9CDCFE;"> componentList</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">          :</span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">          class</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;edit-content-chart&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#F44747;">          &lt;!--</span><span style="color:#9CDCFE;"> 设置图标实例的位置和尺寸</span><span style="color:#9CDCFE;"> --</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">          :style=&quot;{</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            top: item.y + &#39;px&#39;,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            left: item.x + &#39;px&#39;,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            width: item.width + &#39;px&#39;,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">            height: item.height + &#39;px&#39;,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">          }&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">             ...</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        &gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">          ...</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">            &lt;!-- 渲染自定义图标组件 --&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            &lt;</span><span style="color:#569CD6;">component</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">              :</span><span style="color:#9CDCFE;">is</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">chartKey</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">              :</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">              :</span><span style="color:#9CDCFE;">width</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">width</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">              :</span><span style="color:#9CDCFE;">height</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">height</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">              :</span><span style="color:#9CDCFE;">chart-option</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">chartOption</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">              :</span><span style="color:#9CDCFE;">chart-data</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">chartData</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">            /&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">      &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6、左侧组件库" tabindex="-1"><a class="header-anchor" href="#_6、左侧组件库"><span>6、左侧组件库</span></a></h4><p>Charts/index.ts 集合各自定义图表的配置文件并导出</p><div class="language-typescript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-typescript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> BarChart</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;./BarChart/config&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> LineChart</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;./LineChart/config&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> PieChart</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;./PieChart/config&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">...</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">export</span><span style="color:#569CD6;"> const</span><span style="color:#4FC1FF;"> ChartList</span><span style="color:#D4D4D4;"> = [</span><span style="color:#9CDCFE;">BarChart</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">LineChart</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">PieChart</span><span style="color:#D4D4D4;">...];</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>对自定义组件列表进行遍历展示</p><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">n-grid</span><span style="color:#D4D4D4;"> :</span><span style="color:#9CDCFE;">x-gap</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#B5CEA8;">10</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#D4D4D4;"> :</span><span style="color:#9CDCFE;">y-gap</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#B5CEA8;">10</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#D4D4D4;"> :</span><span style="color:#9CDCFE;">cols</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#B5CEA8;">2</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  &lt;n-grid-item v-for=&quot;item in ChartList&quot; :key=&quot;item.chartKey&quot;&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    &lt;NButton :style=&quot;{ width: &#39;100%&#39; }&quot; ...&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      {{ item.chartName }}</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    &lt;/NButton&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  &lt;/n-grid-item&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">n-grid</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_7、从组件库拖拽组件到画布上、鼠标双击后渲染到画布上" tabindex="-1"><a class="header-anchor" href="#_7、从组件库拖拽组件到画布上、鼠标双击后渲染到画布上"><span>7、从组件库拖拽组件到画布上、鼠标双击后渲染到画布上</span></a></h4><p>在组件库按钮上绑定拖拽事件、鼠标双击事件</p><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">NButton</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  draggable</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;true&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  @</span><span style="color:#9CDCFE;">dragstart</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#DCDCAA;"> dragStart</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">)</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  @</span><span style="color:#9CDCFE;">dblclick</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#DCDCAA;">dblclickHandle</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">)</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  :</span><span style="color:#9CDCFE;">style</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#D4D4D4;">{ </span><span style="color:#9CDCFE;">width:</span><span style="color:#CE9178;"> &#39;100%&#39;</span><span style="color:#D4D4D4;"> }</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  {{ item.chartName }}</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">NButton</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="拖拽" tabindex="-1"><a class="header-anchor" href="#拖拽"><span>拖拽</span></a></h5><p>1、监听拖拽事件，将对应图表组件的配置数据赋给dragData</p><p>注意：这里需要深拷贝</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> dragStart</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">_</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  dragData</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">cloneDeep</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2、在大屏对应元素上绑定dragover和drop事件</p><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">div</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">     class</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;web-container&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">     ...</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">     @</span><span style="color:#9CDCFE;">dragover</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#9CDCFE;"> e</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">preventDefault</span><span style="color:#D4D4D4;">()</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">     @</span><span style="color:#9CDCFE;">drop</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">drop</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3、拖拽结束，添加实例到图表数组</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 组件库组件拖拽放入画布</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> drop</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#4FC1FF;"> newComponent</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ...</span><span style="color:#9CDCFE;">dragData</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    x:</span><span style="color:#9CDCFE;"> e</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">offsetX</span><span style="color:#D4D4D4;"> - </span><span style="color:#9CDCFE;">dragData</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">width</span><span style="color:#D4D4D4;"> / </span><span style="color:#B5CEA8;">2</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    y:</span><span style="color:#9CDCFE;"> e</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">offsetY</span><span style="color:#D4D4D4;"> - </span><span style="color:#9CDCFE;">dragData</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">height</span><span style="color:#D4D4D4;"> / </span><span style="color:#B5CEA8;">2</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    id:</span><span style="color:#9CDCFE;"> Math</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">random</span><span style="color:#D4D4D4;">().</span><span style="color:#DCDCAA;">toFixed</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">6</span><span style="color:#D4D4D4;">).</span><span style="color:#DCDCAA;">slice</span><span style="color:#D4D4D4;">(-</span><span style="color:#B5CEA8;">6</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  };</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">  registerComponent</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">newComponent</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">chartKey</span><span style="color:#D4D4D4;">); </span><span style="color:#6A9955;">// 动态注册图表和图表配置组件</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  chartEditStore</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">addComponentList</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">newComponent</span><span style="color:#D4D4D4;">); </span><span style="color:#6A9955;">// 添加实例到图表数组</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  dragData</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;"> = {}; </span><span style="color:#6A9955;">// 清空拖拽数据</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  selectComponent</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">newComponent</span><span style="color:#D4D4D4;">; </span><span style="color:#6A9955;">// 更新当前选中的图表实例</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="鼠标双击" tabindex="-1"><a class="header-anchor" href="#鼠标双击"><span>鼠标双击</span></a></h5><p>鼠标双击添加图表实例</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 鼠标双击添加图表实例</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> dblclickHandle</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#4FC1FF;"> newItem</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ...</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    x:</span><span style="color:#B5CEA8;"> 0</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    y:</span><span style="color:#B5CEA8;"> 0</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    id:</span><span style="color:#9CDCFE;"> Math</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">random</span><span style="color:#D4D4D4;">().</span><span style="color:#DCDCAA;">toFixed</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">6</span><span style="color:#D4D4D4;">).</span><span style="color:#DCDCAA;">slice</span><span style="color:#D4D4D4;">(-</span><span style="color:#B5CEA8;">6</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  };</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">  registerComponent</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">newItem</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">chartKey</span><span style="color:#D4D4D4;">); </span><span style="color:#6A9955;">// 动态注册图表和图表配置组件</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  chartEditStore</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">addComponentList</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">newItem</span><span style="color:#D4D4D4;">); </span><span style="color:#6A9955;">// 添加实例到图表数组</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  selectComponent</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">newItem</span><span style="color:#D4D4D4;">; </span><span style="color:#6A9955;">// 更新当前选中的图表实例</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_8、画布上的图表实例拖拽移动" tabindex="-1"><a class="header-anchor" href="#_8、画布上的图表实例拖拽移动"><span>8、画布上的图表实例拖拽移动</span></a></h4><p>在遍历组件上绑定mousedown事件</p><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">div</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">          v-for</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">in</span><span style="color:#9CDCFE;"> componentList</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">          :</span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">id</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">          @</span><span style="color:#9CDCFE;">mousedown</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#DCDCAA;"> handleMouseDown</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;">)</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">     ...</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">        &gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>监听鼠标按下和放开事件，计算移动距离</strong></p><p>注意：计算时要考虑缩放比例</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 图表实例拖拽移动</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> handleMouseDown</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#DCDCAA;"> mousemove</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">event</span><span style="color:#569CD6;"> =&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> x</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">x</span><span style="color:#D4D4D4;"> + (</span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">clientX</span><span style="color:#D4D4D4;"> - </span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">clientX</span><span style="color:#D4D4D4;">) / </span><span style="color:#9CDCFE;">canvasScale</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> y</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">y</span><span style="color:#D4D4D4;"> + (</span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">clientY</span><span style="color:#D4D4D4;"> - </span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">clientY</span><span style="color:#D4D4D4;">) / </span><span style="color:#9CDCFE;">canvasScale</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    chartEditStore</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">updateComponent</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;">, {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      x:</span><span style="color:#9CDCFE;"> Math</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">round</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">x</span><span style="color:#D4D4D4;">),</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      y:</span><span style="color:#9CDCFE;"> Math</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">round</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">y</span><span style="color:#D4D4D4;">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    });</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  };</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#DCDCAA;"> mouseup</span><span style="color:#D4D4D4;"> = () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    document</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">removeEventListener</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;mousemove&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">mousemove</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    document</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">removeEventListener</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;mouseup&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">mouseup</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  };</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  document</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">addEventListener</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;mousemove&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">mousemove</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  document</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">addEventListener</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;mouseup&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">mouseup</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_9、画布上的图表实例放大缩小" tabindex="-1"><a class="header-anchor" href="#_9、画布上的图表实例放大缩小"><span>9、画布上的图表实例放大缩小</span></a></h4><p>editResize.vue</p><p><strong>定义及渲染8个方向的锚点，并绑定mousedown事件</strong></p><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">script</span><span style="color:#9CDCFE;"> setup</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  ...</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 锚点</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> pointList</span><span style="color:#D4D4D4;"> = [</span><span style="color:#CE9178;">&#39;t&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;r&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;b&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;l&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;lt&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;rt&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;lb&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;rb&#39;</span><span style="color:#D4D4D4;">];</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 光标朝向</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> cursorResize</span><span style="color:#D4D4D4;"> = [</span><span style="color:#CE9178;">&#39;n&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;e&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;s&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;w&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;nw&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;ne&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;sw&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;se&#39;</span><span style="color:#D4D4D4;">];</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">...</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">script</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">  &lt;</span><span style="color:#569CD6;">div</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">    v-for</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">point</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">in</span><span style="color:#9CDCFE;"> selected</span><span style="color:#D4D4D4;"> ? </span><span style="color:#9CDCFE;">pointList</span><span style="color:#D4D4D4;"> : []</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    :</span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    :</span><span style="color:#9CDCFE;">class</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#CE9178;">\`shape-point </span><span style="color:#569CD6;">\${</span><span style="color:#9CDCFE;">point</span><span style="color:#569CD6;">}</span><span style="color:#CE9178;">\`</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    :</span><span style="color:#9CDCFE;">style</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#DCDCAA;">getPointStyle</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">point</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;">)</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    @</span><span style="color:#9CDCFE;">mousedown</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#DCDCAA;">handleMouseDown</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">$event</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">point</span><span style="color:#D4D4D4;">)</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#F44747;">  /</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">  &lt;</span><span style="color:#569CD6;">slot</span><span style="color:#F44747;"> /</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>监听鼠标按下和放开事件，计算移动距离，从而计算出新尺寸</strong></p><p>注意：计算时要考虑缩放比例</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#6A9955;">// 移动锚点</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">function</span><span style="color:#DCDCAA;"> handleMouseDown</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">point</span><span style="color:#D4D4D4;">) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  e</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">stopPropagation</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  e</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">preventDefault</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#D4D4D4;"> { </span><span style="color:#4FC1FF;">x</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">y</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">width</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">height</span><span style="color:#D4D4D4;"> } = </span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#DCDCAA;"> mousemove</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">event</span><span style="color:#569CD6;"> =&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> moveX</span><span style="color:#D4D4D4;"> = (</span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">clientX</span><span style="color:#D4D4D4;"> - </span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">clientX</span><span style="color:#D4D4D4;">) / </span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">scale</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> moveY</span><span style="color:#D4D4D4;"> = (</span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">clientY</span><span style="color:#D4D4D4;"> - </span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">clientY</span><span style="color:#D4D4D4;">) / </span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">scale</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> isTop</span><span style="color:#D4D4D4;"> =</span><span style="color:#D16969;"> /t/</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">test</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">point</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> isBottom</span><span style="color:#D4D4D4;"> =</span><span style="color:#D16969;"> /b/</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">test</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">point</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> isLeft</span><span style="color:#D4D4D4;"> =</span><span style="color:#D16969;"> /l/</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">test</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">point</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> isRight</span><span style="color:#D4D4D4;"> =</span><span style="color:#D16969;"> /r/</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">test</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">point</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> newWidth</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">width</span><span style="color:#D4D4D4;"> + (</span><span style="color:#9CDCFE;">isLeft</span><span style="color:#D4D4D4;"> ? -</span><span style="color:#9CDCFE;">moveX</span><span style="color:#D4D4D4;"> : </span><span style="color:#9CDCFE;">isRight</span><span style="color:#D4D4D4;"> ? </span><span style="color:#9CDCFE;">moveX</span><span style="color:#D4D4D4;"> : </span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> newHeight</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">height</span><span style="color:#D4D4D4;"> + (</span><span style="color:#9CDCFE;">isTop</span><span style="color:#D4D4D4;"> ? -</span><span style="color:#9CDCFE;">moveY</span><span style="color:#D4D4D4;"> : </span><span style="color:#9CDCFE;">isBottom</span><span style="color:#D4D4D4;"> ? </span><span style="color:#9CDCFE;">moveY</span><span style="color:#D4D4D4;"> : </span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> data</span><span style="color:#D4D4D4;"> = {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      width:</span><span style="color:#9CDCFE;"> newWidth</span><span style="color:#D4D4D4;"> &gt; </span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;"> ? </span><span style="color:#9CDCFE;">Math</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">round</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">newWidth</span><span style="color:#D4D4D4;">) : </span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      height:</span><span style="color:#9CDCFE;"> newHeight</span><span style="color:#D4D4D4;"> &gt; </span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;"> ? </span><span style="color:#9CDCFE;">Math</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">round</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">newHeight</span><span style="color:#D4D4D4;">) : </span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      x:</span><span style="color:#9CDCFE;"> Math</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">round</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">x</span><span style="color:#D4D4D4;"> + (</span><span style="color:#9CDCFE;">isLeft</span><span style="color:#D4D4D4;"> ? </span><span style="color:#9CDCFE;">moveX</span><span style="color:#D4D4D4;"> : </span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">)),</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      y:</span><span style="color:#9CDCFE;"> Math</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">round</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">y</span><span style="color:#D4D4D4;"> + (</span><span style="color:#9CDCFE;">isTop</span><span style="color:#D4D4D4;"> ? </span><span style="color:#9CDCFE;">moveY</span><span style="color:#D4D4D4;"> : </span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">))</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    };</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    chartEditStore</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">updateComponent</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">props</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">i</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">data</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  };</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#DCDCAA;"> mouseup</span><span style="color:#D4D4D4;"> = () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    document</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">removeEventListener</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;mousemove&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">mousemove</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    document</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">removeEventListener</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;mouseup&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">mouseup</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  };</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  document</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">addEventListener</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;mousemove&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">mousemove</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  document</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">addEventListener</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;mouseup&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">mouseup</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_10、右侧画布编辑器" tabindex="-1"><a class="header-anchor" href="#_10、右侧画布编辑器"><span>10、右侧画布编辑器</span></a></h4><h4 id="_11、右侧图表编辑器" tabindex="-1"><a class="header-anchor" href="#_11、右侧图表编辑器"><span>11、右侧图表编辑器</span></a></h4><h5 id="基础配置" tabindex="-1"><a class="header-anchor" href="#基础配置"><span>基础配置</span></a></h5><p>名称、定位、尺寸、距离</p><h5 id="图表样式编辑" tabindex="-1"><a class="header-anchor" href="#图表样式编辑"><span>图表样式编辑</span></a></h5><p>x轴、y轴、图例、提示框、具体图表样式等</p><p>同画布中图表组件渲染方式，使用<code>component</code>动态渲染图表配置组件</p><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#808080;">  &lt;</span><span style="color:#569CD6;">NTabPane</span><span style="color:#9CDCFE;"> name</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;chart&quot;</span><span style="color:#9CDCFE;"> tab</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;图表&quot;</span><span style="color:#9CDCFE;"> class</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;configPaneWrapper&quot;</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    &lt;NForm label-placement=&quot;left&quot; label-width=&quot;100&quot; :model=&quot;selectComponent.value&quot;&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      &lt;!-- 各图表实例相关配置 --&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      &lt;component</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        :is=&quot;selectComponent.value.chartKey + &#39;Option&#39;&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        :config=&quot;selectComponent.value.chartOption&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      /&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    &lt;/NForm&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">  &lt;/</span><span style="color:#569CD6;">NTabPane</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="图表数据编辑" tabindex="-1"><a class="header-anchor" href="#图表数据编辑"><span>图表数据编辑</span></a></h5><p><strong>代码编辑器 monaco-editor</strong></p><p>安装</p><div class="language-bash line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-bash;"><code><span class="line"><span class="line"><span style="color:#DCDCAA;">pnpm</span><span style="color:#CE9178;"> add</span><span style="color:#CE9178;"> monaco-editor</span><span style="color:#569CD6;"> -S</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">pnpm</span><span style="color:#CE9178;"> add</span><span style="color:#CE9178;"> vite-plugin-monaco-editor</span><span style="color:#569CD6;"> -D</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>插件引入</strong></p><p>vite.config.ts</p><div class="language-typescript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-typescript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> monacoEditorPlugin</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;vite-plugin-monaco-editor&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">...</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  ...</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  plugins</span><span style="color:#D4D4D4;">: [</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    ...,</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    monacoEditorPlugin</span><span style="color:#D4D4D4;">({</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      languageWorkers:</span><span style="color:#D4D4D4;"> [</span><span style="color:#CE9178;">&#39;editorWorkerService&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;typescript&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;json&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;html&#39;</span><span style="color:#D4D4D4;">],</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">      customWorkers:</span><span style="color:#D4D4D4;"> [</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">          label:</span><span style="color:#CE9178;"> &#39;graphql&#39;</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">          entry:</span><span style="color:#CE9178;"> &#39;monaco-graphql/dist/graphql.worker&#39;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">        }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">      ]</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    })</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  ],</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">}</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">...</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>创建组件</strong></p><p>具体看 components/MonacoEditor</p><p><strong>使用MonacoEditor</strong></p><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">NTabPane</span><span style="color:#9CDCFE;"> name</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;data&quot;</span><span style="color:#9CDCFE;"> tab</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;数据&quot;</span><span style="color:#9CDCFE;"> class</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;configPaneWrapper&quot;</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  &lt;MonacoEditor</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    v-model:modelValue=&quot;editJson&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    language=&quot;json&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">    height=&quot;calc(100% - 45px)&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  /&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  &lt;NButton class=&quot;mt-[10px] w-full&quot; size=&quot;medium&quot; type=&quot;primary&quot; @click=&quot;updateComponentData&quot;&gt;更新数据&lt;/NButton&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">NTabPane</span><span style="color:#808080;">&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>chartData 传入代码编辑器前需要先转成字符串，更新数据后再转回成对象</p><div class="language-javascript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-javascript;"><code><span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">ref</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">watch</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;vue&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">useChartEditStore</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;@/store/modules/chartEdit&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#9CDCFE;"> MonacoEditor</span><span style="color:#C586C0;"> from</span><span style="color:#CE9178;"> &#39;@/components/MonacoEditor/index.vue&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> editJson</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">ref</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;&#39;</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> chartEditStore</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">useChartEditStore</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> { </span><span style="color:#4FC1FF;">selectComponent</span><span style="color:#D4D4D4;"> } = </span><span style="color:#9CDCFE;">chartEditStore</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> { </span><span style="color:#4FC1FF;">canvasConfig</span><span style="color:#D4D4D4;"> } = </span><span style="color:#9CDCFE;">chartEditStore</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">designData</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">watch</span><span style="color:#D4D4D4;">(</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#9CDCFE;"> selectComponent</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">?.</span><span style="color:#9CDCFE;">chartData</span><span style="color:#D4D4D4;">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    editJson</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;"> = </span><span style="color:#4FC1FF;">JSON</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">stringify</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">selectComponent</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">chartData</span><span style="color:#D4D4D4;">, </span><span style="color:#569CD6;">null</span><span style="color:#D4D4D4;">, </span><span style="color:#B5CEA8;">2</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#DCDCAA;"> updateComponentData</span><span style="color:#D4D4D4;"> = () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  selectComponent</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">chartData</span><span style="color:#D4D4D4;"> = </span><span style="color:#4FC1FF;">JSON</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">parse</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">editJson</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">};</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_12、大屏预览" tabindex="-1"><a class="header-anchor" href="#_12、大屏预览"><span>12、大屏预览</span></a></h4><p>注意：还要计算一下比例进行适配</p><h4 id="_13、图层切换" tabindex="-1"><a class="header-anchor" href="#_13、图层切换"><span>13、图层切换</span></a></h4><p>切换选中图层、复制、删除</p><h5 id="使用xicons图标库的图标" tabindex="-1"><a class="header-anchor" href="#使用xicons图标库的图标"><span>使用xicons图标库的图标</span></a></h5><p>Xicons：https://xicons.org/#/</p><p>安装对应库</p><p>例：使用antd风格的icon</p><div class="language-bash line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-bash;"><code><span class="line"><span class="line"><span style="color:#DCDCAA;">npm</span><span style="color:#CE9178;"> i</span><span style="color:#569CD6;"> -D</span><span style="color:#CE9178;"> @vicons/antd</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>引入对应的icon组件</p><div class="language-vue line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="vue" data-title="vue"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-vue;"><code><span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">script</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">CopyOutlined</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;@vicons/antd&#39;</span><span style="color:#D4D4D4;">;</span></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">script</span><span style="color:#808080;">&gt;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">n-icon</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  class</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;text-icon&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  :</span><span style="color:#9CDCFE;">component</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">CopyOutlined</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  @</span><span style="color:#9CDCFE;">click</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#DCDCAA;"> handleCopy</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">item</span><span style="color:#D4D4D4;">)</span><span style="color:#D4D4D4;">&quot;</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">/&gt;</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_14、保存" tabindex="-1"><a class="header-anchor" href="#_14、保存"><span>14、保存</span></a></h4><div class="language-bash line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-bash;"><code><span class="line"><span class="line"><span style="color:#DCDCAA;">npm</span><span style="color:#CE9178;"> i</span><span style="color:#CE9178;"> html2canvas</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>dom转canvas图片并上传</p><p>定时保存、ctrl+s保存</p><div class="language-typescript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre class="shiki dark-plus vp-code" style="background-color:#1E1E1E;color:#D4D4D4 language-typescript;"><code><span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> saveInterval</span><span style="color:#D4D4D4;"> = </span><span style="color:#B5CEA8;">300</span><span style="color:#D4D4D4;">; </span><span style="color:#6A9955;">// 工作台自动保存间隔（s）</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 定时保存</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#DCDCAA;"> intervalDataSyncUpdate</span><span style="color:#D4D4D4;"> = () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">  // 定时获取数据</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">  const</span><span style="color:#4FC1FF;"> syncTiming</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">setInterval</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    handleSave</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  }, </span><span style="color:#9CDCFE;">saveInterval</span><span style="color:#D4D4D4;"> * </span><span style="color:#B5CEA8;">1000</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">  // 销毁</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">  onUnmounted</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    clearInterval</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">syncTiming</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  });</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">};</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#6A9955;">// 监听 ctrl+s 保存事件</span></span></span>
<span class="line"><span class="line"><span style="color:#569CD6;">const</span><span style="color:#DCDCAA;"> handleEvent</span><span style="color:#D4D4D4;"> = (</span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">any</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#C586C0;">  if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;"> === </span><span style="color:#CE9178;">&#39;s&#39;</span><span style="color:#D4D4D4;"> &amp;&amp; (</span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">ctrlKey</span><span style="color:#D4D4D4;"> || </span><span style="color:#9CDCFE;">e</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">metaKey</span><span style="color:#D4D4D4;">)) {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">    e</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">preventDefault</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">    handleSave</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">  }</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">};</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">onMounted</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  window</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">addEventListener</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;keydown&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">handleEvent</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">  intervalDataSyncUpdate</span><span style="color:#D4D4D4;">();</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">});</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#DCDCAA;">onUnmounted</span><span style="color:#D4D4D4;">(() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#9CDCFE;">  window</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">removeEventListener</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;keydown&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">handleEvent</span><span style="color:#D4D4D4;">);</span></span></span>
<span class="line"><span class="line"><span style="color:#D4D4D4;">});</span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_15、大屏缩略图列表展示" tabindex="-1"><a class="header-anchor" href="#_15、大屏缩略图列表展示"><span>15、大屏缩略图列表展示</span></a></h4><p>普通分页列表展示、大屏缩略图</p><h4 id="_16、拓展-图表组合" tabindex="-1"><a class="header-anchor" href="#_16、拓展-图表组合"><span>16、拓展：图表组合</span></a></h4>`,154)]))}const r=n(p,[["render",o],["__file","低代码数据可视化平台开发记录.html.vue"]]),D=JSON.parse('{"path":"/%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91/%E4%BD%8E%E4%BB%A3%E7%A0%81%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E5%B9%B3%E5%8F%B0%E5%BC%80%E5%8F%91%E8%AE%B0%E5%BD%95.html","title":"vue-lowcode-cockpit-admin","lang":"zh-CN","frontmatter":{},"headers":[{"level":3,"title":"功能梳理","slug":"功能梳理","link":"#功能梳理","children":[]},{"level":3,"title":"组件库","slug":"组件库","link":"#组件库","children":[]},{"level":3,"title":"具体实现","slug":"具体实现","link":"#具体实现","children":[]}],"git":{"updatedTime":1726680671000,"contributors":[{"name":"csmSimona","email":"980715844@qq.com","commits":1}]},"filePathRelative":"项目开发/低代码数据可视化平台开发记录.md","readingTime":{"minutes":10.35,"words":3104}}');export{r as comp,D as data};
